<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Aditya Arora" />
  <title>All </title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: false
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="shortcut icon" href="https://arora-aditya.com/images/A2.png" type="img">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137390799-2"></script>
  <link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js" integrity="sha384-XhWAe6BtVcvEdS3FFKT7Mcft4HJjPqMQvi5V4YhzH9Qxw497jC13TupOEvjoIPy7" crossorigin="anonymous"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-137390799-2');


    window.onload = function(){
      let num = window.location.pathname.slice(window.location.pathname.length-3, window.location.pathname.length-1);
      if(parseInt(num) >= 11){
      document.getElementById('gg_button').parentNode.removeChild(document.getElementById('gg_button'));
      }
    }

    function next(){
      let num = window.location.pathname.slice(window.location.pathname.length-3, window.location.pathname.length-1);
      let next = String(parseInt(num)+1);
      if(next.length < 2){
        next = "0" + next
      }
      if(parseInt(num) < 9){
        window.location.pathname = window.location.pathname.replace(num, next);
      }
    }
    function prev(){
      let num = window.location.pathname.slice(window.location.pathname.length-3, window.location.pathname.length-1);
      let prevV = String(parseInt(num)-1);
      console.log(prevV)
      if(prev.length < 2){
        prevV = "0" + prevV
      }
      console.log(prevV, parseInt(prevV) > 0)
      if(parseInt(prevV) > 0){
        window.location.pathname = window.location.pathname.replace(num, prevV);
      }
    }
  </script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">All<br /></h1>
<p class="author">Aditya Arora</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#feedback-control">Feedback Control</a>
<ul>
<li><a href="#what-is-control-engineering">What is control engineering?</a>
<ul>
<li><a href="#e.g.-automated-highway">e.g. Automated highway</a>
<ul>
<li><a href="#solution-1-open-loop">Solution 1: Open loop</a></li>
<li><a href="#solution-2-closed-loop">Solution 2: Closed Loop</a></li>
</ul></li>
<li><a href="#e.g.-web-server">e.g. Web server</a>
<ul>
<li><a href="#control-objectives">Control objectives</a></li>
</ul></li>
<li><a href="#definition">Definition</a></li>
</ul></li>
<li><a href="#control-cycle">Control Cycle</a></li>
<li><a href="#design-cycle">Design Cycle</a></li>
</ul></li>
<li><a href="#mathematical-models-of-system">Mathematical Models of System</a>
<ul>
<li><a href="#general-comments-on-modelling">General comments on modelling</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#applying-known-laws-to-get-equations">Applying known laws to get equations</a>
<ul>
<li><a href="#e.g.-spring">e.g. Spring</a></li>
<li><a href="#eg-2-carts">eg: 2 carts</a></li>
<li><a href="#e.g.-resistor">e.g. Resistor</a></li>
</ul></li>
<li><a href="#state-space-models">State-space models</a>
<ul>
<li><a href="#e.g.-cart">e.g. Cart</a></li>
</ul></li>
<li><a href="#generalizing">Generalizing</a>
<ul>
<li><a href="#eg-from-previous-example">eg from previous example:</a></li>
<li><a href="#e.g.-more-carts">e.g. more carts</a></li>
<li><a href="#e.g.-drones">e.g. drones</a></li>
<li><a href="#determining-state">Determining state</a></li>
<li><a href="#e.g.-cart-with-no-forces">e.g. cart with no forces</a></li>
<li><a href="#e.g.-2.5.1-pendulum">e.g. 2.5.1: Pendulum</a></li>
<li><a href="#e.g.-2.4.5-circuit">e.g. 2.4.5 Circuit</a></li>
</ul></li>
<li><a href="#linearization">Linearization</a>
<ul>
<li><a href="#e.g.-2.5.2">e.g. 2.5.2</a></li>
<li><a href="#e.g.-2.5.3">e.g. 2.5.3</a></li>
<li><a href="#multivariable-taylor-series">Multivariable Taylor series</a></li>
<li><a href="#e.g.-find-all-the-equilibria-at-which-the-pendulum-is-upright">e.g. Find all the equilibria at which the pendulum is upright</a></li>
<li><a href="#obtaining-a-transfer-function-from-a-state-space-model">Obtaining a Transfer function from a state-space model</a>
<ul>
<li><a href="#summary-getting-a-transfer-function">Summary: Getting a transfer function</a>
<ul>
<li><a href="#ex-2.8.6-recall-the-linearized-model-of-the-pendulum-in-the-upright-position">Ex: 2.8.6 Recall the linearized model of the pendulum in the upright position</a></li>
</ul></li>
<li><a href="#summary">Summary</a></li>
</ul></li>
</ul></li>
<li><a href="#block-diagram-manipulations">Block diagram manipulations</a>
<ul>
<li><a href="#e.g.-linearized-pendulum">e.g. Linearized pendulum</a>
<ul>
<li><a href="#strategy-1-express-y-directly-in-terms-of-u-and-simplify">Strategy 1: Express Y directly in terms of U and simplify</a></li>
<li><a href="#strategy-2-re-arrange-block-to-reveal-common-configurations">Strategy 2: Re-arrange block to reveal common configurations</a></li>
</ul></li>
</ul></li>
<li><a href="#systematic-method-of-finding-transfer-functions">Systematic method of finding transfer functions</a></li>
</ul></li>
<li><a href="#block-diagrams">Block Diagrams</a>
<ul>
<li><a href="#state-response">State Response</a>
<ul>
<li><a href="#e.g.-3.1.1">e.g. 3.1.1</a></li>
<li><a href="#e.g.-3.1.2">e.g. 3.1.2</a></li>
<li><a href="#e.g.-3.1.3">e.g. 3.1.3</a></li>
</ul></li>
<li><a href="#using-laplace">Using Laplace</a>
<ul>
<li><a href="#e.g.">e.g.</a></li>
</ul></li>
<li><a href="#total-response">Total Response</a></li>
<li><a href="#stability-of-state-space-models">Stability of state-space models</a>
<ul>
<li><a href="#e.g.-3.4.2">e.g. 3.4.2</a></li>
</ul></li>
<li><a href="#bounded-input-bounded-output-stability">Bounded input, bounded output stability</a>
<ul>
<li><a href="#e.g.-3.5.1">e.g. 3.5.1</a></li>
</ul></li>
<li><a href="#bibo-and-poles">BIBO and poles</a></li>
<li><a href="#stability-of-state-space-models-and-bibo-stability">Stability of state-space models and BIBO stability</a>
<ul>
<li><a href="#e.g.-3.5.5-mass-spring">e.g. 3.5.5: mass-spring</a></li>
</ul></li>
<li><a href="#steady-state-gain">Steady-state gain</a>
<ul>
<li><a href="#e.g.-set-point-control">e.g. Set-point control</a></li>
</ul></li>
<li><a href="#frequency-response">Frequency response</a>
<ul>
<li><a href="#e.g.-1">e.g.</a></li>
</ul></li>
<li><a href="#graphical-representations-of-frequency-response">Graphical representations of frequency response</a>
<ul>
<li><a href="#bode-plots">Bode plots</a></li>
<li><a href="#polar-plots">Polar plots</a></li>
<li><a href="#e.g.-3.8.5">e.g. 3.8.5</a></li>
<li><a href="#e.g.-3.8.6">e.g. 3.8.6</a></li>
<li><a href="#e.g.-plot">e.g. plot</a></li>
<li><a href="#e.g.-complex-conjugate-zeroes">e.g. Complex conjugate zeroes</a></li>
</ul></li>
<li><a href="#summary-1">Summary</a>
<ul>
<li><a href="#domains">Domains</a></li>
<li><a href="#state-space-models-1">State-space models</a></li>
</ul></li>
</ul></li>
<li><a href="#first-and-second-order-systems">First and Second Order Systems</a>
<ul>
<li><a href="#objective">Objective</a></li>
<li><a href="#first-order">First order</a>
<ul>
<li><a href="#e.g.-2">e.g.</a></li>
</ul></li>
<li><a href="#second-order">Second order</a>
<ul>
<li><a href="#e.g.-3">e.g.</a></li>
<li><a href="#pole-locations">Pole locations</a></li>
<li><a href="#step-response">Step response</a></li>
</ul></li>
<li><a href="#underdamped-systems">Underdamped Systems</a>
<ul>
<li><a href="#impulse-response">Impulse response</a></li>
<li><a href="#step-response-1">Step response</a></li>
<li><a href="#summary-2">Summary</a></li>
</ul></li>
<li><a href="#general-characteristics-of-step-response">General characteristics of step response</a>
<ul>
<li><a href="#overshoot">Overshoot</a>
<ul>
<li><a href="#e.g.-mass-spring-damper">e.g. mass-spring damper</a></li>
</ul></li>
<li><a href="#settling-time">Settling time</a>
<ul>
<li><a href="#e.g.-mass-spring-damper-1">e.g. Mass-spring damper</a></li>
</ul></li>
<li><a href="#time-to-peak">Time-to-peak</a>
<ul>
<li><a href="#e.g.-mass-spring-damper-again">e.g. mass-spring damper again</a></li>
<li><a href="#changes-to-poles">Changes to poles</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#feedback-control-theory">Feedback Control Theory</a>
<ul>
<li><a href="#closing-the-loop">5.1 Closing the loop</a>
<ul>
<li><a href="#e.g.-pendulum">e.g. Pendulum</a></li>
</ul></li>
<li><a href="#stability-of-feedback-systems">Stability of feedback systems</a>
<ul>
<li><a href="#internal-stability">Internal stability</a>
<ul>
<li><a href="#e.g.-4">e.g.</a></li>
</ul></li>
<li><a href="#input-output-stability">Input-output stability</a>
<ul>
<li><a href="#e.g.-5.2.5">e.g. 5.2.5</a></li>
</ul></li>
<li><a href="#characteristic-polynomial">Characteristic polynomial</a>
<ul>
<li><a href="#e.g.-5.2.7">e.g. 5.2.7</a></li>
</ul></li>
<li><a href="#comparing-internal-and-input-output-stability">Comparing Internal and Input-Output Stability</a></li>
<li><a href="#the-routh-hurwitz-criterion">The Routh-Hurwitz Criterion</a>
<ul>
<li><a href="#e.g.-5.3.1">e.g. 5.3.1</a></li>
</ul></li>
<li><a href="#rouths-algorithm">Routh’s Algorithm</a>
<ul>
<li><a href="#routh-hurwitz-criterion">Routh-Hurwitz Criterion</a></li>
<li><a href="#e.g.-5.3.4">e.g. 5.3.4</a></li>
</ul></li>
</ul></li>
<li><a href="#steady-state-performance">Steady-state performance</a>
<ul>
<li><a href="#tracking-reference-signals">Tracking reference signals</a>
<ul>
<li><a href="#e.g.-5.4.1">e.g. 5.4.1</a></li>
<li><a href="#e.g.-5">e.g.</a></li>
</ul></li>
<li><a href="#design-strategy">Design strategy</a></li>
<li><a href="#internal-model-principle">Internal model principle</a>
<ul>
<li><a href="#e.g.-5.4.3">e.g. 5.4.3</a></li>
</ul></li>
<li><a href="#steady-state-disturbance-rejection">Steady-state disturbance rejection</a>
<ul>
<li><a href="#e.g.-6">e.g.</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#root-locus-method">Root-Locus Method</a>
<ul>
<li><a href="#basic-root-locus-construction">6.1 Basic root-locus construction</a>
<ul>
<li><a href="#e.g.-6.1.1">e.g. 6.1.1</a></li>
<li><a href="#construction">Construction</a></li>
</ul></li>
<li><a href="#procedure-for-plotting-root-locus">Procedure for plotting root-locus</a>
<ul>
<li><a href="#e.g.-6.3.1">e.g. 6.3.1</a></li>
<li><a href="#e.g.-6.2.2">e.g. 6.2.2</a></li>
<li><a href="#e.g.-cart-pendulum-system">e.g. Cart pendulum system</a>
<ul>
<li><a href="#proportional-controller">6.2.3 Proportional controller</a></li>
<li><a href="#p.d.-control">6.2.4 P.D. Control</a></li>
<li><a href="#p.i.-control">6.2.5 P.I. Control</a></li>
</ul></li>
</ul></li>
<li><a href="#non-standard-problems">6.3 Non-standard problems</a>
<ul>
<li><a href="#non-unity-feedback">Non-unity feedback</a></li>
<li><a href="#controller-isnt-a-linear-function-of-the-gain">Controller isn’t a linear function of the gain</a></li>
<li><a href="#improper-loop-gain">Improper Loop Gain</a>
<ul>
<li><a href="#e.g.-6.3.2">e.g. 6.3.2</a></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#pid-control">PID Control</a>
<ul>
<li><a href="#classical-pid">7.1 Classical PID</a>
<ul>
<li><a href="#refinements-to-the-basic-pid-control">Refinements to the basic PID control</a></li>
<li><a href="#what-does-each-term-do">What does each term do?</a></li>
</ul></li>
<li><a href="#pole-placement">7.3 Pole placement</a>
<ul>
<li><a href="#e.g.-7.3.1">e.g. 7.3.1</a></li>
<li><a href="#padé-approximation">Padé approximation</a></li>
</ul></li>
<li><a href="#when-can-pid-be-used">When can PID be used?</a>
<ul>
<li><a href="#e.g.-7">e.g.</a></li>
</ul></li>
</ul></li>
<li><a href="#frequency-domain-methods-for-stability-analysis">Frequency Domain Methods for Stability Analysis</a>
<ul>
<li><a href="#cauchys-principle-of-the-argument">8.1 Cauchy’s Principle of the Argument</a>
<ul>
<li><a href="#e.g.-8.1.1">e.g. 8.1.1</a></li>
<li><a href="#e.g.-8.1.2">e.g. 8.1.2</a></li>
<li><a href="#e.g.-8.1.3">e.g. 8.1.3</a></li>
<li><a href="#theorem">Theorem</a>
<ul>
<li><a href="#proof">Proof</a></li>
</ul></li>
</ul></li>
<li><a href="#nyquist-contour">Nyquist Contour</a></li>
<li><a href="#nyquist-stability-criterion">Nyquist stability criterion</a>
<ul>
<li><a href="#theorem-1">Theorem</a></li>
<li><a href="#proof-1">Proof</a></li>
<li><a href="#remarks">Remarks</a></li>
<li><a href="#procedure-for-applying-the-nyquist-criterion">Procedure for applying the Nyquist criterion</a>
<ul>
<li><a href="#e.g.-8">e.g.</a></li>
<li><a href="#e.g.-comparing-nyquist-to-bode">e.g. comparing Nyquist to Bode</a></li>
<li><a href="#e.g.-8.3.2">e.g. 8.3.2</a></li>
</ul></li>
</ul></li>
<li><a href="#stability-margins-revisited">Stability margins, revisited</a>
<ul>
<li><a href="#phase-margin">Phase margin</a></li>
<li><a href="#e.g.-8.4.1">e.g. 8.4.1</a></li>
<li><a href="#gain-margin">Gain Margin</a></li>
<li><a href="#e.g.-8.4.3">e.g. 8.4.3</a></li>
<li><a href="#stability-margin">Stability Margin</a></li>
<li><a href="#e.g.-8.4.5">e.g. 8.4.5</a></li>
</ul></li>
</ul></li>
<li><a href="#intro-to-control-design-in-the-frequency-domain">Intro to Control Design in the Frequency Domain</a>
<ul>
<li><a href="#intro-to-stability-margins">Intro to stability margins</a>
<ul>
<li><a href="#gain-margin-1">Gain margin</a></li>
<li><a href="#phase-margin-1">Phase margin</a></li>
<li><a href="#obtaining-gain-and-phase-margins">Obtaining gain and phase margins</a></li>
</ul></li>
<li><a href="#performance-specifications">Performance Specifications</a>
<ul>
<li><a href="#relationship-between-crossover-frequencies-and-bandwidth">Relationship between crossover frequencies and bandwidth</a></li>
<li><a href="#relationship-between-damping-ratio-and-phase-margin">Relationship between damping ratio and phase margin</a></li>
</ul></li>
<li><a href="#lag-compensation">Lag Compensation</a>
<ul>
<li><a href="#steady-state-gain-1">Steady-state gain</a></li>
<li><a href="#uses">Uses</a></li>
<li><a href="#e.g.-9.3.1">e.g. 9.3.1</a></li>
<li><a href="#procedure-for-lag-design">Procedure for lag design</a></li>
</ul></li>
<li><a href="#lead-controller">Lead controller</a>
<ul>
<li><a href="#lead-design-equations">Lead design equations</a></li>
<li><a href="#e.g.-9.4.1">e.g. 9.4.1</a></li>
<li><a href="#procedure-for-lead-design">Procedure for lead design</a></li>
<li><a href="#e.g.-9">E.g.</a></li>
<li><a href="#delay-tolerance">Delay tolerance</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="feedback-control">Feedback Control</h1>
<h2 id="what-is-control-engineering">What is control engineering?</h2>
<h3 id="e.g.-automated-highway">e.g. Automated highway</h3>
<figure>
<img src="../../attachments/highway.png" alt="" /><figcaption>highway</figcaption>
</figure>
<p><strong>Objective:</strong>
- decide on the velocity commands to the follower in order to maintain a safe inter-vehicle distance</p>
<p><strong>Assumptions:</strong>
- cars only move forward and reverse on flat ground
- through software running on an embedded computer, we can assign different velocities to the follower
- Model for follower: <span class="math inline">\frac{df(t)}{dt} = u(t)</span>, where we decide <span class="math inline">u(t)</span>
- Leader moves at a constant but unknown speed</p>
<h4 id="solution-1-open-loop">Solution 1: Open loop</h4>
<ul>
<li>Don’t equip follower with any sensors (save that money 💰)</li>
<li>algorithm to decide velocity only has access to the desired inter-vehicle distance, labelled <span class="math inline">r(t)</span></li>
</ul>
<figure>
<img src="../../attachments/openloop.png" alt="" /><figcaption>open loop</figcaption>
</figure>
<ul>
<li>Since the algorithm has no access to <span class="math inline">y(t)</span>, it can’t make an informed decision</li>
<li>Toasters work like this (doesn’t sense toast burntness, just goes for a set time)</li>
</ul>
<h4 id="solution-2-closed-loop">Solution 2: Closed Loop</h4>
<ul>
<li>equip the follower with sensors that can measure <span class="math inline">y(t)</span></li>
</ul>
<figure>
<img src="../../attachments/closedloop.png" alt="" /><figcaption>closed loop</figcaption>
</figure>
<ul>
<li>Simplest control algorithm</li>
<li><span class="math inline">u(t) = -K_p (r(t) - y(t)), \quad K_p \gt 0</span></li>
<li>Better control algorithm: <strong>proportional-integral error feedback</strong></li>
<li><span class="math inline">u(t) = -K_p (r(t) - y(t)) - K_i \int_0^t{(r(T)-y(T)) dT}, \quad K_p, K_i \gt 0</span></li>
</ul>
<h3 id="e.g.-web-server">e.g. Web server</h3>
<p>(See 1.4.1 in the notes)</p>
<ul>
<li>Web server that responds to GET and POST requests from browsers</li>
<li>The server has a buffer of pending requests so no requests are lost</li>
</ul>
<figure>
<img src="../../attachments/webserver.png" alt="" /><figcaption>web server</figcaption>
</figure>
<h4 id="control-objectives">Control objectives</h4>
<ol type="1">
<li>Don’t let the queue length get too large (buffer may overflow and requests will be lost)</li>
<li>Don’t let queue length get to zero (it would be a waste of resources to have the server idle)</li>
</ol>
<p>Consequently, we want to keep the queue length at some known value <span class="math inline">r(t)</span>.</p>
<p>The difficulty is that the <strong>service rate</strong> is not known, as it depends on many things (e.g. number of clients). Because of this, we will model it as a <strong>disturbance</strong> <span class="math inline">d(t)</span>.</p>
<p>We must decide on the <strong>request rate</strong> <span class="math inline">u(t)</span> based on <span class="math inline">r(t)</span> and <span class="math inline">y(t)</span> (queue length).</p>
<figure>
<img src="../../attachments/webserver-block.png" alt="" /><figcaption>web server block</figcaption>
</figure>
<h3 id="definition">Definition</h3>
<p>Control engineering attempts to change the behaviour of a system (called a “plant”) in a useful way despite the presence of external influences (“disturbances”) and despite <strong>model uncertainty.</strong></p>
<p>We change the behaviour of the plant by connecting it to another system (“controller”).
<strong>Feedback</strong> is the most powerful interconncetion strategy.</p>
<h2 id="control-cycle">Control Cycle</h2>
<ol type="1">
<li>Sense the operation of a system</li>
<li>Compare against a desired behaviour</li>
<li>Compute a correctibe action informed bu a model of the sustem’s respnse to external stimuli</li>
<li>Actuate the sustem to affect the desired change</li>
</ol>
<p>The <strong>sense, compute, actuate</strong> cycle loops.</p>
<h2 id="design-cycle">Design Cycle</h2>
<ol type="1">
<li>Study the system to be controlled, decide on sensors and actuators. Sensors change what information is at your disposal, and actuators represent choices you can make in response to the inputs.</li>
<li>Model the resulting system [CH2]</li>
</ol>
<ul>
<li>Mathematical model</li>
<li>Often one or more differential equations e.g. follower <span class="math inline">\frac{dx_f}{dt}(t) = u(t)</span></li>
<li>Obtained through analysis or experimental data [CH4]</li>
</ul>
<ol start="3" type="1">
<li>Simplify model if necessary</li>
</ol>
<ul>
<li>Classical control (this course, most common) deals with linear, time-invariant systems. It requires that we have a <strong>transfer function</strong> (input-output) model of the plant.</li>
<li>e.g. <span class="math inline">\mathcal{L}\left\{\frac{dx_f}{dt}\right\} = \mathcal{L}\{u\} \Rightarrow sX_f(s) - x_f(0) = U(s)</span>. Transfer function is <span class="math inline">\frac{X_f(s)}{U(s)} = \frac{1}{s}</span>.</li>
<li>A system has a transfer function iff it is linear and time-invariant.</li>
</ul>
<ol start="4" type="1">
<li>Analyze the model [CH3/4]</li>
<li>Determine design specifications: stability [CH3/5], good steady-state behaviour [CH5], robustness [CH8/9], good transient performance [CH4/5/7/8/9]</li>
<li>Decide on the type of controller [CH5/7/9]</li>
<li>Design the controller</li>
</ol>
<ul>
<li>In this course, we design LTI controllers, the controller itself has a transfer function</li>
<li>This transfer function corresponds to a differential equation relating the inputs and outputs of the controller</li>
<li>eg: followers: proportional integral controller <span class="math inline">\frac{U(s)}{E(s)} = -K_p + K_i\frac{1}{s}</span></li>
</ul>
<ol start="8" type="1">
<li>Simulate (usually using Matlab, Octave &amp; Scilab)</li>
<li>Return to step 1 if necessary</li>
<li>Implement controller</li>
</ol>
<ul>
<li>it is possible to build circuits that have the same transfer function as the controller from step 7</li>
<li>More ealistically, the Ordinary Differential Equation (ODE) from step 7 is discretized and approximated as a difference equation and implemented in software</li>
<li>this works well if the computer runs fast enough</li>
</ul>
<figure>
<img src="../../attachments/yousuf_notes.png" alt="" /><figcaption>yousuf notes</figcaption>
</figure>
<h1 id="mathematical-models-of-system">Mathematical Models of System</h1>
<p>for control design, we need a “good” (simple but accurate) mathematical model of how the plant responds to stimuli</p>
<h2 id="general-comments-on-modelling">General comments on modelling</h2>
<figure>
<img src="../../attachments/dynamicsystem.png" alt="" /><figcaption>dynamic system</figcaption>
</figure>
<ul>
<li>a <em>model</em> is a set of equations that describe how a system transforms inputs into outputs</li>
<li>no model is perfects (errors in measurement, approximations are made)</li>
<li>models allow us to manipulate a system outside the constraints of physical reality</li>
<li>in control: simple model for design, complex model for simulation</li>
</ul>
<hr />
<h2 id="overview">Overview</h2>
<ol type="1">
<li>Apply known laws to get a system of coupled differential equations
<ul>
<li>come from first principles eg: newton’s, maxwell’s, queuing theory, econometrics etc. and/or system identification (experiments, data fitting)</li>
</ul></li>
<li>Linearize the model at an operating point to get a system of linear equations
<ul>
<li>simplify “linearize” model about an “operating point”</li>
</ul></li>
<li>Take the Laplace transforms with zero initial conditions to get a system of linear algebraic equations</li>
<li>Isolate input and output to get a transfer function
<ul>
<li>express output <span class="math inline">Y(s)</span> in terms of the input <span class="math inline">U(s)</span></li>
</ul></li>
<li>Experimentally determine parameter values for the transfer function (e.g. weight of your robot)</li>
</ol>
<h2 id="applying-known-laws-to-get-equations">Applying known laws to get equations</h2>
<h3 id="e.g.-spring">e.g. Spring</h3>
<figure>
<img src="../../attachments/spring.png" alt="" /><figcaption>spring</figcaption>
</figure>
<p><span class="math inline">q(t) \in \mathbb{R}</span> is the position of the mass <span class="math inline">M</span> at the time <span class="math inline">t</span>, output</p>
<p><span class="math inline">M &gt; 0</span>, mass in kg</p>
<p><span class="math inline">u</span> - an externally applied force (input)</p>
<p><span class="math inline">\dot{q} := \frac{dq}{dt}, \quad \ddot{q} := \frac{d^2q}{dt^2}</span></p>
<p>Assume that <span class="math inline">q=0</span> corresponds to the mass location at which the spring is neither stretched nor compressed - “unsprung”.</p>
<p>Newton’s 2nd law: <span class="math inline">M\ddot{q} = \sum{ \text{forces acting on } M}</span></p>
<p>Force due to spring: <span class="math inline">F_K(q) = Kq(t)</span>, assumed to be linear, hooke’s law</p>
<p>Force due to damper, possibly nonlinear: <span class="math inline">C(\dot{q})</span> where <span class="math inline">C: \mathbb{R} \rightarrow \mathbb{R}</span></p>
<p>Altogether, we get a second order nonlinear ODE:
<span class="math display">M\ddot{q} = u(t) - Kq(t) - C(\dot{q})</span></p>
<p>Note: if the damper is linear (<span class="math inline">C(\dot{q})=bq</span>), then the overall system is linear</p>
<h3 id="eg-2-carts">eg: 2 carts</h3>
<figure>
<img src="../../attachments/2mass.png" alt="" /><figcaption>2 carts</figcaption>
</figure>
<ul>
<li>a force <span class="math inline">u</span> is applied to <span class="math inline">M_1</span> and we want to control the position of <span class="math inline">M_2</span></li>
<li>assume that when <span class="math inline">q_1(t) = q_2(t)</span>, the spring is at rest</li>
</ul>
<p>Applying Newton’s second law on <span class="math inline">M_1</span> gives us two coupled second order linear ODEs:
<span class="math display">M_1\ddot{q_1} = u - Kq_1 + Kq_2 - b\dot{q}_1 + b\dot{q}_2</span>
<span class="math display">M_2\ddot{q_2} = Kq_1 - Kq_2 + b\dot{q}_1 - b\dot{q}_2</span></p>
<h3 id="e.g.-resistor">e.g. Resistor</h3>
<p><img src="../../attachments/resistor.png" alt="resistor" />
<img src="../../attachments/vr_i_graph.png" alt="V_r i graph" /></p>
<p><span class="math inline">V_R(t) = h(i(t)), \quad h : \mathbb{R} \rightarrow \mathbb{R}</span> is possibly nonlinear</p>
<p><span class="math inline">u(t)</span>: applied voltage; <span class="math inline">y(t)</span>: voltage across capacitor</p>
<p>Apply Kirchoff’s Voltage Law:
<span class="math display">\begin{aligned}
-u(t) + V_R(t) + y(t) &amp;= 0\\
\\
i(t) &amp;= C\frac{dy}{dt} \quad \text{(capacitor equation)}\\
V_R &amp;= h(i(t)) = h(C\dot(y))\\
\\
-u(t) + h(C\dot{y}) + y &amp;= 0\\
\end{aligned}</span></p>
<p>Note: if the resister were linear (<span class="math inline">h(i) = Ri</span>), the whole system would be linear (see 2.3.4 in notes)</p>
<blockquote>
<p>L02 Summary</p>
<ul>
<li>control design cycle (course roadmap)</li>
<li>Ch2 modelling
<ul>
<li>examples - mech x2, elec x1</li>
</ul></li>
</ul>
<p>Expectation: model very simple, physical systems, see sec 2.3 of notes</p>
</blockquote>
<h2 id="state-space-models">State-space models</h2>
<p>a way to express mathematical models in standard form</p>
<h3 id="e.g.-cart">e.g. Cart</h3>
<figure>
<img src="../../attachments/carairresistance.png" alt="" /><figcaption>carairresistance</figcaption>
</figure>
<p>Newton’s second law: <span class="math inline">M\ddot{y} = u - D(\dot{y})</span></p>
<p>We put this model into a standard form by defining two <strong>state variables</strong>:
<span class="math display">x_1 := y \text{ (position)}, \quad x_2 := \dot{y} \text{ (velocity)}</span></p>
<p>Together, <span class="math inline">x_1</span> and <span class="math inline">x_2</span> make up the <strong>state</strong> of the system. We do some rewriting to have a systematic way to do linearization:</p>
<p><span class="math display">\begin{aligned}
\dot{x_1} &amp;= x_2 &amp; \text{(state equation)}\\
\dot{x_2} &amp;= \frac{1}{M}u - \frac{1}{M}D(x_2) &amp; \text{(state equation)}\\
y &amp;= x_1 &amp; \text{(output equation)}\\
\end{aligned}</span></p>
<p>Together, these equations make up the <strong>state-space model.</strong> These equations have the general form (also called the <strong>Nonlinear state-space model</strong>):</p>
<p><span class="math display">\dot{x} = f(x,u) \text{, } y = h(x(t))</span></p>
<p>In this example:</p>
<p><span class="math display">\begin{aligned}
x(t) &amp;= \begin{bmatrix}
x_1(t) \\
x_2(t)\\
\end{bmatrix} \in \mathbb{R}^2\\
f(x,u) &amp;= \begin{bmatrix}
x_2 \\
\frac{1}{M}u - \frac{1}{M}D(x_2)
\end{bmatrix}\\
\end{aligned}\\ h(x) = x_1</span></p>
<ul>
<li>the function <span class="math inline">f: \mathbb{R}^2\times \mathbb{R} \rightarrow \mathbb{R}</span> is linear if <span class="math inline">D(x_2)</span> is linear</li>
<li><span class="math inline">h: \mathbb{R}^2 \rightarrow \mathbb{R}</span> is linear</li>
</ul>
<p>In the special case where air resistance is a linear function of <span class="math inline">x_2</span> (<span class="math inline">D(x_2)=d x_2</span>), then <span class="math inline">f(x,u)</span> becomes a linear function of <span class="math inline">x</span> and <span class="math inline">u</span>:</p>
<p><span class="math display">f(x,u) = \begin{bmatrix}
0 &amp; 1 \\
0 &amp; \frac{-d}{M}
\end{bmatrix} \begin{bmatrix}
x_1 \\
x_2
\end{bmatrix} + \begin{bmatrix}
0 \\
\frac{1}{M}
\end{bmatrix} u
</span></p>
<p>Define <span class="math inline">C = \begin{bmatrix}1 &amp; 0\end{bmatrix}</span>. In the linear case, we get:
<span class="math display">\begin{aligned}
\dot{x} &amp;= Ax + Bu\\
y &amp;= Cx\\
\end{aligned}</span></p>
<p>This is a linear, time-invariant (LTI) model.</p>
<p><strong>Expect at least one question like this on the midterm</strong></p>
<h2 id="generalizing">Generalizing</h2>
<p>Generalizing this example above, a large class of systems have models of the form:</p>
<p><span class="math display">\begin{aligned}
\dot{x} &amp;= f(x, u), &amp; f: \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}^n\\
y &amp;= h(x, u), &amp; h: \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}^p\\
\end{aligned}</span></p>
<ul>
<li>This model is nonlinear</li>
<li>there are <span class="math inline">m</span> control inputs <span class="math inline">u=(u_1, ..., u_m)</span></li>
<li>there are <span class="math inline">p</span> outputs <span class="math inline">y=(y_1,...,y_p)</span></li>
<li>the state vector <span class="math inline">x</span> has dimensions <span class="math inline">n</span>: <span class="math inline">x=(x_1, ..., x_n)</span></li>
</ul>
<p>The LTI special case is:
<span class="math display">\begin{aligned}
\dot{x} &amp;= Ax + Bu, &amp; A  \in \mathbb{R}^{n \times n}, B \in \mathbb{R}^{n \times m}\\
y &amp;= Cx + Du, &amp; C \in \mathbb{R}^{p \times n}, D \in \mathbb{R}^{p \times m}\\
\end{aligned}</span></p>
<h3 id="eg-from-previous-example">eg from previous example:</h3>
<ul>
<li>n = 2</li>
<li>m = 1 (one input- applied force),</li>
<li>p = 1 (one output)</li>
</ul>
<p>In this course, we look at single-input, single-output systems: <span class="math inline">m=p=1</span>.</p>
<h3 id="e.g.-more-carts">e.g. more carts</h3>
<figure>
<img src="../../attachments/carts.png" alt="" /><figcaption>carts</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
m&amp;=2, &amp; u &amp;= (u_1, u_2)\\
p&amp;=2, &amp; y &amp;= (y_1, y_2)\\
m&amp;=4, &amp; x &amp;= (x_1, x_2, x_3, x_4) := (y_1, \dot{y_1}, y_2, \dot{y_2})\\
\end{aligned}</span></p>
<h3 id="e.g.-drones">e.g. drones</h3>
<p><img src="../../attachments/drones.png" alt="drones" />
<span class="math display">\begin{aligned}
m&amp;= 4\\u &amp;= (y_1, u_2, u_3, u_4)= (f_1, f_2, f_3, f_4)\\
p&amp;=3\\
y&amp;=(y_1, y_2, y_3)\\
n &amp;= 12\\
x &amp;\in \mathbb{R}^{12} = (\text{position}, \text{3 orientations - roll, pitch, and yaw}, \text{velocity}, \text{angular velocity})\\
\end{aligned}</span></p>
<h3 id="determining-state">Determining state</h3>
<p><strong>What is the state of a system?</strong></p>
<p>The state vector <span class="math inline">x(t_0)</span> encapsulates all of the system’s evolution up to time <span class="math inline">t_0</span>.</p>
<p>More formally: For any two times <span class="math inline">t_0 \lt t</span>, knowing <span class="math inline">x(t_0)</span> and knowing <span class="math inline">\{u(t) : t_0 \le t \le t_1\}</span>, we can compute <span class="math inline">x(t_1)</span> and hence <span class="math inline">y(t_1)</span>.</p>
<blockquote>
<p>Faraz:System is causal</p>
</blockquote>
<h3 id="e.g.-cart-with-no-forces">e.g. cart with no forces</h3>
<figure>
<img src="../../attachments/cart-no-forces.png" alt="" /><figcaption>cart-no-forces</figcaption>
</figure>
<p>We know <span class="math inline">M\ddot{y} = 0</span> from Newton’s laws.</p>
<p>If we try a 1-dimensional state, say <span class="math inline">x := y</span>, then knowing <span class="math inline">x(t_0)</span> without knowing <span class="math inline">\dot{y}</span> is not enough information to find the position in the future, <span class="math inline">x(t)</span> for <span class="math inline">t \gt t_0</span>. We have the same problem if we define <span class="math inline">x = \dot{y}</span>.</p>
<p>Since the governing equation is second order, we need two initial conditions. So, <span class="math inline">x=(y, \dot{y}) \in \mathbb{r}^2</span> is a good choice.</p>
<p>In general, it is a good idea to use:</p>
<ul>
<li>position and velocity for a physical system</li>
<li>Capacitor voltage and inductor current for a circuit</li>
</ul>
<h3 id="e.g.-2.5.1-pendulum">e.g. 2.5.1: Pendulum</h3>
<figure>
<img src="../../attachments/pendulum.png" alt="" /><figcaption>pendulum</figcaption>
</figure>
<p>Model: <span class="math inline">\ddot{\theta} = \frac{3}{Ml^2} u - 3\frac{g}{l} \sin(\theta)</span></p>
<p><span class="math display">
\begin{aligned}
x &amp;= \begin{bmatrix}
x_1 \\ x_2 
\end{bmatrix} := \begin{bmatrix}
\theta \\ \dot{\theta}
\end{bmatrix}\\
u &amp;:= \tau \text{ (applied torque)}\\
y &amp;:= \theta \text{ (position)}
\end{aligned}
</span></p>
<p>In state space form:
<span class="math display">\begin{aligned}
x &amp;= (\theta, \dot{\theta})\\
y &amp;= \text{angular position} = \theta\\
\\
\dot{x}&amp;=f(x,u) \quad &amp; &amp; \dot{x_1}=x_2\\
\dot{y}&amp;=h(x,u) \quad &amp; &amp; \dot{x_2}=\frac{3}{Ml^2}u - 3\frac{s}{l} \sin(x_1)\\
&amp; &amp; &amp; y = x_1
\end{aligned}</span></p>
<p>This is nonlinear due to the sine term, its state-space model <em>cannot</em> be written in the form as above</p>
<h3 id="e.g.-2.4.5-circuit">e.g. 2.4.5 Circuit</h3>
<figure>
<img src="../../attachments/circuit.png" alt="" /><figcaption>circuit</figcaption>
</figure>
<p><span class="math display">
\begin{aligned}
x &amp;= \begin{bmatrix}
x_1 \\ x_2 
\end{bmatrix} := \begin{bmatrix}
\text{voltage across cap} \\ \text{current through inductor}
\end{bmatrix}\\
u &amp;:= \text{ (applied voltage)}\\
y &amp;:= \text{current through inductor}
\end{aligned}
</span></p>
<p><span class="math display">\begin{aligned}
x_1 &amp;:= \text{voltage across capacitor} = \frac{1}{C} \int{y(\tau)d\tau}\\
x_2 &amp;:= \text{current through inductor} = y\\
\\
-u + V_R + V_C + V_L &amp;= 0\\
\Rightarrow -u + Rx_2  + x_1 + L\dot{x_2} &amp;= 0, \quad \text{from capacitor equation: } \dot{x_1}=\frac{1}{C} x_2\\
\\
\dot{x} &amp;= \begin{bmatrix}
0 &amp; \frac{1}{C}\\
\frac{-1}{2} &amp; \frac{-R}{L}\end{bmatrix} \begin{bmatrix}x_1\\
x_2\end{bmatrix} + \begin{bmatrix}0 \\ \frac{1}{L}\end{bmatrix} u\\
y &amp;= \begin{bmatrix}0 &amp; 1\end{bmatrix}\\
\end{aligned}</span></p>
<p>The above is a linear system, and right above this is the state space model</p>
<blockquote>
<p>L03 summary</p>
<p><img src="../../attachments/L03_summary.png" /></p>
<p>Non-linear time-invariant causal state-space model
<span class="math display"> \begin{aligned}
f&amp;: \mathbb{R}^n \times \mathbb{R}^m \to \mathbb{R}^n\\
h&amp;: \mathbb{R}^n \times \mathbb{R}^m \to \mathbb{R}^p
\end{aligned}
</span>
Single-input single output: m = p = 1</p>
<p>State vector: <span class="math inline">z(t)</span>, given <span class="math inline">x(t_0)</span> and <span class="math inline">u(t), t_0 \leq t \leq t_1</span>, we can compute <span class="math inline">y(t_1)</span></p>
<p>Rule of thumb:
1. mechanical - posn and velocity
2. electrical: Inductor currents and capacitor voltages</p>
<p><strong>LTI SPECIAL CASE</strong></p>
<p><img src="../../attachments/L03_summary.png" /></p>
<p><span class="math inline">A \epsilon \mathbb{R}^{n\times n};B \epsilon \mathbb{R}^{n\times m};C \epsilon \mathbb{R}^{p\times n};D \epsilon \mathbb{R}^{p\times n};</span></p>
</blockquote>
<h2 id="linearization">Linearization</h2>
<p>In this course we always linearize, non-linear system</p>
<p>This refers to the process of approximating a nonlinear state-space model with a linear model</p>
<p>Linearization allows us to use simpler, systematic analysis and design tools</p>
<h3 id="e.g.-2.5.2">e.g. 2.5.2</h3>
<p>Linearize <span class="math inline">y=x^3</span> at the point <span class="math inline">\bar{x}=1</span>.</p>
<figure>
<img src="../../attachments/linearize.png" alt="" /><figcaption>linearize</figcaption>
</figure>
<p>Let <span class="math inline">\bar{y} := f(\bar{x}) = 1^3 = 1</span></p>
<p>Taylor series at <span class="math inline">x=\bar{x}</span> is:
<span class="math display">y=\sum_{n=0}^\infty c_n (x-\bar{x})^n, \quad c_n = \frac{1}{n!} \frac{d^n f(x)}{dx^n} \biggr|_{x=\bar{x}}</span></p>
<p>Keep only the terms <span class="math inline">n=0</span> and <span class="math inline">n=1</span>:
<span class="math display">\begin{aligned}
f(x) &amp;\approx f(\bar{x}) + \frac{df(x)}{dx}\biggr|_{x-\bar{x}} (x-\bar{x})\\
y - \bar{y} &amp;\approx + \frac{df(x)}{dx}\biggr|_{x-\bar{x}} (x-\bar{x})\\
\end{aligned}</span></p>
<p>If we define the derivations <span class="math inline">\partial y := y - \bar{y}, \partial x := x - \bar{x}</span>, then <span class="math inline">\partial y = \frac{df}{dx} \bigg|_{x=\bar{x}} \partial x</span>, i.e. <span class="math inline">\partial y = 3 \partial x</span></p>
<h3 id="e.g.-2.5.3">e.g. 2.5.3</h3>
<p><span class="math display">y = \begin{bmatrix}y_1 \\ y_2\end{bmatrix} = f(x) = \begin{bmatrix}x_1 x_2 - 1 \\ x_3^2 - 2x_1 x_3\end{bmatrix} =: \begin{bmatrix}f_1(x) \\ f_2(x)\end{bmatrix}</span></p>
<p>Linearize at <span class="math inline">\bar{x}=(1, -1, 2)</span>.</p>
<p><span class="math inline">\bar{y}=f(\bar{x})=\begin{bmatrix}-2\\0\end{bmatrix}</span></p>
<h3 id="multivariable-taylor-series">Multivariable Taylor series</h3>
<p><span class="math display">d(x)=f(\bar{x})+\frac{\partial f}{\partial x} \biggr|_{x=\bar{x}} (x-\bar{x}) \text{ + higher order terms}</span></p>
<p>The Jacobian of <span class="math inline">f</span> at <span class="math inline">\bar{x}</span> is:
<span class="math display">\begin{aligned}
\frac{\partial f}{\partial x} \biggr|_{x = \bar{x}}
&amp;= \begin{bmatrix}
 \frac{\partial f_1}{\partial x_1} &amp; \frac{\partial f_1}{\partial x_2} &amp; \frac{\partial f_1}{\partial x_3} \\
 \frac{\partial f_2}{\partial x_1} &amp; \frac{\partial f_2}{\partial x_2} &amp; \frac{\partial f_2}{\partial x_3} \\
 \frac{\partial f_3}{\partial x_1} &amp; \frac{\partial f_3}{\partial x_2} &amp; \frac{\partial f_3}{\partial x_3} \\
\end{bmatrix}\\
&amp;= \begin{bmatrix}
 x_2 &amp; x_1 &amp; 0 \\
 -2x_3 &amp; 0 &amp; 2x_3-2x_1 \\
\end{bmatrix}_{x=(1, -1, 2)}\\
&amp;= \begin{bmatrix}
 -1 &amp; 1 &amp; 0\\
 -4 &amp; 0 &amp; 2
\end{bmatrix}\\
&amp;= A
\end{aligned}</span></p>
<p>i.e. <span class="math inline">y-\bar{y} \approx A(x-\bar{x})</span></p>
<p>You can now think of this as tangent planes to surfaces</p>
<p>By direect extension, at <span class="math inline">(x,u)=(\bar{x}, \bar{u})</span>:
<span class="math display">f(x, u) \approx f(\bar{x}, \bar{u})+ \frac{\partial f}{\partial x} \biggr|_{(x,u)=(\bar{x}, \bar{u})} (x-\bar{x}) + \frac{\partial f}{\partial u} \biggr|_{(x,u)=(\bar{x}, \bar{u})} (u-\bar{u})</span></p>
<p>Let’s apply linearization to <span class="math inline">\dot{x}=f(x,u), y=h(x,u)</span>.</p>
<p><strong>Definition (2.5.1):</strong> A constant pair <span class="math inline">(\bar{x}, \bar{u}) \in \mathbb{R}^n \times \mathbb{R}^m</span> is an <strong>equilibrium configuration</strong> of the system <span class="math inline">\dot{x}=f(x,u), y=h(x,u)</span> if <span class="math inline">f(\bar{x}, \bar{u})=(0,...,0)</span>. The constant <span class="math inline">\bar{x}</span> is the <strong>equilibrium point.</strong></p>
<h3 id="e.g.-find-all-the-equilibria-at-which-the-pendulum-is-upright">e.g. Find all the equilibria at which the pendulum is upright</h3>
<p><span class="math display">\begin{aligned}
\dot{x} &amp;= f(x,u)\\
y &amp;= h(x,u)\\
x_1 &amp;= \theta\\
x_2 &amp;= \dot{\theta}\\
f(x,u) &amp;= \begin{bmatrix}x_2\\ \frac{3}{Ml}u-\frac{3g}{l}\sin(x_1)\end{bmatrix}\\
h(x) &amp;= x_1
\end{aligned}</span></p>
<p>If <span class="math inline">y=\pi</span> (upright), then <span class="math inline">\bar{x_1}=\pi</span>. So we have to solve:
<span class="math display">
\begin{bmatrix}0\\0\end{bmatrix} = \begin{bmatrix}
 \bar{x_2}\\
 \frac{3\bar{u}}{Ml} - \frac{3g}{l}\sin(\bar{x_1})
\end{bmatrix} \Rightarrow \bar{x_2}=0, \quad \bar{u}=0
</span></p>
<p>Therefore the equilibria are:
<span class="math display">
\begin{bmatrix}\bar{x_1}\\\bar{x_2}\end{bmatrix} = \begin{bmatrix}\pi + 2\pi k \\ 0\end{bmatrix}, \quad \bar{u}=0
</span></p>
<p>Assume that <span class="math inline">\dot{x}=f(x,u)</span> has an equilibrium configuration at <span class="math inline">(x,u)=(\bar{x}, \bar{u})</span>.</p>
<p><span class="math display">
f(x,u) \approx \underbrace{f(\bar{x}, \bar{u})}_{=0} + \underbrace{\frac{\partial f}{\partial x} \biggr|_{(x,u)=(\bar{x}, \bar{u})} (x - \bar{x})}_{=: A} + \underbrace{\frac{\partial f}{\partial u} \biggr|_{(x,u)=(\bar{x}, \bar{u})} (u - \bar{u})}_{=:B}</span></p>
<p>Consider deviations from <span class="math inline">(\bar{x}, \bar{u})</span>, where <span class="math inline">||\partial x||, ||\partial u||</span> are assumed to be small:
<span class="math display">\begin{aligned}
\partial x(t) &amp;:= x(t) - \bar{x}\\
\partial u(t) &amp;:= u(t) - \bar{u}\\
\end{aligned}</span></p>
<p>Then we get linearized state equations:
<span class="math display">\dot{\partial x} = \dot{x} - 0 = f(x,u) \approx A\partial x + B \partial u\\
\dot{\partial x} = A\partial x + B\partial u</span></p>
<p>Linearized output equation:</p>
<p><span class="math display">\partial y = \underbrace{\frac{\partial h}{\partial x} \biggr|_{(x,u)=(\bar{x},\bar{u})} \partial x}_{=:C} + \underbrace{\frac{\partial h}{\partial u} \biggr|_{(x,u)=(\bar{x},\bar{u})} \partial u}_{=:D}\\
\partial y := y-\bar{y}=y-h(\bar{x},\bar{u})</span></p>
<h3 id="obtaining-a-transfer-function-from-a-state-space-model">Obtaining a Transfer function from a state-space model</h3>
<ul>
<li>start w/ an LTI state-space model
<span class="math display">
\dot{\partial x(t)} = A\partial x + B\partial y\\
y(t) = Cx(t) + Dy(t)
</span></li>
<li>take LTs w/ zero initial conditions
<span class="math display">
sX(s) = AX(s) + BU(s)\\
Y(s) = CX(s) + DU(s)
</span>
<span class="math display">X(s) = \begin{bmatrix}
X_1(s)\\
\vdots\\
X_n(s)
\end{bmatrix}
</span>
<span class="math display">U(s) = \begin{bmatrix}
U_1(s)\\
\vdots\\
U_m(s)
\end{bmatrix}
</span>
<span class="math display">Y(s) = \begin{bmatrix}
Y_1(s)\\
\vdots\\
Y_p(s)
\end{bmatrix}
</span></li>
<li>eliminate <span class="math inline">X(S)</span>
<span class="math display">
\begin{aligned}
(sI - A)X(s) &amp;= BU(s) \\
X(s) &amp;= (sI - A)^{-1}BU(s)\\
Y(s) &amp;= \underbrace{(C(sI - A)^{-1}B + D)}_{G(s)}U(s)
\end{aligned}
</span>
<span class="math inline">G(s)</span> is the transfer function</li>
</ul>
<h4 id="summary-getting-a-transfer-function">Summary: Getting a transfer function</h4>
<ol type="1">
<li>Use first principles to obtain the ODEs that govern the system’s behaviour. Put into state-space form</li>
<li>Pick an equilibrium configuration <span class="math inline">(\bar{x}, \bar{u})</span> typically depends on a desired output <span class="math inline">\bar{y}</span> around which we wish to control the plant</li>
<li>Linearize <span class="math inline">(\bar{x}, \bar{u})</span> to get <span class="math inline">A, B, C, D</span></li>
<li>Transfer Function: <span class="math inline">G(s) = (sI - A)^{-1}B</span> MATLAB: <code>ss|tf</code></li>
</ol>
<h5 id="ex-2.8.6-recall-the-linearized-model-of-the-pendulum-in-the-upright-position">Ex: 2.8.6 Recall the linearized model of the pendulum in the upright position</h5>
<p><span class="math display">\begin{aligned}
\partial \dot{x} &amp;= \begin{bmatrix} 0 &amp; 1 \\ \frac{3g}{2l} &amp; 0 \end{bmatrix} \partial x + \begin{bmatrix}0 \\ \frac{3}{Ml^2}\end{bmatrix} \partial u\\
\partial y &amp;= \begin{bmatrix}1 &amp; 0\end{bmatrix} \partial x\\
\\
G(s) &amp;= C(sI-A)^{-1}B + D, \quad (sI-A)^{-1} = \frac{\text{adj}(sI-A)}{\det(sI-A)}\\
&amp;= \begin{bmatrix}1 &amp; 0\end{bmatrix}\begin{bmatrix}s &amp; -1 \\ \frac{-3g}{2l} &amp; s\end{bmatrix}^{-1}\begin{bmatrix}0 \\ \frac{3}{Ml^2}\end{bmatrix}\\
&amp;= \frac{\begin{bmatrix}1 &amp; 0\end{bmatrix}\begin{bmatrix}s &amp; \frac{3g}{2l} \\ 1 &amp; s\end{bmatrix}^T\begin{bmatrix}0 \\ \frac{3}{Ml^2}\end{bmatrix}}{s^2 - 1.5\frac{g}{l}}\\
&amp;= \frac{3}{(Ml^2)(s^2 - \frac{1.5g}{l})}\\
\end{aligned}</span></p>
<h4 id="summary">Summary</h4>
<ol type="1">
<li>Select an equilibrium configuration <span class="math inline">(\bar{x}, \bar{u}) \in \mathbb{R}^n \times \mathbb{R}^m</span>: <span class="math inline">\bar{y}=h(\bar{x},\bar{u}), f(\bar{x},\bar{u})=0</span></li>
<li>Compute Jacobians of <span class="math inline">f,h</span> to get <span class="math inline">A,B,C,D</span></li>
<li>Linearization: <span class="math inline">\dot{\partial x} = A \partial + B \partial u, \partial y = C \partial x + D \partial u</span></li>
</ol>
<h2 id="block-diagram-manipulations">Block diagram manipulations</h2>
<pre><code>         +------+
 U(s) --&gt;| G(s) |--&gt; Y(s)      Y(s) = G(s)U(s)
         +------+

          +------+
       +-&gt;| G(s) |--+
       |  +------+  |
 U(s) -+            +--&gt; Y(s)   Y(s) = (G(s) + H(s))U(s)
       |  +------+  |
       +-&gt;| H(s) |--+
          +------+

                                       D(s) 
                                        |
                                        v
                                     +-----+
                 D(s)                | 1/G |
                   |                 +-----+   
         +------+  v                     |   +------+
 U(s) --&gt;| G(s) |--o--&gt; Y(s)   =  U(s) --o--&gt;| G(s) |   Y(s) = D(s) + G(s)U(s)
         +------+                            +------+


            +------+
 U(s) --o--&gt;| G(s) |--+--&gt; Y(s)      Y(s) = G(s)U(s)/(1 + G(s)H(s))
        ^-  +------+  |
        |             |
        |   +------+  |
        +---| H(s) |--+
            +------+ 
</code></pre>
<h3 id="e.g.-linearized-pendulum">e.g. Linearized pendulum</h3>
<p>Find the transfer function from <span class="math inline">U</span> to <span class="math inline">Y</span></p>
<figure>
<img src="../../attachments/model.jpg" alt="" /><figcaption>model</figcaption>
</figure>
<h4 id="strategy-1-express-y-directly-in-terms-of-u-and-simplify">Strategy 1: Express Y directly in terms of U and simplify</h4>
<p><span class="math display">\begin{aligned}
Y(s) &amp;= G_2(s) (G_{ff}(s) U(s) + G_1(s) (U(s) - Y(s)))\\
\frac{Y(s)}{U(s)} = \frac{G_2G_{ff} + G_2G_1}{1 + G_2G_1}
\end{aligned}
</span></p>
<h4 id="strategy-2-re-arrange-block-to-reveal-common-configurations">Strategy 2: Re-arrange block to reveal common configurations</h4>
<ul>
<li>move <span class="math inline">G_1</span> to the left of negative feedback junction and swap locations of the negative feedback junction, and the positive feed forward junction<br />
<img src="../../attachments/model_rearranged.jpg" alt="model_rearranged" /></li>
<li>Now we have a parallel connection in series with a negative feedback connection</li>
</ul>
<p><span class="math display">
Y(s) = (G_{ff} + G_1)(\frac{G_2}{1 + GG_2})
</span></p>
<h2 id="systematic-method-of-finding-transfer-functions">Systematic method of finding transfer functions</h2>
<ol type="1">
<li>Introduce new signals <span class="math inline">\{v_1, v_2, ... \}</span> at the output of every summing junction</li>
<li>Write expressions for inputs of summers in terms of <span class="math inline">\{u, y, v_1, v_2, \dots\}</span></li>
<li>Write equations for each summer and <span class="math inline">y</span></li>
<li>Eliminate <span class="math inline">\{v_1, v_2, ...\}</span> from equations</li>
</ol>
<p>e.g.
<img src="../../attachments/blockdiagramtf.png" alt="blockdiagramtf" /></p>
<p><span class="math display">\begin{aligned}
y&amp;=G_3G_2v_2\\
v_2 &amp;= H_2y+G_1v_1-H_2G_2v_1\\
v_1&amp;=u-H_1G_2v_2\\
\\
\begin{bmatrix}1 &amp; H_1 G_2 &amp; 0 \\ -G_1 &amp; 1+H_2G_2 &amp; -H_3 \\ 0 &amp; -G_3G_2 &amp; 1\end{bmatrix}
 \begin{bmatrix}v_1 \\ v_2 \\ y\end{bmatrix} &amp;= \begin{bmatrix}u \\ 0 \\ 0\end{bmatrix}\\
\\
\text{By cramer&#39;s rule:}\\
Y(s) &amp;- \frac{
\det\begin{bmatrix}1 &amp; H_1G_2 &amp; u \\ -G_1 &amp; 1+H_2G_2 &amp; 0 \\ 0 &amp; -G_2G_3 &amp; 0\end{bmatrix}
}{
\det\begin{bmatrix}1 &amp; H_1G_2 &amp; 0 \\ -G_1 &amp; 1+H_2G_2 &amp; -H_3 \\ 0 &amp; -G_3G_2 &amp; 1\end{bmatrix}
}\\
&amp;= \frac{G_1 G_2 G_3}{1 + H_1 H_2 G_2 - H_3 G_3 G_2 + G_1 H_1 G_2} U(s)\\
\end{aligned}</span></p>
<h1 id="block-diagrams">Block Diagrams</h1>
<figure>
<img src="../../attachments/blocks.png" alt="" /><figcaption>blocks</figcaption>
</figure>
<p>Let <span class="math inline">\mathbb{R}(s)</span> be the set of all real rational transfer functions.</p>
<ul>
<li><span class="math inline">G(s) \in \mathbb{R}(s)</span> is <strong>proper</strong> if the degree of the denominator is greater than or equal to the numerator</li>
<li>Is is <strong>strictly proper</strong> if it is strictly greater</li>
</ul>
<p>A complex number <span class="math inline">x \in \mathbb{C}</span> is a <strong>zero</strong> of <span class="math inline">G(s)</span> if <span class="math inline">\lim_{s \rightarrow x} |G(s)| = 0</span>.</p>
<ul>
<li><p>Poles of <span class="math inline">G</span> are roots of the denominator</p></li>
<li><p>Zeroes are roots of the numerator</p></li>
<li><p>The transfer function obtained from a state space model is always rational and always proper</p></li>
</ul>
<h2 id="state-response">State Response</h2>
<p><span class="math display">\begin{aligned}
\dot{x}&amp;=Ax\\
x &amp;\in \mathbb{R}^n\\
A &amp;\in \mathbb{R}^{n \times n}\\
x(0) &amp;= x_0 \in \mathbb{R}^n \text{ (initial condition) }\\
\end{aligned}</span></p>
<p>Recall:</p>
<ol type="1">
<li>When <span class="math inline">n=1</span> (A is scalar), the solution is <span class="math inline">x(t)=e^{tA}x_0</span></li>
<li>Taylor series expansion of <span class="math inline">e^{At}=1 + At + \frac{(At)^2}{2!} + ...</span></li>
</ol>
<p>Motivated by 1 and 2, define the <strong>matrix exponential</strong>:
<span class="math display">e^A := I + A + \frac{A^2}{2!} + ...</span></p>
<h3 id="e.g.-3.1.1">e.g. 3.1.1</h3>
<p><span class="math display">\begin{aligned}
A &amp;= \begin{bmatrix}0 &amp; 0 \\ 0 &amp; 0\end{bmatrix}\\
\Rightarrow e^A &amp;= I + 0 + 0 + ...\\
&amp;= \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 1\end{bmatrix}\\
\end{aligned}</span></p>
<h3 id="e.g.-3.1.2">e.g. 3.1.2</h3>
<p><span class="math display">\begin{aligned}
A &amp;= \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 2\end{bmatrix}\\
\text{For a diagonal matrix:}\\
A^k &amp;= \begin{bmatrix}1^k &amp; 0 \\ 0 &amp; 2^k\end{bmatrix}\\
\Rightarrow e^A &amp;= I + \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 2\end{bmatrix} + \begin{bmatrix}1^2 &amp; 0 \\ 0 &amp; 2^2\end{bmatrix} + ...\\
&amp;= \begin{bmatrix}e^1 &amp; 0 \\ 0 &amp; e^2\end{bmatrix}\\
\end{aligned}</span></p>
<h3 id="e.g.-3.1.3">e.g. 3.1.3</h3>
<p><span class="math display">
A = \begin{bmatrix}0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0\end{bmatrix}\\
</span>
Check that <span class="math inline">A^3=0</span> (i.e. <span class="math inline">A</span> is nilpotent).
<span class="math display">
e^A = I + A + \frac{A^2}{2} = \begin{bmatrix}1 &amp; 1 &amp; \frac{1}{2} \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 1\end{bmatrix}\\
</span></p>
<p>Replace <span class="math inline">A</span> with <span class="math inline">tA</span> to get a function of time:
<span class="math display">e^{At} = I + tA + \frac{t^2A^2}{2!} + ...</span></p>
<p><strong>Theorem:</strong> The unique solution to <span class="math inline">\dot{x}=Ax, \quad x(0)=x_0</span> is <span class="math inline">x(t)=e^{tA}x_0</span>.</p>
<h2 id="using-laplace">Using Laplace</h2>
<p>Take the Laplace transform of <span class="math inline">\dot{x}=Ax</span> without assuming <span class="math inline">x(0)=0</span>:
<span class="math display">\begin{aligned}
sX(s) - x(0) &amp;= AX(s)\\
X(s) &amp;= (sI-A)^{-1} x(0)\\
\end{aligned}</span></p>
<p><strong>Conclusion</strong>: <span class="math inline">e^{At}</span> and <span class="math inline">(sI-A)^{-1}</span> are Laplace transform pairs.</p>
<h3 id="e.g.">e.g.</h3>
<p><span class="math display">\begin{aligned}
A &amp;= \begin{bmatrix}0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;0\end{bmatrix}\\
sI-A &amp;= \begin{bmatrix}s&amp;-1&amp;0\\0&amp;s&amp;-1\\0&amp;0&amp;s\end{bmatrix}\\
(sI-A)^{-1} &amp;= \frac{\text{adj}(sI-A)}{\det(sI-A)}\\
&amp;= \frac{1}{s^3} \begin{bmatrix}s^2&amp;s&amp;1\\0&amp;s^2&amp;s\\0&amp;0&amp;s^2\end{bmatrix}\\
e^{tA} &amp;= \mathcal{L}^{-1} \left\{ (sI-A)^{-1} \right\}\\
&amp;= \begin{bmatrix}1&amp;t&amp;\frac{t^2}{2}\\0&amp;1&amp;t\\0&amp;0&amp;1\end{bmatrix}, \quad t \ge 0\\
\end{aligned}</span></p>
<h2 id="total-response">Total Response</h2>
<p>The solution of <span class="math inline">\dot{x}=Ax+Bu</span>, <span class="math inline">y=Cx+Du</span>, <span class="math inline">x(0)=x_0</span> is:
<span class="math display">x(t) = \underbrace{e^{At}x_0}_\text{initial state response} + \underbrace{\int_0^t e^{A(t-\tau)} Bu(\tau)d\tau}_\text{forced response}</span>
<span class="math display">Y(t)=Cx(t)+Du(t)</span></p>
<p>In SISO (single-input-single-output) special case where <span class="math inline">x(0)=0</span>, we get the familiar result:
<span class="math display">\begin{aligned}
y(t)&amp;=(g * u)(t) = \int_0^t g(t-\tau)u(\tau)d\tau\\
g(t)&amp;=Ce^{At}B 1(t) + D\delta(t)
\end{aligned}</span>
Where <span class="math inline">1(t)</span> is the unit step function and <span class="math inline">\delta(t)</span> is the unit impulse.</p>
<h2 id="stability-of-state-space-models">Stability of state-space models</h2>
<p>The system <span class="math inline">\dot{x}=Ax</span> is <strong>asymptotically stable</strong> if <span class="math inline">x(t) \rightarrow 0</span> for any initial condition.</p>
<p><span class="math inline">e^{At} \rightarrow 0</span> if and only if all the eigenvalues of <span class="math inline">A</span> have a negative real part.</p>
<h3 id="e.g.-3.4.2">e.g. 3.4.2</h3>
<p><span class="math display">\begin{aligned}
M\ddot{q}&amp;=u-Kq \quad \text{(mass-spring)}\\
x &amp;= \begin{bmatrix}x_1\\x_2\end{bmatrix} := \begin{bmatrix}q\\\dot{q}\end{bmatrix}\\
\dot{x} &amp;= \begin{bmatrix}0&amp;1\\\frac{-k}{M}&amp;0\end{bmatrix}x + \begin{bmatrix}0\\\frac{1}{M}\end{bmatrix}u\\
\\
\text{Using } M=1, k=4:\\
e^{At} &amp;= \begin{bmatrix}\cos 2t&amp;\frac{1}{2}\sin 2t\\-2\sin 2t &amp; \cos 2t\end{bmatrix}\\
\end{aligned}</span></p>
<p>Since <span class="math inline">e^{At}</span> does not approach 0 as <span class="math inline">t</span> grows large, the system is not asymptotically stable.</p>
<p>Let’s double-check this using the eigenvalues. Solve for <span class="math inline">s</span> such that <span class="math inline">\det(sI-A)=0</span>.
<span class="math display">\begin{aligned}
A &amp;= \begin{bmatrix}0 &amp; 1 \\ -4 &amp; 0 \end{bmatrix}\\
\det \begin{bmatrix}s &amp; -1 \\ 4 &amp; s\end{bmatrix} &amp;= 0\\
s^2 + 4 &amp;= 0\\
s &amp;= \pm 2j
\end{aligned}</span>
The system is therefore not asymptotically stable since it has at least one eigenvalue (in this case, it has two) with a non-negative real part.</p>
<p>If we introduce friction:
<span class="math display">\begin{aligned}
\ddot{q} &amp;= u-4q-\dot{q}
\end{aligned}</span></p>
<p>Check that it is asymptotically stable (it should be)</p>
<h2 id="bounded-input-bounded-output-stability">Bounded input, bounded output stability</h2>
<p><span class="math display">
Y(s)=G(s)U(s) \quad \text{or} \quad y(t)=(g*u)(t), g(t)=\mathcal{L}^{-1}\left\{G(s)\right\}\\
</span></p>
<p>A signal <span class="math inline">u(t)</span> is <strong>bounded</strong> if there exists a constant <span class="math inline">b</span> such that, for all <span class="math inline">t \ge 0</span>, <span class="math inline">|u(t)| \le b</span>.</p>
<p>For example, <span class="math inline">\sin t</span> is bounded by <span class="math inline">b=1</span>.</p>
<p>If <span class="math inline">u</span> is bounded, <span class="math inline">||u||_\infty</span> denotes the <strong>least upper bound</strong>. For example, for <span class="math inline">\sin t</span>, then <span class="math inline">|u(t)| \le 10</span> and <span class="math inline">u</span> is bounded.</p>
<p>A linear, time-independent system is <strong>BIBO stable</strong> if every bounded input produces a bounded output. <span class="math inline">||u||_\infty</span> is finite <span class="math inline">\Rightarrow ||y||_\infty</span> is finite.</p>
<h3 id="e.g.-3.5.1">e.g. 3.5.1</h3>
<p><span class="math inline">G(s)=\frac{1}{s+2}</span>. The impulse response is <span class="math inline">g(t)=\mathcal{L}^{-1}\{G(s)\} = e^{-2t}</span>. Then:</p>
<p><span class="math display">\begin{aligned}
y(t) &amp;=(g * u)(t)\\
&amp;= \int_0^t e^{-2\tau} u(t-\tau) d\tau\\
\forall t \ge 0:\\
|y(t)|&amp;=\left|\int_0^t e^{-2\tau} u(t-\tau) d\tau\right|\\
&amp;\le \int_0^t \left|e^{-2\tau} u(t-\tau) \right| d\tau\\
&amp;\le \int_0^t e^{-2\tau} d\tau ||u||_\infty\\
&amp;\le \int_0^\infty e^{-2\tau} d\tau ||u||_\infty\\
&amp;= \frac{1}{2} ||u||_\infty\\
\\
||y||_\infty &amp;\le \frac{1}{2} ||u||_\infty\\
\therefore \text{ system is BIBO stable. }
\end{aligned}</span></p>
<h2 id="bibo-and-poles">BIBO and poles</h2>
<p><strong>Theorem 3.5.4:</strong> Assume that <span class="math inline">G(s)</span> is rational and strictly proper. Then the following are equivalent:</p>
<ol type="1">
<li><span class="math inline">G</span> is BIBO stable.</li>
<li>the impulse response <span class="math inline">g(t)=\mathcal{L}^{-1}\{G(s)\}</span> is absolutely integrable: <span class="math inline">\int_0^\infty |g(\tau)| d\tau \lt \infty</span></li>
<li>Every pole of <span class="math inline">G</span> has a negative real part</li>
</ol>
<p>For example, <span class="math inline">\frac{1}{s+1}, \frac{1}{(s+3)^2}, \frac{s-1}{s^2+5s+6}</span> are all BIBO stable because their poles have a negative real part.</p>
<p>On the other hand, take <span class="math inline">\frac{1}{s}, \frac{1}{s-1}</span>. These are all BIBO unstable because they have poles which do not have a negative real part. The function <span class="math inline">\frac{1}{s}</span> is an integrator, so when you give it a constant function as an input, the output will be a ramp, which is unbounded.</p>
<p><strong>Theorem 3.5.5:</strong> If <span class="math inline">G(s)</span> is rational and improper (the degree of the numerator is greater than the degree of the denominator), then <span class="math inline">G</span> is not BIBO stable.</p>
<h2 id="stability-of-state-space-models-and-bibo-stability">Stability of state-space models and BIBO stability</h2>
<p><span class="math display">\begin{aligned}
\dot{x} &amp;= Ax+Bu\\
y&amp;\text{ } *= Cx+Du\\
\Rightarrow Y(s) &amp;= \left(C(SI-A)^{-1}B + D\right)U(s)\\
&amp;= \left(C\frac{\text{adj}(sI-A)}{\det(sI-A)}B + D\right)U(s)\\
\end{aligned}</span></p>
<p>This is BIBO stable if all poles in <span class="math inline">\Re(s) \lt 0</span></p>
<p>This is asymptotically stable if all eigenvalues of <span class="math inline">A \in \Re(s) \lt 0</span></p>
<p>Eigenvalues of <span class="math inline">A</span> = roots of <span class="math inline">\det(sI-A) \supseteq</span> poles of <span class="math inline">G(s)=C(sI-A)^{-1}B+D</span></p>
<h3 id="e.g.-3.5.5-mass-spring">e.g. 3.5.5: mass-spring</h3>
<p><span class="math display">\begin{aligned}
\dot{x} &amp;= \begin{bmatrix}0&amp;1\\-4&amp;0\end{bmatrix}x + \begin{bmatrix}0\\1\end{bmatrix}u\\
y &amp;= \begin{bmatrix}1 &amp; 0\end{bmatrix} x
\end{aligned}</span></p>
<p>Eigenvalues of <span class="math inline">A</span> are <span class="math inline">\pm 2j \Rightarrow</span> the system is not asymptotically stable.</p>
<p><span class="math display">\begin{aligned}
\frac{Y(s)}{U(s)} &amp;= \begin{bmatrix}1&amp;0\end{bmatrix}\begin{bmatrix}s&amp;1\\4&amp;s\end{bmatrix}^{-1}\begin{bmatrix}0\\1\end{bmatrix}\\
&amp;=\frac{1}{s^2+4}\\
&amp;=G(s)
\end{aligned}</span>
The system is not BIBO stable based on its poles.</p>
<p>In this example, <span class="math inline">C\text{adj}(sI-A)B=1</span> and <span class="math inline">\det(sI-A)=s^2+4</span> are coprime, so eigenvalues of <span class="math inline">A</span> are the poles of <span class="math inline">G</span>.</p>
<h2 id="steady-state-gain">Steady-state gain</h2>
<p>Apply a constant <span class="math inline">b</span> as input to a system. When we observe the output, the <strong>steady-state gain</strong> of a transfer function <span class="math inline">G(s)</span> is <span class="math inline">\frac{Y_{ss}}{b}</span>.</p>
<p><strong>Final Value Theorem (3.6.1)</strong>: Given <span class="math inline">F(s)=\mathcal{L}\{f(t)\}</span>, where <span class="math inline">F(s)</span> is rational:</p>
<ol type="1">
<li>If <span class="math inline">F(s)</span> has all of its poles in <span class="math inline">\Re(s) \lt 0</span>, then <span class="math inline">\lim_{t \rightarrow \infty} f(t) = 0</span>.</li>
<li>If <span class="math inline">sF(s)</span> has all poles in <span class="math inline">\Re(s) \lt 0</span>, then <span class="math inline">\lim_{t \rightarrow \infty} f(t) = \lim_{s \rightarrow 0} sF(s)</span></li>
<li>If <span class="math inline">sF(s)</span> has even one pole with <span class="math inline">\Re(s) \ge 0</span>, then <span class="math inline">f(t)</span> does not converge.</li>
</ol>
<p>For example: <span class="math inline">F(s) = \frac{1}{s^2}, sF(s) = \frac{1}{s}</span>. <span class="math inline">f(t)=t</span>, which does not converge.</p>
<p>e.g.:</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">f(t)</span></th>
<th><span class="math inline">\lim_{t \Rightarrow \infty} f(t)</span></th>
<th><span class="math inline">F(s)</span></th>
<th><span class="math inline">\lim_{s \rightarrow 0} sF(s)</span></th>
<th>FVT case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">e^{-t}</span></td>
<td>0</td>
<td><span class="math inline">\frac{1}{s+1}</span></td>
<td>0</td>
<td>1 or 2</td>
</tr>
<tr class="even">
<td><span class="math inline">1(t)</span></td>
<td>1</td>
<td><span class="math inline">\frac{1}{s}</span></td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td><span class="math inline">t</span></td>
<td><span class="math inline">\infty</span></td>
<td><span class="math inline">\frac{1}{s^2}</span></td>
<td><span class="math inline">\infty</span></td>
<td>3</td>
</tr>
<tr class="even">
<td><span class="math inline">te^{-t}</span></td>
<td>0</td>
<td><span class="math inline">\frac{1}{(s+1)^2}</span></td>
<td>0</td>
<td>1 or 2</td>
</tr>
<tr class="odd">
<td><span class="math inline">e^t</span></td>
<td><span class="math inline">\infty</span></td>
<td><span class="math inline">\frac{1}{s-1}</span></td>
<td>0</td>
<td>3</td>
</tr>
<tr class="even">
<td><span class="math inline">\cos{\omega t}</span></td>
<td>N/A</td>
<td><span class="math inline">\frac{s}{s^2 + \omega^2}</span></td>
<td>0</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Theorem 3.6.2</strong>: If <span class="math inline">G(s)</span> is BIBO stable and we input <span class="math inline">u(t)=b1(t)</span>, then the steady state gain <span class="math inline">y_{ss}=bG(0)</span>. This can be proven using the final value theorem.</p>
<p>This is to say, steady-state gain is <em>always</em> <span class="math inline">\frac{y_{ss}}{b}=G(0)</span> for any <span class="math inline">b</span>.</p>
<h3 id="e.g.-set-point-control">e.g. Set-point control</h3>
<p><span class="math inline">\dot{x}=-2x+u</span>, <span class="math inline">y=x</span>.</p>
<p>This gives the transfer function <span class="math inline">Y(s)=\frac{1}{d+2}U(s)</span>.</p>
<p>Given a constant reference <span class="math inline">r(t)=r_o 1(t)</span> where <span class="math inline">r_0</span> constant, find a control signal <span class="math inline">u</span> to make <span class="math inline">y</span> go to <span class="math inline">r</span>.</p>
<p>We want <span class="math inline">\lim_{t \rightarrow \infty} y(t) = r_0</span>.</p>
<p>Try open loop:
<img src="../../attachments/setpointcontrol.png" alt="setpointcontrol" /></p>
<p><span class="math display">\begin{aligned}
y_{ss} &amp;= \lim_{t \rightarrow \infty} y(t)\\
&amp;=^? \lim_{s\rightarrow 0} sC(s)R(s) \\
&amp;= \lim_{s\rightarrow 0} C(s) \frac{1}{s+2} r_0\\
\end{aligned}</span></p>
<p>If <span class="math inline">C(s)</span> is BIBO stable, then <span class="math inline">y_{ss} = \lim_{s \rightarrow 0} C_s \frac{r_0}{s+2} = C(0) \frac{1}{2} r_0</span>. So, <span class="math inline">y_{ss} = r_0 \Leftrightarrow C(0) = 2 = \frac{1}{P(0)}</span>.</p>
<p>The simplest choice is <span class="math inline">C(s) = \frac{1}{P(0)} = 2</span>, a proportional controller.</p>
<h2 id="frequency-response">Frequency response</h2>
<p><span class="math inline">Y(s)=G(s)U(s)</span> or <span class="math inline">y(t)=(g*u)(t)</span>.</p>
<p>Assume <span class="math inline">G</span> is BIBO stable, and the input signal <span class="math inline">u</span> is a sinusoid: <span class="math inline">u(t) = \cos(\omega t)</span>.</p>
<p>The period is <span class="math inline">\frac{2\pi}{\omega}</span>.</p>
<p><strong>Theorem 3.7.1</strong>: Assuming <span class="math inline">G</span> is rational and BIBO stable, then if <span class="math inline">u(t)=\cos(\omega t)</span>, then the steady-state output is <span class="math inline">y(t) = A\cos(\omega t + \phi)</span>. <span class="math inline">A=|G(j\omega)|</span>, and <span class="math inline">\phi = \angle G(j\omega)</span></p>
<h3 id="e.g.-1">e.g.</h3>
<p><span class="math inline">\dot{x}=-10x+u</span>, <span class="math inline">y=x</span>. Then <span class="math inline">Y(s) = \frac{1}{s+10}U(s) =: G(s)U(s)</span>. If <span class="math inline">u(t)=2\cos(3t+ \frac{\pi}{6})</span>, what is the steady-state output?</p>
<ul>
<li><span class="math inline">A=-10</span>, so <span class="math inline">\det(sI-A)=s+10</span>. The eigenvalue of <span class="math inline">A</span> is -10, so the system is asymptotically stable.</li>
<li>Because the system is asymptotically stable, which implies it is BIBO stable, which means Theorem 3.7.1 applies.</li>
<li>From Theorem 3.7.1, the steady state output is <span class="math inline">y(t)=2A\cos(3t + \frac{\pi}{6} + \phi)</span>.</li>
</ul>
<p><span class="math inline">A=|G(3j)|=\left|\frac{1}{3j+10}\right|\approx 0.1</span>
<span class="math inline">\phi = \angle G(3j) = \angle \frac{1}{3j+10} = \angle1 - \angle(3j+10) \approx 0.2915</span></p>
<p>Therefore <span class="math inline">y(t)=0.2\cos(3t+\frac{\pi}{6}-0.2915)</span>.</p>
<p><strong>Definition 3.7.2.</strong> If <span class="math inline">G(s) \in \mathbb{R}(s)</span> and is BIBO stable, then:</p>
<ol type="1">
<li>The function <span class="math inline">\mathbb{R} \rightarrow \mathbb{C}, \quad \omega \mapsto G(j\omega)</span> is the <strong>frequency response</strong></li>
<li>The function <span class="math inline">\mathbb{R} \rightarrow \mathbb{R}, \quad \omega \mapsto |G(j\omega)|</span> is the <strong>magnitude response</strong></li>
<li>The function <span class="math inline">\mathbb{R} \rightarrow (-\pi, \pi], \quad \omega \mapsto \angle G(j\omega)</span> is the <strong>phase response</strong></li>
</ol>
<h2 id="graphical-representations-of-frequency-response">Graphical representations of frequency response</h2>
<ul>
<li>When we graph <span class="math inline">G(j\omega)</span>, we only consider <span class="math inline">\omega \ge 0</span>, so there is no loss of info when <span class="math inline">G</span> is rational: <span class="math inline">|G(j\omega)|=|G(j\omega)|</span>, and <span class="math inline">\angle G(j\omega) = -\angle G(-j\omega)</span></li>
</ul>
<h3 id="bode-plots">Bode plots</h3>
<ol type="1">
<li>Magnitude plot: <span class="math inline">20\log|G(j\omega)|</span> vs <span class="math inline">\log(\omega)</span></li>
<li>Phase plot: <span class="math inline">\angle G(j \omega)</span> vs <span class="math inline">\log(\omega)</span></li>
</ol>
<p>To sketch the Bode plot of any rational transfer function, we only need to know how to sketch four terms:</p>
<ol type="1">
<li>Pure gain: <span class="math inline">G(s)=K</span></li>
<li>First-order terms: <span class="math inline">G(s) = \tau s \pm 1, \quad \tau \gt 0</span></li>
<li>Zeroes at <span class="math inline">s=0</span>: <span class="math inline">G(s)=s^n</span></li>
<li>Complex conjugate roots: <span class="math inline">G(s)=s^2 + 2\zeta \omega_n s + \omega_n^2 = \omega_n^2\left(\frac{s^2}{\omega_n^2} + \frac{2\zeta s}{\omega_n} + 1\right)</span></li>
</ol>
<p>Given a transfer function, we can decompose it into these terms.</p>
<h3 id="polar-plots">Polar plots</h3>
<p><span class="math inline">\Re(G(j\omega))</span> vs <span class="math inline">\Im(G(j\omega))</span></p>
<h3 id="e.g.-3.8.5">e.g. 3.8.5</h3>
<p><span class="math display">\begin{aligned}
G(s) &amp;= \frac{40s^2(s-2)}{(s+5)(s^2 + 4s+100)}\\
&amp;= \frac{40s^2(2)\left(\frac{s}{2}-1\right)}{5(100)\left(\frac{3}{5}+1\right)\left(\frac{s^2}{10^2}+\frac{4s}{10}+j\right)}\\
&amp;= \frac{40(2)}{5(100)} \cdot \frac{s^2(\frac{s}{2}-1)}{(\frac{s}{5}+1)(\frac{s^2}{10^2}+\frac{4s}{10^2}+1)}\\
\end{aligned}</span></p>
<h3 id="e.g.-3.8.6">e.g. 3.8.6</h3>
<p>To plot the Bode plot, we need:
<span class="math display">\begin{aligned}
20\log|G(j\omega)|&amp;=20\log\left|\frac{80}{500}\right| + 20\log|(j\omega)^2| + 30\log\left|\frac{j\omega}{2}-1\right|\\
&amp;=-20\log\left|\frac{j\omega}{5}+1\right| - 20\log\left|\frac{(j\omega)^2}{10^2} + \frac{4}{10^2}j\omega + 1\right|\\
\\
\angle G(j\omega)&amp;=\angle\frac{800}{500}+\angle(j\omega)^2 + \angle\frac{j\omega}{2}+1-\angle\frac{j\omega}{5}+1-\angle\left(\frac{(j\omega)^2}{10^2}+\frac{4}{10^2}j\omega + 1\right)\\
\end{aligned}</span></p>
<h3 id="e.g.-plot">e.g. plot</h3>
<p>For <span class="math inline">G(j\omega)=K</span>:</p>
<p>Polar:
<img src="../../attachments/constpolar.png" alt="constpolar" /></p>
<p>Bode:
<img src="../../attachments/constbode.png" alt="constbode" /></p>
<p>For <span class="math inline">G(j\omega)=j\tau \omega + 1</span> (the transfer function with a zero at <span class="math inline">s=\frac{-1}{\tau}</span>)</p>
<p>Polar:
<img src="../../attachments/firstorderpolar.png" alt="firstorderpolar" /></p>
<p>Bode:</p>
<p>Approximations for sketching:</p>
<ol type="1">
<li>For <span class="math inline">\omega \lt \frac{1}{\tau}</span>, <span class="math inline">\Im(G(j\omega)) \approx 0 \Rightarrow \forall \omega \lt \frac{1}{\tau}, \quad 20\log|G(j\omega)| \approx 20\log|1|=0</span></li>
<li>For <span class="math inline">\omega \ge \frac{1}{\tau}</span>, <span class="math inline">\Re(G) \gt \gt \Im(G) \Rightarrow \omega \ge \frac{1}{\tau}, \quad 20\log|G(j\omega)| \approx 20\log|j \tau \omega|</span></li>
<li>For <span class="math inline">\omega \lt\lt \frac{1}{\tau}</span>, <span class="math inline">\angle G(j\omega)\approx \angle 0j+1 = 0</span> (<span class="math inline">\omega \lt\lt \frac{1}{\tau}</span> means <span class="math inline">\omega \le \frac{0.1}{\tau}</span>)</li>
<li>For <span class="math inline">\omega \gt\gt \frac{1}{\tau}</span>, <span class="math inline">\angle G(j\omega)\approx \angle j\omega\tau = \frac{\pi}{2}</span> (<span class="math inline">\omega \gt\gt \frac{1}{\tau}</span> means <span class="math inline">\omega \ge \frac{10}{\tau}</span>)</li>
<li>Linear interpolation between <span class="math inline">\frac{0.1}{\tau}</span> and <span class="math inline">\frac{10}{\tau}</span></li>
</ol>
<figure>
<img src="../../attachments/firstorderbode.png" alt="" /><figcaption>firstorderbode</figcaption>
</figure>
<p>Sub-case: <span class="math inline">G(s) = \tau s - 1</span> (zero at <span class="math inline">s=\frac{1}{\tau}</span>)</p>
<p>Polar plot:
<img src="../../attachments/firstorderpolarsubcase.png" alt="firstorderpolarsubcase" />
- From the polar plot, the magnitude Bode plot is unchanged
- for the phase plot, start at <span class="math inline">\pi</span> for small <span class="math inline">\omega</span> and goes to <span class="math inline">\frac{\pi}{2}</span> as <span class="math inline">\omega \rightarrow \infty</span></p>
<figure>
<img src="../../attachments/firstordersubcasebode.png" alt="" /><figcaption>firstordersubcasebode</figcaption>
</figure>
<p>e.g. <span class="math inline">G(s) = \frac{100}{s+10} = \frac{100}{10} \cdot \frac{1}{\frac{s}{10}+1} = 10 \frac{1}{\frac{s}{10}+1}</span></p>
<p>Frequency response: <span class="math inline">G(j\omega)=10\frac{1}{\frac{j\omega}{10}+1}</span>
Magnitude: <span class="math inline">20\log|G(j\omega)|=\underbrace{20\log10}_{A}-\underbrace{20\log\left|\frac{j\omega}{10}+1\right|}_B</span>
Phase: <span class="math inline">\angle G(j\omega) = \underbrace{\angle 10}_A - \underbrace{\angle \frac{j\omega}{10}+1}_B</span></p>
<figure>
<img src="../../attachments/bodeplotex.png" alt="" /><figcaption>bodeplotex</figcaption>
</figure>
<p>The <strong>bandwidth</strong> of the above system is the smallest frequency <span class="math inline">\omega_{BW}</span> such that:
<span class="math display">|G(j\omega_{BW})|=\frac{1}{\sqrt{2}}|G(0)|</span>
In dB: <span class="math inline">20\log|G(0)|-20\log|G(j\omega)|=3dB</span></p>
<p>From the Bode plot, <span class="math inline">\omega_{BW}=1.0 \text{ rad/s}</span></p>
<p>e.g. <span class="math inline">G(s)=s^n</span></p>
<ul>
<li>When <span class="math inline">n=1</span>: <span class="math inline">G(j\omega)=j\omega</span></li>
<li>When <span class="math inline">n=2</span>: <span class="math inline">G(j\omega)=-\omega^2</span></li>
<li>When <span class="math inline">n=3</span>: <span class="math inline">G(j\omega)=-j\omega^3</span></li>
<li>When <span class="math inline">n=4</span>: <span class="math inline">G(j\omega)=\omega^4</span></li>
</ul>
<p><img src="../../attachments/spowerofnpolar.png" alt="spowerofnpolar" />
<img src="../../attachments/spowerofnbode.png" alt="spowerofnbode" /></p>
<h3 id="e.g.-complex-conjugate-zeroes">e.g. Complex conjugate zeroes</h3>
<p><span class="math display">G(s) = \frac{s^2}{\omega_n^2}+\frac{2\zeta}{\omega_n}s + 1, \quad \zeta \in [0,1), \quad \omega_n \ne 0</span>
<span class="math display">G(j\omega)=\left(1-\frac{\omega^2}{\omega_n^2}\right) + j\cdot 2\zeta \frac{\omega}{\omega_n}</span></p>
<figure>
<img src="../../attachments/complexconjugatezeroes.png" alt="" /><figcaption>complexconjugatezeroes</figcaption>
</figure>
<p>Observations:
- If <span class="math inline">\omega \lt\lt |\omega_n|</span>, <span class="math inline">|G(j\omega)| \approx 1</span>, <span class="math inline">\angle G(j\omega) \approx 0</span>
- If <span class="math inline">\omega \gt\gt |\omega_n|</span>, <span class="math inline">|G(j\omega)| \approx \frac{\omega^2}{\omega_n^2}</span>, <span class="math inline">\angle G(j\omega) \approx 180^{\circ}</span></p>
<p>For asymptotic Bode plots of complex conjugate roots, approximate <span class="math inline">G(s)</span> as two first order terms with roots at <span class="math inline">-\omega_n</span>. i.e., set <span class="math inline">\zeta=1</span>:
<span class="math display">\begin{aligned}
G(s)&amp;=\frac{s^2}{\omega_n^2}+\frac{2\zeta s}{\omega_n} + 1\\
&amp;\approx \frac{s^2}{\omega_n^2}+\frac{2s}{\omega_n}+1\\
&amp;=\left(\frac{s}{\omega_n}+1\right)^2\\
&amp;= (\tau s + 1)^2, \quad \tau = \frac{1}{\omega_n}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/complexconjugatezeroesbode.png" alt="" /><figcaption>complexconjugatezeroesbode</figcaption>
</figure>
<h2 id="summary-1">Summary</h2>
<ul>
<li>definition of asymptotic stability and how to test</li>
<li>definition of BIBO stability and how to test</li>
<li>relationship between asymptotic stability and BIBO stabilities</li>
<li>final value theorem, steady-state gain <span class="math inline">G(0)</span></li>
<li>frequency response physical meaning and how to draw Bode plots</li>
</ul>
<h3 id="domains">Domains</h3>
<figure>
<img src="../../attachments/formats.png" alt="" /><figcaption>formats</figcaption>
</figure>
<h3 id="state-space-models-1">State-space models</h3>
<p><span class="math display">g(t) = Ce^{At} 1(t) + D \delta(t)</span>
<span class="math display">G(s) = C(sI-A)^{-1}B+D</span></p>
<h1 id="first-and-second-order-systems">First and Second Order Systems</h1>
<p>We study two specific but useful systems</p>
<h2 id="objective">Objective</h2>
<ul>
<li>Understand how pole locations determine time domain behaviour</li>
</ul>
<h2 id="first-order">First order</h2>
<p><span class="math display">\tau \dot{y} = ku</span>
or
<span class="math display">\frac{Y(s)}{U(s)} = \frac{K}{\tau s + 1}</span>
or
<span class="math display">\begin{aligned}
\dot{x}&amp;=\frac{-x}{\tau} + \frac{K}{\tau} u\\
y &amp;= x
\end{aligned}</span></p>
<p>Observations:</p>
<ul>
<li>Pole at <span class="math inline">s=\frac{-1}{\tau}</span></li>
<li>No zeroes</li>
<li>BIBO stable if and only if <span class="math inline">\tau \gt 0</span></li>
<li>steady-state gain: <span class="math inline">K</span></li>
<li>bandwidth: <span class="math inline">\frac{1}{\tau}</span> rad/s</li>
<li>Impulse response: <span class="math inline">g(t)=\frac{K}{\tau} e^{-1/\tau} 1(t)</span>
<ul>
<li><span class="math inline">g(0)=\frac{K}{\tau}</span></li>
<li><span class="math inline">g(\tau)=g(0)e^{-1} \approx 0.37g(0)</span></li>
<li><span class="math inline">g(2\tau)=g(0)e^{-2} \approx 0.14g(0)</span></li>
</ul></li>
<li>Higher bandwidth implies faster impulse response, and vice versa</li>
</ul>
<p>Step response: <span class="math inline">u(t) = 1(t)</span>
<span class="math display">y(t) = \mathcal{L}^{-1}\{G(s)U(s)\} = \mathcal{L}^{-1}\left\{\frac{K}{\tau s + 1} \frac{1}{s}\right\} = \mathcal{L}^{-1}\left\{\frac{K}{s} - \frac{K}{s + \frac{1}{\tau}}\right\}</span>
<span class="math display">K(1-e^{\frac{-t}{\tau}}), \quad t \ge 0</span></p>
<figure>
<img src="../../attachments/firstordertime.png" alt="" /><figcaption>firstordertime</figcaption>
</figure>
<p>Observations: [Sampling every <span class="math inline">\tau</span> seconds]</p>
<ol type="1">
<li>After <span class="math inline">4\tau</span> seconds, <span class="math inline">y(t)</span> is within 2% of its steady-state value</li>
<li>For all <span class="math inline">t \gt 0</span>, <span class="math inline">y(t) \lt y_{ss}</span> (no overshoot)</li>
<li><span class="math inline">y(t)</span> increases monotonically (no oscillations)</li>
<li>Decrease in <span class="math inline">\tau \Leftrightarrow</span> step response gets faster <span class="math inline">\Leftrightarrow</span> bandwidth goes up <span class="math inline">\Leftrightarrow</span> poles move to the left</li>
</ol>
<h3 id="e.g.-2">e.g.</h3>
<p><img src="../../attachments/firstordersystem.jpg" alt="firstordersystem" />
<span class="math display">Y(s) = \frac{K_pK}{T_s + 1 + K+pK} = \frac{\frac{K_pK}{1 + K_pK}}{\frac{\tau s}{1 + K_pK} + 1}</span></p>
<p>If <span class="math inline">r(t) = 1(t)</span> and all initial conditions are zero</p>
<p><span class="math display">y(t) = \frac{K_pK}{1 + K_pK}(1 - e^{\frac{-t}{\frac{\tau}{1 + K_pK}}})\;t\geq 0</span></p>
<ul>
<li>“high gain” (large values of <span class="math inline">K_p</span>) results in a faster response (pole moves left)</li>
<li>high gain also produces large control signals which may not be implementable</li>
</ul>
<hr />
<h2 id="second-order">Second order</h2>
<p><span class="math display">\ddot{y}+2\zeta\omega_n \dot{y} + \omega_n^2 y = K\omega_n^2 u</span>
or
<span class="math display"> \frac{Y(s)}{U(s)} = \frac{K\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}</span>
or
<span class="math display">\begin{aligned}
\dot{x} &amp;= \begin{bmatrix}0&amp;1\\-\omega_n^2&amp;-2\zeta\omega_n\end{bmatrix}x + \begin{bmatrix}0\\K\omega_n^2\end{bmatrix}u\\
y &amp;= \begin{bmatrix} 1 &amp; 0\end{bmatrix}x\\
\end{aligned}</span></p>
<h3 id="e.g.-3">e.g.</h3>
<figure>
<img src="../../attachments/secondorderspring.png" alt="" /><figcaption>secondorderspring</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
M \ddot{q} &amp;= u - K_{spring} q - b\dot{q}\\
\frac{Y(s)}{U(s)} &amp;= \frac{\frac{1}{M}}{s^2 + \frac{b}{M}s + \frac{K_{spring}}{M}}\\
\\
\omega_n &amp;= \sqrt{\frac{K_{spring}}{M}}\\
\zeta &amp;= \frac{b}{2 \sqrt{K_{spring}M}}\\
K &amp;= \frac{1}{K_{spring}}
\end{aligned}</span></p>
<h3 id="pole-locations">Pole locations</h3>
<p>From the quadratic formula, find the zeroes of the denominator:
<span class="math display">s = -\zeta \omega_n \pm \omega_n \sqrt{\zeta^2 - 1} = \omega_n\left(-\zeta \pm \sqrt{\zeta^2 - 1}\right)</span></p>
<figure>
<img src="../../attachments/secondorderpolelocations.png" alt="" /><figcaption>secondorderpolelocations</figcaption>
</figure>
<p>Pole locations are used to categorize the system:</p>
<ul>
<li>Undamped <span class="math inline">\zeta = 0</span></li>
<li>Underdamped <span class="math inline">0 \lt \zeta \lt 1</span></li>
<li>Critically damped <span class="math inline">\zeta = 1</span></li>
<li>Overdamped <span class="math inline">\zeta \gt 1</span></li>
</ul>
<p>Steady-state gain: <span class="math inline">K</span>
Zeroes: none</p>
<figure>
<img src="../../attachments/secondordergian.png" alt="" /><figcaption>secondordergian</figcaption>
</figure>
<h3 id="step-response">Step response</h3>
<figure>
<img src="../../attachments/secondorderstepresponse.png" alt="" /><figcaption>secondorderstepresponse</figcaption>
</figure>
<h2 id="underdamped-systems">Underdamped Systems</h2>
<ul>
<li>Poles are complex conjugate: <span class="math inline">s = -\zeta \omega_n \pm j\omega_n \sqrt{1 - \zeta^2} = \omega_n e^{\pm j (\pi - \theta)}, \theta = \arccos(\zeta)</span></li>
</ul>
<figure>
<img src="../../attachments/underdampedpolar.png" alt="" /><figcaption>underdampedpolar</figcaption>
</figure>
<h4 id="impulse-response">Impulse response</h4>
<p><span class="math display">g(t) = K\frac{\omega_n}{\sqrt{1-\zeta^2}} \underbrace{e^{-\zeta \omega_n t}}_\text{decay rate} \sin\underbrace{\left(\omega_n \sqrt{1-\zeta^2} t\right)}_\text{oscillation rate}, \quad t \ge 0</span></p>
<p>Observe: If we fix <span class="math inline">\zeta \in (0,1)</span>, then larger bandwidth <span class="math inline">\Leftrightarrow</span> faster decay</p>
<h4 id="step-response-1">Step response</h4>
<p><span class="math display">\begin{aligned}
u(t) &amp;= 1(t)\\
\Rightarrow U(s) &amp;= \frac{1}{s}\\
\\
Y(s) &amp;= G(s)U(s)\\
\Rightarrow y(t) &amp;= \mathcal{L}^{-1}{G \dot U}\\
&amp;= K\left(1 - \frac{1}{\sqrt{1 - \zeta^2}} e^{-\zeta \omega_n t} \sin\left(\omega_n \sqrt{1 - \zeta^2}t + \theta\right)\right), \quad \theta = \arccos \zeta\\
\end{aligned}</span></p>
<h3 id="summary-2">Summary</h3>
<ul>
<li>As <span class="math inline">\zeta \rightarrow 1</span>, response is less oscilatory, less overshoot, imaginary part of poles approaches zero</li>
<li>As <span class="math inline">\zeta \rightarrow 0</span>, response is more oscillatory, more overshoot, real part of poles approaches 0</li>
<li><span class="math inline">\omega_{BW} \approx \omega_n</span>. As <span class="math inline">\omega_n \rightarrow \infty</span>, response is faster, poles have larger magnitude.</li>
<li>Frequency of oscillation depends on imaginary part of the poles; rate of decay depends on the real part</li>
</ul>
<h2 id="general-characteristics-of-step-response">General characteristics of step response</h2>
<ul>
<li>Look at common metrics to quantify the quality</li>
<li>metrics apply to <strong>any</strong> system</li>
<li>we use <span class="math inline">G(s) = \frac{K \omega_n^2}{s^2 + 2\zeta \omega_n s + \omega_n^2}</span> to get equations for the metrics in therms of <span class="math inline">K, \omega_n, \zeta</span></li>
</ul>
<figure>
<img src="../../attachments/stepcharacteristics.png" alt="" /><figcaption>stepcharacteristics</figcaption>
</figure>
<h3 id="overshoot">Overshoot</h3>
<ul>
<li>only undamped second order systems have it:
<span class="math display">\%OS = \frac{||y||_\infty - |G(0)|}{|G(0)|}</span></li>
<li>only depends on dampting ratio:
<span class="math display">\%OS = \exp\left(\frac{-\zeta \pi}{\sqrt{1 - \zeta^2}}\right), \quad 0 \lt \zeta \lt 1</span></li>
<li>More damping (larger <span class="math inline">\zeta</span>) <span class="math inline">\Leftrightarrow</span> less overshoot</li>
</ul>
<h4 id="e.g.-mass-spring-damper">e.g. mass-spring damper</h4>
<p><span class="math display">\frac{Y(s)}{U(s)} = \frac{\frac{1}{M}}{s^2 + \frac{b}{M}s + \frac{K_{spring}}{M}}</span></p>
<ul>
<li>Find conditions on <span class="math inline">M,b,K_{spring}</span> so that <span class="math inline">\%OS \le \%OS_{max} = 0.05</span></li>
</ul>
<p><span class="math display">\begin{aligned}
\zeta &amp;= \frac{b}{2\sqrt{MK_{spring}}}\\
\zeta &amp;\ge \frac{-\ln(\%OS_{max})}{\sqrt{\pi^2 + (\ln\%OS_{max})^2}} =:\zeta_{min}\\
\\
\text{To meet specs:}\\
\frac{b}{2\sqrt{MK_{spring}}} \ge 0.6901\\
\end{aligned}</span></p>
<p>The angle the poles make is <span class="math inline">\pm(\pi - \arccos \zeta)</span>.
<span class="math display"> \zeta \ge \zeta_{min} \Leftrightarrow \theta \le \arccos(\zeta_{min})</span>
In this example, <span class="math inline">\theta \le 46^{\circ}</span>
<img src="../../attachments/overshootangle.png" alt="overshootangle" />
Therefore the overshoot spec is not met if there are poles in the shaded region.</p>
<h3 id="settling-time">Settling time</h3>
<ul>
<li>The smallest time <span class="math inline">T_s</span> such that <span class="math inline">\forall t \ge T_s,\quad \frac{|G(0)-y(t)|}{|y(t)|} \le 0.02</span>.</li>
<li>An estimate is obtained by looking at the decay rate <span class="math inline">e^{-\zeta \omega_n t}</span>:
<span class="math display">e^{-\zeta \omega_n t} \le 0.02 \Rightarrow t \ge \frac{4}{\zeta \omega_n} \text{ (approx)}</span>
i.e. <span class="math inline">T_s = \frac{4}{\zeta \omega_n}</span></li>
</ul>
<h4 id="e.g.-mass-spring-damper-1">e.g. Mass-spring damper</h4>
<p>Find the condition so that <span class="math inline">T_s \le T_s^{max} = 3</span></p>
<p><span class="math display">\begin{aligned}
G(s) &amp;= \frac{\frac{1}{M}}{s^2 + \frac{b}{M}s + \frac{K_{spring}}{M}}\\
\frac{4}{\zeta \omega_n} &amp;\le 3 = T_s^{max}\\
\Leftrightarrow \zeta\omega_n &amp;\ge \frac{4}{T_s^{max}}\\
\Leftrightarrow \frac{b}{2M} &amp;\ge \frac{4}{3}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/massspringpoles.png" alt="" /><figcaption>massspringpoles</figcaption>
</figure>
<h3 id="time-to-peak">Time-to-peak</h3>
<ul>
<li>Smallest <span class="math inline">T_p \gt 0</span> such that <span class="math inline">||y||_\infty = y(T_p)</span></li>
<li>Derived similar to overshoot: <span class="math inline">T_p = \frac{\pi}{\omega_n \sqrt{1 - \zeta^2}}, \quad 0 \lt \zeta \lt 1</span></li>
<li>So <span class="math inline">T_p</span> only depends on the imaginary part of the poles</li>
</ul>
<h4 id="e.g.-mass-spring-damper-again">e.g. mass-spring damper again</h4>
<p>Spec: <span class="math inline">T_p \le T_p^{max} = 3 \text{ seconds }</span></p>
<p><span class="math display">\begin{aligned}
\omega_n\sqrt{1-\zeta^2} &amp;\le \frac{\pi}{T_p^{max}}\\
\Leftrightarrow \sqrt{\frac{K_{spring}}{M} - \frac{b^2}{4M^2}} &amp;\le \frac{\pi}{3}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/massspringpoles2.png" alt="" /><figcaption>massspringpoles2</figcaption>
</figure>
<h4 id="changes-to-poles">Changes to poles</h4>
<figure>
<img src="../../attachments/polechanges.png" alt="" /><figcaption>polechanges</figcaption>
</figure>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>decrease real part</th>
<th>increase imaginary part</th>
<th>angle of poles to <span class="math inline">\pm \pi</span></th>
<th>increase magnitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\omega_n</span></td>
<td>+</td>
<td>+</td>
<td>no change</td>
<td>+</td>
</tr>
<tr class="even">
<td><span class="math inline">\zeta</span></td>
<td>+</td>
<td>-</td>
<td>+</td>
<td>no change</td>
</tr>
<tr class="odd">
<td>%OS</td>
<td>-</td>
<td>+</td>
<td>-</td>
<td>no change</td>
</tr>
<tr class="even">
<td><span class="math inline">T_s</span></td>
<td>-</td>
<td>no change</td>
<td>-</td>
<td>-</td>
</tr>
<tr class="odd">
<td><span class="math inline">T_p</span></td>
<td>no change</td>
<td>-</td>
<td>+</td>
<td>-</td>
</tr>
</tbody>
</table>
<h1 id="feedback-control-theory">Feedback Control Theory</h1>
<h2 id="closing-the-loop">5.1 Closing the loop</h2>
<h3 id="e.g.-pendulum">e.g. Pendulum</h3>
<figure>
<img src="../../attachments/pendulum2.png" alt="" /><figcaption>pendulum2</figcaption>
</figure>
<p>Design a controller to keep the pendulum in upright position.</p>
<p><span class="math display">\begin{aligned}
\text{Model:}\\
\dot{x_1}&amp;=x_2\\
\dot{x_2}&amp;= \frac{-g}{l}\sin x_1 + \frac{1}{Ml^2}u\\
y&amp;=x_1\\
\\
\text{Equilibrium config } (\bar{x}, \bar{u}) \text{ at which } y=\pi \text{ is: }\\
(\bar{x}, \bar{u}) &amp;= \left(\begin{bmatrix}\pi\\0\end{bmatrix}, 0\right)\\
\\
\text{Linearization:}\\
\dot{\partial x} &amp;= \begin{bmatrix}0&amp;1\\\frac{g}{l}&amp;0\end{bmatrix} \partial x + \begin{bmatrix}0\\\frac{1}{Ml^2}\end{bmatrix}\partial u\\
\partial x &amp;:= x-\bar{x}\\
\partial u &amp;:= u-\bar{u}\\
\partial y &amp;:= y-\bar{y}\\
&amp;= \begin{bmatrix}1 &amp; 0\end{bmatrix}\partial x\\
\\
\text{Transfer function:}\\
U(s) &amp;:= \mathbb{L}\{\partial u\}, Y(s) := \mathbb{L}\{\partial y\}\\
\\
\text{Poles:}\\
s &amp;= \pm \sqrt{\frac{g}{l}}\\
\\
\frac{Y(s)}{U(s)} = \frac{1}{Ml^2} \frac{1}{s^2 - \frac{g}{l}} =: P(s)\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/pendulumblock.png" alt="" /><figcaption>pendulumblock</figcaption>
</figure>
<p>One controller that does the job is <span class="math inline">C(s) = 100 + \frac{s+10}{s+20}</span>, a “lead” controller.</p>
<p>With this choice of controller, the TF from <span class="math inline">R</span> to <span class="math inline">Y</span> is:
<span class="math display">\frac{Y(s)}{R(s)} = \frac{C(s)P(s)}{1 + C(s)P(s)} = \frac{100s+1000}{s^3 + 20s^2 + 99s + 980}</span></p>
<p>Closed-loop poles: <span class="math inline">\{-17.5, -1 \pm 7.3j\}</span></p>
<figure>
<img src="../../attachments/pendulumpoles.png" alt="" /><figcaption>pendulumpoles</figcaption>
</figure>
<p>Closed-loop response is dominated by poles at <span class="math inline">s=-1 \pm 7.3j</span>, making it look like an underdamped second-order system with a lot of overshoot because of the large angle from the x axis.</p>
<p>Input signal: From 0 to 5s, move in the counter-clockwise direction by 1 radian. After 5s, return to the upright position.</p>
<figure>
<img src="../../attachments/pendulumresponse.png" alt="" /><figcaption>pendulumresponse</figcaption>
</figure>
<p>To implement the controller, we have the following (A/D means analogue to digital):</p>
<figure>
<img src="../../attachments/controllerimplementation.png" alt="" /><figcaption>controllerimplementation</figcaption>
</figure>
<p>In this case, using a “bilinear transformation”, we get:</p>
<p><span class="math display">u[k] = \frac{1}{2+20T}\left((20T-2)u[k-1]+100(2+10T)e[k]+100(10T-2)e[k-1]\right)</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">T</span> is the sampling period</li>
<li><span class="math inline">e[k]=r[k]-y[k]</span></li>
</ul>
<h2 id="stability-of-feedback-systems">Stability of feedback systems</h2>
<figure>
<img src="../../attachments/stabilitysystem.png" alt="" /><figcaption>stabilitysystem</figcaption>
</figure>
<p>Systems</p>
<ul>
<li><span class="math inline">C(s)</span>: controller</li>
<li><span class="math inline">P(s)</span>: plant</li>
</ul>
<p>Signals</p>
<ul>
<li><span class="math inline">r(t)</span>: reference</li>
<li><span class="math inline">u(t)</span>: plant input</li>
<li><span class="math inline">d(t)</span>: disturbance</li>
<li><span class="math inline">y(t)</span>: output</li>
<li><span class="math inline">e(t)</span>: tracking error</li>
</ul>
<p>What does it mean for this system to be stable?</p>
<h3 id="internal-stability">Internal stability</h3>
<p>Assume <span class="math inline">P</span> and <span class="math inline">C</span> are rational; <span class="math inline">P</span> is strictly proper; <span class="math inline">C</span> is proper.</p>
<p>Set <span class="math inline">r(t)=d(t)=0</span>. Bring in state-space models for <span class="math inline">C</span> and <span class="math inline">P</span>.</p>
<figure>
<img src="../../attachments/controllerinternalstability.png" alt="" /><figcaption>controllerinternalstability</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
\dot{x_c} &amp;= A_cx_c+B_ce\\
u &amp;= C_cx_c+D_ce\\
\\
\dot{x_p} &amp;= A_p x_p + B_pu\\
y &amp;= C_px_p\\
\end{aligned}</span></p>
<p>We get:
<span class="math display">\underbrace{\begin{bmatrix}\dot{x_p}\\\dot{x_c}\end{bmatrix}}_{x_{cl}} = \underbrace{\begin{bmatrix}A_p-B_pD_cC_p&amp;B_pC_c\\-B_cC_p&amp;A_c\end{bmatrix}}_{A_{cl}}\begin{bmatrix}X_p\\x_c\end{bmatrix}</span></p>
<p>The closed-loop system is <strong>internally stable</strong> if <span class="math inline">\dot{x_{cl}}=A_{cl}x_{cl}</span> is asymptotically stable.</p>
<h4 id="e.g.-4">e.g.</h4>
<p>Given:
<span class="math display">\begin{aligned}
\dot{x_p} &amp;= \begin{bmatrix}0&amp;1\\0&amp;-5\end{bmatrix}x_p + \begin{bmatrix}0\\1\end{bmatrix}u\\
y &amp;= \begin{bmatrix}1&amp;0\end{bmatrix}x_p\\
\dot{x_c} &amp;= -15x_c + e\\
y &amp;= -1000x_c + 100e\\
\end{aligned}</span></p>
<p>Then:
<span class="math display">\begin{aligned}
A_{cl} &amp;= \begin{bmatrix}
  \begin{bmatrix}0&amp;1\\0&amp;-5\end{bmatrix}-\begin{bmatrix}0\\1\end{bmatrix}100\begin{bmatrix}1&amp;0\end{bmatrix} &amp;
  -\begin{bmatrix}0\\1\end{bmatrix} \\
  -\begin{bmatrix}1&amp;0\end{bmatrix} &amp;
  -15
\end{bmatrix}\\
&amp;= \begin{bmatrix}0&amp;1&amp;0\\-100&amp;-5&amp;-1000\\-1&amp;0&amp;-15\end{bmatrix}\\
\\
\det(sI-A_{cl}) &amp;= \det\begin{bmatrix}s&amp;-1&amp;0\\100&amp;s+5&amp;1000\\1&amp;0&amp;s+15\end{bmatrix}\\
&amp;= s(s+5)(s+15)+100(s+5)\\
&amp;= (s+5)(s^2+15s+100)\\
\end{aligned}</span></p>
<p>You can check that all the roots of the determinant (all the eigenvalues) have negative real parts. This implies that <span class="math inline">\dot{x_{cl}}=A_{cl}x_{cl}</span> is asymptotically stable, and therefore the feedback system is internally stable.</p>
<h3 id="input-output-stability">Input-output stability</h3>
<p>Given the same feedback loop as before:
<img src="../../attachments/stabilitysystem.png" alt="stabilitysystem" /></p>
<p>This system has 6 transfer functions from <span class="math inline">(r, d)</span> to <span class="math inline">(e, u, y)</span>. Finding them:</p>
<p><span class="math display">\begin{aligned}
Y &amp;= PU\\
E &amp;= R - PU\\
U &amp;= D+CE\\
\Rightarrow \begin{bmatrix}1&amp;P\\-C&amp;1\end{bmatrix}\begin{bmatrix}E\\U\end{bmatrix}&amp;=\begin{bmatrix}R\\D\end{bmatrix}\\
\begin{bmatrix}E\\U\end{bmatrix} &amp;= \frac{1}{1+PC}\begin{bmatrix}1&amp;-P\\C&amp;1\end{bmatrix}\begin{bmatrix}R\\D\end{bmatrix}\\
\\
\frac{E}{R} &amp;= \frac{1}{1+PC}\\
\frac{E}{D} &amp;= \frac{-P}{1+PC}\\
\frac{U}{R} &amp;= \frac{C}{1+PC}\\
\frac{U}{D} &amp;= \frac{1}{1+PC}\\
\frac{Y}{R} &amp;= \frac{PC}{1+PC}\\
\frac{Y}{D} &amp;= \frac{P}{1+PC}\\
\end{aligned}</span></p>
<p>A feedback system is <strong>input-output stable</strong> if <span class="math inline">(e, u, y)</span> are bounded whenever <span class="math inline">(r, d)</span> are bounded.</p>
<p>Since whenever <span class="math inline">r</span> and <span class="math inline">e</span> are bounded, so is <span class="math inline">y=r-e</span>, we only need to look at the TFs from <span class="math inline">(r,d)</span> to <span class="math inline">(e,u)</span>.</p>
<h4 id="e.g.-5.2.5">e.g. 5.2.5</h4>
<p><span class="math display">P(s)=\frac{1}{(s+1)(s-1)}, \quad C(s)=\frac{s-1}{s+1}</span></p>
<p>The for transfer functions are:
<span class="math display">\begin{aligned}
\begin{bmatrix}E\\U\end{bmatrix} &amp;= \begin{bmatrix}
  \frac{(1+1)^2}{s^2+2s+2} &amp; \frac{s+1}{(s-1)(s^2+2s+2)} \\
  \frac{(s+1)(s-1)}{s^2+2s+2} &amp; \frac{(s+1)^2}{s^2+2s+2}
\end{bmatrix}
\begin{bmatrix}R\\D\end{bmatrix}
\end{aligned}</span>
Three of these TFs are BIBO stable; the one from D to E is not. Therefore the feedback system is not input-output stable.</p>
<p>Observe:
<span class="math display">\frac{Y(s)}{R(s)}=\frac{1}{s^2+2s+2}</span>
This is BIBO stable, so don’t be fooled. The problem is that <span class="math inline">C</span> cancels an <strong>unstable pole</strong> of the plant. Input-output stability is more than just the stability of one transfer function.</p>
<h3 id="characteristic-polynomial">Characteristic polynomial</h3>
<p>Write:
<span class="math display">P(s)=\frac{N_p}{D_p}, \quad C(s)=\frac{N_c}{D_c}</span></p>
<ul>
<li><p><span class="math inline">N_p</span>, <span class="math inline">D_p</span>, <span class="math inline">D_c</span> are polynomials in <span class="math inline">s</span></p></li>
<li><p><span class="math inline">\deg(N_p) \lt \deg(D_p)</span>, <span class="math inline">\deg(N_c) \le \deg(D_c)</span></p></li>
<li><p><span class="math inline">(N_p, D_p)</span> and <span class="math inline">(N_c, D_c)</span> are coprime</p>
<p>The <strong>characteristic polynomial</strong> of the feedback system is:
<span class="math display">\pi(s) := N_p(s)N_c(s) + D_p(s)D_c(s)</span></p></li>
</ul>
<h4 id="e.g.-5.2.7">e.g. 5.2.7</h4>
<p><span class="math display">P(s)=\frac{1}{(s+1)(s-1)}, \quad C(s)=\frac{s-1}{s+1}</span>
<span class="math display">\begin{aligned}
\pi(s)&amp;=(1)(s-1)+(s+1)(s-1)(s+1)\\
&amp;= (s-1)(s^2 + 2s + 2)
\end{aligned}</span></p>
<p>The characteristic polynomial has an unstable root, the one we cancelled.</p>
<p><strong>Theorem 5.2.6.</strong> The feedback system is input-output stable if and only if its characteristic polynomial has no roots with <span class="math inline">\Re(s) \ge 0</span>.</p>
<p>Observe:
<span class="math display">\begin{aligned}
\begin{bmatrix}\frac{1}{1+PC} &amp; \frac{-P}{1_PC} \\ \frac{C}{1+PC} &amp; \frac{1}{1+PC}\end{bmatrix} &amp;= \frac{1}{\pi(s)}\begin{bmatrix}D_pD_c &amp; -N_pD_c \\ D_pN_c &amp; D_pD_c \end{bmatrix}\\
\end{aligned}</span></p>
<p>The plant <span class="math inline">P(s)</span> and the controller <span class="math inline">C(s)</span> have a <strong>pole-zero cancellation</strong> if there exists a complex number <span class="math inline">\lambda \in \mathbb{C}</span> such that <span class="math inline">N_p(\lambda) = D_c(\lambda)=0</span> or <span class="math inline">D_p(\lambda)=N_c(\lambda)=0</span>.</p>
<p>It is an <strong>unstable cancellation</strong> if <span class="math inline">\Re(\lambda) \ge 0</span>.</p>
<p>If there is an unstable pole-zero cancellation, then the feedback system is unstable.
<strong>Proof:</strong> Assume there isi an unstable pole-zero cancellation at <span class="math inline">\lambda \in \mathbb{C}</span> with <span class="math inline">\Re(\lambda) \ge 0</span>.</p>
<p><span class="math display">\begin{aligned}
\pi(\lambda) &amp;= N_p(\lambda)N_c(\lambda) + D_p(\lambda)D_c(\lambda)\\
&amp;= 0 + 0\\
\end{aligned}</span>
So <span class="math inline">\lambda</span> is a root of <span class="math inline">\pi</span>, so by Theorem 5.2.6, the system is unstable.</p>
<h3 id="comparing-internal-and-input-output-stability">Comparing Internal and Input-Output Stability</h3>
<p>It can be shown that the roots of <span class="math inline">\pi</span> are a subset of the eigenvalues of <span class="math inline">A_{\text{closed loop}}</span>. So, internal stability implies input-output stability.</p>
<ul>
<li>usually the two concepts are the same (but not always)</li>
<li>in this course we generally assume they are the same unless asked specifically to check</li>
</ul>
<h3 id="the-routh-hurwitz-criterion">The Routh-Hurwitz Criterion</h3>
<p>Consider an <span class="math inline">n</span>th order polynomial:
<span class="math display">\pi(s) = s^n + a_{n-1}s^{n-1} + ... + a_1s + a_0</span></p>
<p><span class="math inline">\pi(s)</span> is <strong>Hurwitz</strong> if all its roots have <span class="math inline">\Re(s) \lt 0</span>.</p>
<p>The Routh-Hurwitz Criterion is a test to determine if a polynomial is Hurwitz without actually computing the roots. It is a necessary condition for a polynomial to be Hurwitz.</p>
<p>Let <span class="math inline">\{\lambda_1, ..., \lambda_r\}</span> be the real roots of <span class="math inline">\pi</span>.</p>
<p>Let <span class="math inline">\{\mu_1, \bar{\mu_1}, ..., \mu_s, \bar{\mu_s}\}</span> be the complex conjugate roots of <span class="math inline">\pi</span>.</p>
<p><span class="math display">r+2s=n</span></p>
<p>Then, we can write:
<span class="math display">\pi(s) = (s - \lambda_1)...(s - \lambda_r)(s-\mu_1)(s-\bar{\mu_1})...(s-\mu_s)(s-\bar{\mu_s})</span></p>
<p>If <span class="math inline">\pi</span> is Hurwitz, then all the roots have <span class="math inline">\Re(s) \lt 0</span>, so the real roots have to be negative. Then <span class="math inline">-\lambda_i \gt 0</span>.</p>
<p>For the complex conjugate roots:
<span class="math display">\begin{aligned}
(s-\mu_i)(s-\bar{\mu_i}) &amp;= s^2 + (-\mu_i - \bar{\mu_i})s + \mu_i\bar{\mu_i}\\
&amp;= s^2 - 2\Re(\mu_i)s + |\mu_i|^2\\
\end{aligned}</span>
If <span class="math inline">\pi</span> is Hurwitz, then <span class="math inline">-\Re(\mu_i)\gt 0</span> and <span class="math inline">|\mu_i| \ne 0</span>. If we expand <span class="math inline">\pi(s)</span> out again, all the coefficients <span class="math inline">a_i</span> will be <strong>positive</strong>.</p>
<h4 id="e.g.-5.3.1">e.g. 5.3.1</h4>
<p><span class="math display">s^4+3s^3-2s^2+5s+6</span>
We have a coefficient with a negative sign, so we immediately know it is not Hurwitz.</p>
<p><span class="math display">s^3+4s+6</span>
We have a coefficient of 0, and since we need all to be positive, we know it is not Hurwitz.</p>
<p><span class="math display">s^3+5s^2+9s+1</span>
We are not sure whether or not this is Hurwitz.</p>
<h3 id="rouths-algorithm">Routh’s Algorithm</h3>
<p>Input to the algorithm is a polynomial:
<span class="math display">\pi(s) = s^2 + a_{n-1}s^{n-1}+...+a_1s+a_s</span></p>
<p>We create a <strong>Routh Array</strong>:</p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">s^n</span></td>
<td><span class="math inline">1 = r_{0,0}</span></td>
<td><span class="math inline">a_{n-2} = r_{0,1}</span></td>
</tr>
<tr class="even">
<td><span class="math inline">s^{n-1}</span></td>
<td><span class="math inline">a_{n-1} = r_{1,0}</span></td>
<td><span class="math inline">a_{n-3} = r_{1,1}</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">s^{n-2}</span></td>
<td><span class="math inline">r_{2,0}</span></td>
<td><span class="math inline">r_{2,1}</span></td>
</tr>
<tr class="even">
<td><span class="math inline">s^{n-3}</span></td>
<td><span class="math inline">r_{3,0}</span></td>
<td><span class="math inline">r_{3,1}</span></td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td><span class="math inline">s^{1}</span></td>
<td><span class="math inline">r_{n-1,0}</span></td>
<td><span class="math inline">r_{n-1,1}</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">s^{0}</span></td>
<td><span class="math inline">r_{n,0}</span></td>
<td><span class="math inline">r_{n,1}</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\begin{aligned}
r_{2,0} &amp;= \frac{a_{n-1}a_{n-2} - (1)a_{n-3}}{a_{n-1}}\\
r_{2,1} &amp;= \frac{a_{n-1}a_{n-4} - (1)a_{n-3}}{a_{n-1}}\\
r_{2,2} &amp;= \frac{a_{n-1}a_{n-6} - (1)a_{n-3}}{a_{n-1}}\\
&amp;...\\
\\
\end{aligned}</span></p>
<p>The fourth row is computed from the second and third using the same pattern:
<span class="math display">\begin{aligned}
r_{3,0} &amp;= \frac{r_{2,0}r_{1,1} - r_{1,0}r_{2,1}}{r_{2,0}}\\
\end{aligned}</span></p>
<ul>
<li>Continue along each row until you get zeroes</li>
<li>Terminate if we get a zero in the first column</li>
</ul>
<h4 id="routh-hurwitz-criterion">Routh-Hurwitz Criterion</h4>
<ul>
<li><span class="math inline">\pi</span> is Hurwitz if and only if all the elements in the first column have the same sign</li>
<li>If there are no zeroes in the first column, then:
<ul>
<li>The number of sign changes equals the number of bad roots (not in the open left half plane)</li>
<li>There are no roots on the imaginary axis</li>
</ul></li>
</ul>
<p>e.g.
<span class="math inline">\pi(s) = a_2s^2 + a_1s + a_0</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">s^2</span></td>
<td><span class="math inline">a_2</span></td>
<td><span class="math inline">a_0</span></td>
</tr>
<tr class="even">
<td><span class="math inline">s^1</span></td>
<td><span class="math inline">a_1</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">s^0</span></td>
<td><span class="math inline">\frac{a_1a_0-a_2(0)}{a_1} = a_0</span></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\pi</span> is Hurwitz if and only if <span class="math inline">\text{sgn}(a_2) = \text{sgn}(a_1) = \text{sgn}(a_0)</span></p>
<p>e.g.
<span class="math inline">\pi(s) = 2s^4 + s^3 + 3s^2 + 5s + 10</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">s^4</span></td>
<td>2</td>
<td>3</td>
<td>10</td>
</tr>
<tr class="even">
<td><span class="math inline">s^3</span></td>
<td>1</td>
<td>5</td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">s^2</span></td>
<td><span class="math inline">\frac{(1)(3)-(2)(5)}{1}=7</span></td>
<td>10</td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">s^1</span></td>
<td><span class="math inline">\frac{(-7)(5)-(1)(10)}{-7}=\frac{45}{7}</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">s^0</span></td>
<td>10</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>There are two sign changes: <span class="math inline">\{+, +, -, +, +\}</span></p>
<p>Therefore <span class="math inline">\pi</span> has two roots in <span class="math inline">\mathbb{C}</span>.</p>
<h4 id="e.g.-5.3.4">e.g. 5.3.4</h4>
<figure>
<img src="../../attachments/routheg.png" alt="" /><figcaption>routheg</figcaption>
</figure>
<p><span class="math display">P(s) = \frac{1}{s^4+6s^3+11s^2+6s}</span>
<span class="math display">\pi(s) = s^4 + 6s^3 + 11s^2 + 6s + K_p</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">s^4</span></td>
<td>1</td>
<td>11</td>
<td><span class="math inline">K_p</span></td>
</tr>
<tr class="even">
<td><span class="math inline">s^3</span></td>
<td>6</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">s^2</span></td>
<td>10</td>
<td><span class="math inline">K_p</span></td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">s^1</span></td>
<td><span class="math inline">\frac{60-6K_p}{10}</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">s^0</span></td>
<td><span class="math inline">K_p</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>System is IO stable if and only if <span class="math inline">0 \lt K_p \lt 10</span>.</p>
<h2 id="steady-state-performance">Steady-state performance</h2>
<p>Typical specs for control design:
- stability (mandatory)
- transient behaviour (see Chapter 4)
- steady-state (tracking and disturbance rejection)</p>
<h3 id="tracking-reference-signals">Tracking reference signals</h3>
<h4 id="e.g.-5.4.1">e.g. 5.4.1</h4>
<figure>
<img src="../../attachments/eg541.png" alt="" /><figcaption>eg541</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
r(t)&amp;=1(t)\\
C(s)&amp;=\frac{1}{s} \text{ (integrator) }\\
P(s) &amp;= \frac{1}{s+1}\\
\end{aligned}</span></p>
<p>Tracking error <span class="math inline">:= r-y</span></p>
<p><span class="math display">\begin{aligned}
E(s) &amp;= \frac{1}{1+C(s)P(s)}R(s)\\
&amp;= \frac{s(s+1)}{s^2 + s + 1}R(s)\\
\end{aligned}</span></p>
<p>The transfer function is BIBO stable, so we can use Final Value Theorem
<span class="math display">\begin{aligned}
e_{ss} &amp;:= \lim_{t\rightarrow\infty}e(t)\\
&amp;=\lim_{s\rightarrow 0} sE(s)\\
&amp;=\lim_{s\rightarrow 0} s\frac{s(s+1)}{s^2 + s + 1}\frac{1}{s}\\
&amp;= 0\\
\end{aligned}</span></p>
<p>So we get perfect asymptotic step tracking.</p>
<p>Why does it work? The pole in the controller turns into a zero in the numerator of the transfer function. In general, <span class="math inline">C(s)</span> has an <strong>“internal model”</strong> of <span class="math inline">R(s)</span> (an integrator). This puts a zero at <span class="math inline">s=0</span> in the transfer function.</p>
<h4 id="e.g.-5">e.g.</h4>
<p><span class="math display">P(s)=\frac{1}{s+1}, \quad C(s) = \frac{1}{s}, \quad R(s) = \frac{1}{s} \quad (r(t)=1(t))</span></p>
<p>The controller contains a “copy” of <span class="math inline">R</span> in it and <span class="math inline">e(t) \rightarrow 0</span>.</p>
<p>Other interpretations of why this controller gives perfect step tracking:
<strong>Frequency domain</strong>: <span class="math inline">P(s)C(s)</span> has a pole at <span class="math inline">s=0</span>. So, as <span class="math inline">\omega \rightarrow 0</span>:
<span class="math display">\frac{E(j\omega)}{R(j\omega)} = \frac{1}{1 + C(j\omega)P(j\omega)} \rightarrow 0</span></p>
<p>Pole at <span class="math inline">s=0 \Rightarrow</span> infinite gain. Line is <span class="math inline">20\log|P(j\omega)C(j\omega)|</span>
<img src="../../attachments/trackingfreqdomain.png" alt="trackingfreqdomain" />
<strong>Time domain</strong>: If the system is IO stable, then in steady-state, all signals in the loop approach a constant value for constant input.</p>
<figure>
<img src="../../attachments/trackingtime.png" alt="" /><figcaption>trackingtime</figcaption>
</figure>
<p>Let <span class="math inline">v(t)</span> be the output of the integrator.</p>
<p><span class="math display">\begin{aligned}
v(t) &amp;= \int_0^t e(\tau)d\tau\\
\dot{v}&amp;=e\\
\end{aligned}</span></p>
<p>So for <span class="math inline">v</span> to be constant in steady-state, <span class="math inline">e</span> must approach zero.</p>
<p>More generally, if <span class="math inline">C(s)</span> provides internal stability, then FVT can be applied and:
<span class="math display">\begin{aligned}
\lim_{t \rightarrow \infty} e(t) &amp;= \lim_{s \rightarrow 0} sE(s)\\
&amp;= \lim_{s \rightarrow 0} s\frac{1}{1+P(s)C(s)}R(s)\\
&amp;= \lim_{s \rightarrow 0} s\frac{1}{1+P(s)C(s)}\frac{r_0}{s}\\
&amp;= \lim_{s \rightarrow 0} \frac{r_0}{1+P(s)C(s)}\\
\\
e_{ss} = 0 &amp;\Leftrightarrow \lim_{s \rightarrow 0} P(s)C(s) = \infty\\
\end{aligned}</span></p>
<p>Conclusion: Integral control is fundamental for perfect step tracking.</p>
<h3 id="design-strategy">Design strategy</h3>
<p>If <span class="math inline">P(s)</span> doesn’t have a pole at 0, pick <span class="math inline">C(s) = \frac{1}{s} C_1(s)</span>. Design <span class="math inline">C_1(s)</span> to give IO stability.</p>
<h3 id="internal-model-principle">Internal model principle</h3>
<p>Assume IO stability. If <span class="math inline">C(s)P(s)</span> contains an internal model of the unstable part of <span class="math inline">R(s)</span>, then <span class="math inline">e(t) \rightarrow 0</span>.</p>
<p>Say <span class="math inline">R(s) = \frac{N_r(s)}{D_r(s)} = \frac{N_r(s)}{D_r^-(s)D_r^+(s)}</span>. Roots of <span class="math inline">D_r^+(s)</span> have <span class="math inline">\Re(s) \gt 0</span>.</p>
<p>IMP says that if <span class="math inline">C(s)P(s) = \frac{N(s)}{D(s)D_r^+(s)}</span>, then <span class="math inline">e_{ss}=0</span>.</p>
<h4 id="e.g.-5.4.3">e.g. 5.4.3</h4>
<p><span class="math display">P(s)=\frac{1}{s+1}, \quad r(t) = r_0\sin(t)</span></p>
<p><span class="math inline">R(s) = \frac{r_0}{s^2+1}</span>, so <span class="math inline">D_r^-(s)=1</span> and <span class="math inline">D_r^+(s)=s^2+1</span></p>
<p>This suggests the controller <span class="math inline">C(s) = \frac{1}{s^2+1}C_1(s)</span> where <span class="math inline">C_1</span> is chosen to ensure IO stability.</p>
<h3 id="steady-state-disturbance-rejection">Steady-state disturbance rejection</h3>
<figure>
<img src="../../attachments/disturbancerejection.png" alt="" /><figcaption>disturbancerejection</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
Y &amp;= P_2(D+P_1C(-Y))\\
\frac{Y}{D} &amp;= \frac{P_2}{1+P_1P_2C}\\
\end{aligned}</span></p>
<p>Suppose:
<span class="math display">\begin{aligned}
D(s) &amp;= \frac{N_d(s)}{D_d(s)}\\
&amp;= \frac{N_d(s)}{D_d^-(s)D_d^+(s)}\\
\end{aligned}</span></p>
<p>Roots of <span class="math inline">D_d^+(s)</span> have <span class="math inline">\Re(s) \ge 0</span>.</p>
<p>Assume IO stability so FVT applies:
<span class="math display">\begin{aligned}
lim_{t\rightarrow\infty} y(t) &amp;= \lim_{s \rightarrow 0}sY(s)\\
&amp;= \lim_{s \rightarrow 0}s\frac{P_2(s)}{1+P_1P_2C}\frac{N_d}{D_d^-D_d^+}\\
&amp;= \lim_{s \rightarrow 0}s\frac{N_{p_2}D_{p_1}D_c}{D_{p_2}D_{p_1}D_c+N_{p_1}N_{p_2}N_c}\frac{N_d}{D_d^-D_d^+}\\
\\
\mathcal{L}\{y\} &amp;= Y(s)\\
\end{aligned}</span></p>
<p>So we see that to deal simultaneously with input and output disturbances, the <em>controller</em> must contain an internal model of <span class="math inline">D_d^+(s)</span> (can’t rely on the plant.) i.e.,
<span class="math display">C(s)=\frac{1}{D_d^+(s)}C_1(s)</span></p>
<h4 id="e.g.-6">e.g.</h4>
<p><span class="math display">d(t)=1(t), \quad D(s)=\frac{1}{s}, \quad D_d^+(s)=s, \quad C(s)=\frac{1}{s}C_1(s)</span>
<span class="math display">D(t)=\sin(\omega t), \quad D(s)=\frac{\omega}{s^2+\omega^2}, \quad D_d^+(s)=s^2+\omega^2, \quad C(s)=\frac{1}{S^2+\omega^2}C_1(s)</span></p>
<p><span class="math display">D(t)=e^{-t}, \quad D(s)=\frac{1}{s+1}, \quad D_d^+(s)=1</span></p>
<h1 id="root-locus-method">Root-Locus Method</h1>
<h2 id="basic-root-locus-construction">6.1 Basic root-locus construction</h2>
<h3 id="e.g.-6.1.1">e.g. 6.1.1</h3>
<p><span class="math display">C(s)=K_p, \quad P(s) = \frac{1}{s(s+2)}</span>
<span class="math display">\begin{aligned}
\pi(s) &amp;= s^2 + 2s + K_p\\
s &amp;= -1 \pm \sqrt{1-K_p}\\
\end{aligned}</span></p>
<ul>
<li>If <span class="math inline">K_p \le 0</span>, lose IO stability</li>
<li>If <span class="math inline">0 \lt K_p \le 1</span>, we have two roots with negative real part</li>
</ul>
<figure>
<img src="../../attachments/rootlocuseg1.png" alt="" /><figcaption>rootlocuseg1</figcaption>
</figure>
<ul>
<li>This root locus tells us that the system can go unstable with bad choices of <span class="math inline">K_p</span></li>
<li>From the diagram, we can qualitatively see that <span class="math inline">K_p</span> should be such that <span class="math inline">\Im(s)</span> of the poles <span class="math inline">\ne 0</span>, but not too big.</li>
<li>Matlab: use <code>sisotool</code> or <code>rltool</code></li>
</ul>
<h3 id="construction">Construction</h3>
<p><img src="../../attachments/basicrootlocus.png" alt="basicrootlocus" />
<span class="math display">\pi(s) = \underbrace{D_pD_c}_{D(s)} + K\underbrace{N_pN_c}_{N(s)}</span></p>
<p>A root-locus diagram is a drawing of how the roots of <span class="math inline">\pi</span> change as <span class="math inline">K</span> is changed.</p>
<p>Assumptions:</p>
<ul>
<li><span class="math inline">C(s)P(s)</span> proper</li>
<li><span class="math inline">K \ge 0</span></li>
<li><span class="math inline">D(s)</span> and <span class="math inline">N(s)</span> are monic (leading coefficient is 1)</li>
</ul>
<p>Let <span class="math inline">n:=\deg(D(s))</span>, <span class="math inline">m:=\deg(N(s))</span></p>
<p><strong>Rules</strong></p>
<ol type="1">
<li>Roots of <span class="math inline">\pi</span> are symmetric about the real axis</li>
<li>There are <span class="math inline">n</span> “branches” (paths) of the root locus (since <span class="math inline">\deg(\pi)=n</span>)</li>
<li>Roots of <span class="math inline">\pi</span> are a continuous function of <span class="math inline">K</span></li>
<li>When <span class="math inline">K=0</span>, roots of <span class="math inline">\pi</span> are equal to the roots of <span class="math inline">D</span></li>
<li>As <span class="math inline">K \rightarrow +\infty</span>, <span class="math inline">m</span> branches of the root locus approach the roots of <span class="math inline">N(s)</span> (<span class="math inline">\pi(s) = 0 \Leftrightarrow \frac{N(s)}{D(s)}=\frac{-1}{K}</span>)</li>
<li>The remaining <span class="math inline">n-m</span> branches tend towards <span class="math inline">\infty</span>. They do so along asymptotes:
<ul>
<li>Go through the point <span class="math inline">s=\sigma + 0j</span> where <span class="math inline">\sigma = \frac{\sum \text{roots of } D - \sum \text{roots of } N}{n-m}</span> (centroid)</li>
<li>Make angles <span class="math inline">\phi_1, ...,\phi_{n-m}</span> with real axis given by <span class="math inline">\phi_k := \frac{(2k-1)\pi}{n-m}, k \in \{1, ..., n-m\}</span></li>
<li>Asymptote patterns: (fig. 6.4)</li>
<li><img src="../../attachments/rootlocussigmalocations.png" title="fig:" alt="rootlocussigmalocations" /></li>
</ul></li>
<li>(“no-yes-no” rule) A point <span class="math inline">s_0</span> on the real axis is a part of the root locus if and only if <span class="math inline">s_0</span> is to the <strong>left</strong> of an <strong>odd</strong> number of poles/zeroes.
<ul>
<li>It follows from the fact that on the root locus, <span class="math inline">\angle N(s_0) - \angle D(s_0) = \angle \frac{-1}{K} = \pi</span></li>
</ul></li>
<li>(angles of departure/arrival)
<ul>
<li><img src="../../attachments/departurearrival.png" title="fig:" alt="departurearrival" /></li>
<li>To compute, use <span class="math inline">\angle N(s) - \angle D(s) = \pi</span></li>
<li><span class="math inline">\Rightarrow \angle (s-z_1) + \angle (s-z_2) + ... + \angle(s - z_m) - \angle (s-p_1) + ... + \angle (s-p_n) = \pi</span></li>
<li>To compute the angle of departure at pole <span class="math inline">p_i</span>, plug <span class="math inline">s=p_i</span> into the above and solve for <span class="math inline">\angle (s-p_i) =: \theta_{p_i}</span>.</li>
</ul></li>
</ol>
<h2 id="procedure-for-plotting-root-locus">Procedure for plotting root-locus</h2>
<p>Given an <span class="math inline">n</span>th-order polynomial <span class="math inline">\pi(s)=D(s)+KN(s)</span></p>
<ol type="1">
<li>Compute the roots <span class="math inline">\{z_1, ..., z_n\}</span> of <span class="math inline">N(s)</span> and place a circle at each location.</li>
<li>Compute the roots <span class="math inline">\{p_1, ..., p_n\}</span> of <span class="math inline">D(s)</span> and place an X at each location.</li>
<li>Use rule 7 (“no-yes-no”) to fill in the real axis</li>
<li>Compute centroid <span class="math inline">\sigma</span>, label the point <span class="math inline">s=\sigma +j0</span> in <span class="math inline">\mathbb{C}</span></li>
<li>Compute and draw the <span class="math inline">n-m</span> asymptotes</li>
<li>Compute angles using rule 8. Usually only needed for complex conjugate rots and repeated real roots.</li>
<li>Give a reasonable guess of how it looks (symmetric around real axis!)</li>
</ol>
<h3 id="e.g.-6.3.1">e.g. 6.3.1</h3>
<p><span class="math display">P(s)=\frac{1}{s^2+2s+5}, \quad C(s)=K\left(1+\frac{1}{0.25s}\right)</span></p>
<p><span class="math display">\begin{aligned}
\pi(s)&amp;=N_cN_p+D_cD_p\\
&amp;= s(s^2+2s+s)+K(s+4)\\
&amp;=:D(s)+KN(s)\\
\end{aligned}</span></p>
<ol type="1">
<li><span class="math inline">N(s)=s+4 \Rightarrow z_1=-4, m=1</span></li>
<li><span class="math inline">D(s)=s(s^2+2s+s) \Rightarrow n=3, \{p_1, p_2, p_3\}=\{0, -1+2j, -2-2j\}</span></li>
<li>“no-yes-no”</li>
<li><span class="math inline">\sigma = \frac{0+(-1+2j)+(-1-2j)-(-4)}{3-1}=1</span></li>
<li><span class="math inline">n-m=2 \Rightarrow \phi_1=\frac{\pi}{2}, \phi_2=\frac{-\pi}{2}</span></li>
<li>Compute departure angle for <span class="math inline">p_2</span> (no need for <span class="math inline">p_3</span>, we know it from symmetry):</li>
</ol>
<ul>
<li><span class="math inline">\pi(s)=D(s)+kN(s)=0 \Leftrightarrow \frac{N(s)}{D(s)}=\frac{-1}{K}</span></li>
<li><span class="math inline">\angle N(s) - \angle D(s) = \pi</span></li>
<li><span class="math inline">\angle(s+4)-\angle s - \underbrace{\angle(s+1-2j)}_{\theta_{p_2}}-\angle(s+1+2j) = \pi</span></li>
<li><span class="math inline">\theta_{p_2} = \angle (p_2+4) - \angle p_2 - \angle (p_2 + 1 + 2j) - \pi</span></li>
<li><span class="math inline">\theta_{p_2} = \angle(-3+2j)-\angle(-1+2j)-\angle 4j - \pi</span></li>
<li><span class="math inline">\theta_{p_2} = 7.125^\circ</span></li>
</ul>
<figure>
<img src="../../attachments/eg621.png" alt="" /><figcaption>eg621</figcaption>
</figure>
<h3 id="e.g.-6.2.2">e.g. 6.2.2</h3>
<p><span class="math display">\pi(s)=D(s)+KN(s), \quad D(s)=s^3(s+4), \quad N(s)=s+1</span>
<span class="math inline">n=4</span>
<span class="math inline">m=1</span></p>
<p><span class="math inline">\sigma = \frac{-4 - (-1)}{4-1} = -1</span></p>
<figure>
<img src="../../attachments/eg622.png" alt="" /><figcaption>eg622</figcaption>
</figure>
<h3 id="e.g.-cart-pendulum-system">e.g. Cart pendulum system</h3>
<figure>
<img src="../../attachments/rootlocuspendulum.png" alt="" /><figcaption>rootlocuspendulum</figcaption>
</figure>
<p><span class="math display">\frac{Y(s)}{U(s)} = P(s)=\frac{\frac{1}{Ml}}{s^2 - \frac{g}{Ml}(m+M)}</span></p>
<figure>
<img src="../../attachments/pendulumblock.png" alt="" /><figcaption>pendulumblock</figcaption>
</figure>
<h4 id="proportional-controller">6.2.3 Proportional controller</h4>
<p>Try <span class="math inline">C(s)=K_p</span>. We get:
<span class="math display">\begin{aligned}
\pi(s)&amp;=D_pD_c+N_pN_c\\
&amp;=s^2-\frac{g(M+m)}{Ml}+\frac{K_p}{Ml}\\
\\
D(s)&amp;:=s^2-\frac{g}{Ml}(m+M)\\
N(s)&amp;:=1\\
K&amp;:=\frac{K_p}{Ml}\\
\end{aligned}</span></p>
<p>Asymptotes: <span class="math inline">\sigma = 0</span>
<span class="math inline">n-m=2-0=2</span></p>
<figure>
<img src="../../attachments/pendulumproportional.png" alt="" /><figcaption>pendulumproportional</figcaption>
</figure>
<p>Proportional control won’t work.</p>
<p>Matlab: suppose you have a controller <span class="math inline">P(s)C(s)=\frac{8(s+2)}{(s+1)(s+5)(s+10)}</span>. In matlab:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1"></a>z = -<span class="fl">2</span>;</span>
<span id="cb2-2"><a href="#cb2-2"></a>p = [-<span class="fl">1</span> -<span class="fl">5</span> -<span class="fl">10</span>];</span>
<span id="cb2-3"><a href="#cb2-3"></a>k = <span class="fl">8</span>;</span>
<span id="cb2-4"><a href="#cb2-4"></a>L = zpk(z, p, k) <span class="co">% Zeroes, Poles, gain</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>rlocus(L);</span></code></pre></div>
<h4 id="p.d.-control">6.2.4 P.D. Control</h4>
<p><span class="math display">\begin{aligned}
C(s) &amp;= K_p(1+T_ds)\\
&amp;= K_pT_d\left(s+\frac{1}{T_d}\right)\\
\\
\pi(s) &amp;= \underbrace{s^2- \frac{g}{Ml}(M+m)}_{D(s), \quad n=2} + \underbrace{\frac{K_pT_d}{Ml}}_{K}\underbrace{\left(s+\frac{1}{T_d}\right)}_{N(s), \quad m=1}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/pendulumpd.png" alt="" /><figcaption>pendulumpd</figcaption>
</figure>
<h4 id="p.i.-control">6.2.5 P.I. Control</h4>
<p><span class="math display">\begin{aligned}
C(s)&amp;=K_p\left(1+\frac{1}{T_is}\right)\\
&amp;= K_p \frac{s+\frac{1}{T_i}}{s}\\
\\
\pi(s) &amp;= \underbrace{s\left(s^2-\frac{g}{Ml}(m+M)\right)}_{D(s)} + \underbrace{\frac{K_p}{M_l}}_K \underbrace{\left(s+\frac{1}{T_i}\right)}_{N(s)}\\
\\
\sigma &amp;= \frac{1}{2T_i}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/pendulumpi.png" alt="" /><figcaption>pendulumpi</figcaption>
</figure>
<h2 id="non-standard-problems">6.3 Non-standard problems</h2>
<h3 id="non-unity-feedback">Non-unity feedback</h3>
<figure>
<img src="../../attachments/nonunityfeedback.png" alt="" /><figcaption>nonunityfeedback</figcaption>
</figure>
<p>In this case, the characteristic polynomial is:
<span class="math display">\pi(s)=N_pN_cN_h + D_pD_cD_h</span></p>
<p>Identify <span class="math inline">D</span>, <span class="math inline">N</span>, and <span class="math inline">K</span>, and proceed as before.</p>
<h3 id="controller-isnt-a-linear-function-of-the-gain">Controller isn’t a linear function of the gain</h3>
<p>Even if we can’t factor <span class="math inline">K</span> out from <span class="math inline">C(s)</span>, the characteristic polynomial can still be expressed in the form <span class="math inline">\pi(s)=D(s)+KN(s)</span>, but now, <span class="math inline">D \ne D_pD_c</span> and <span class="math inline">N \ne N_pN_c</span></p>
<p>e.g.</p>
<p><span class="math display">\begin{aligned}
P(s)&amp;=\frac{1}{s(s+2)}\\
C(s) &amp;= 10(1+T_ds)\\
\\
\pi(s)=D_pD_c+N_pN_c\\
&amp;= \underbrace{s^2+2s+10}_{D(s)} + \underbrace{10T_d}_K \underbrace{s}_N\\
\\
\text{Observe:}\\
D(s)=s^2+2s+10 \ne D_pD_c\\
N(s)=s \ne N_pN_c\\
\end{aligned}</span></p>
<p>Then proceed as before.</p>
<h3 id="improper-loop-gain">Improper Loop Gain</h3>
<p><span class="math display">\pi(s)=D(s)+KN(s)</span>
Normally, <span class="math inline">\deg(D) \ge \deg(N)</span>. In this case, we have the opposite: <span class="math inline">\deg(D) \lt \deg(N)</span>.</p>
<p><span class="math display">\pi(s) = 0 \Leftrightarrow N(s) + \frac{1}{K}D(s)=0</span></p>
<p>Define:
<span class="math display">\hat{D} := N, \quad \hat{N}:=D, \quad \hat{K}:=\frac{1}{K}</span></p>
<p>Do the usual root-locus using <span class="math inline">\hat{\pi}(s)=\hat{D}(s)+\hat{K}\hat{N}(s)</span>. At the end:</p>
<ol type="1">
<li>Turn each X into an O</li>
<li>Turn each O into an X</li>
<li>Revertse arrows</li>
</ol>
<h4 id="e.g.-6.3.2">e.g. 6.3.2</h4>
<p><span class="math display">\begin{aligned}
P(s)&amp;=\frac{1}{s(s+1)}\\
C(s)&amp;= \frac{s+3}{\tau s+1}\\
\\
\pi(s)&amp;=s(s+1)(\tau s+1)+s+3\\
&amp;= s^2+2s+3+\tau s^2(s+1)\\
\\
\hat{D}(s)&amp;=s^2(s+1)\\
\hat{N}(s)&amp;=s^2+2s+3\\
\hat{K}&amp;=\frac{1}{\tau}\\
\\
\hat{n}&amp;=3, \quad \{0,0,-1\}\\
\hat{m}&amp;=2, \quad \{-1 \pm \sqrt{2}j\}\\
\end{aligned}</span></p>
<figure>
<img src="../../attachments/rootlocusimproperloopgain.png" alt="" /><figcaption>rootlocusimproperloopgain</figcaption>
</figure>
<h1 id="pid-control">PID Control</h1>
<h2 id="classical-pid">7.1 Classical PID</h2>
<p><img src="../../attachments/pidcontroller.png" alt="pidcontroller" />
<span class="math display">\begin{aligned}
C(s) &amp;= \frac{U(s)}{E(s)}\\
&amp;= K_p + \frac{K_i}{s} + K_ds\\
&amp;= \frac{K_ds^2 + K_ps + K_i}{s}\\
\\
\text{Standard form:}\\
&amp;= K_p\left(1 + \frac{1}{T_is}+T_ds\right)\\
\text{Where:}\\
T_i &amp;= \text{integral time constant}\\
T_d &amp;= \text{derivative time constant}\\
\\
u(t)&amp;=K_pe(t) + K_i \int_0^t e(\tau)d\tau + K_d \frac{de}{dt}\\
\end{aligned}</span></p>
<h3 id="refinements-to-the-basic-pid-control">Refinements to the basic PID control</h3>
<ol type="1">
<li>Since the transfer function for PID is improper, the derivative term is approximated using a low-pass filtered version:
<ul>
<li><span class="math inline">C(s) = K_p\left(1+\frac{1}{T_is}+\frac{T_ds}{\tau_ds+1}\right)</span></li>
</ul></li>
<li>Since <span class="math inline">r(t)</span> is often discontinuous, we often avoid differentiating it, since it would lead to control spikes.
<ul>
<li>We feed <span class="math inline">y</span> and <span class="math inline">r</span> in separately instead of just the error so we have two degrees of freedom</li>
<li><img src="../../attachments/twodegreesoffreedom.png" title="fig:" alt="twodegreesoffreedom" /></li>
<li><span class="math inline">U(s)=\frac{K_i}{s}E(s)-\left(K_p + \frac{T_ds}{\tau_ds+1}\right)Y(s)</span></li>
</ul></li>
<li>Anti-windup (deals with actuator constraints), see section 7.4 (won’t be tested on this)</li>
</ol>
<h3 id="what-does-each-term-do">What does each term do?</h3>
<p>Consider <span class="math inline">u(t) = K_pe(t) + \frac{K_p}{T_i} \int_0^t e(\tau)d\tau + K_pT_d \frac{de(t)}{dt}</span>.</p>
<ul>
<li>Proportional part
<ul>
<li>only depends on the <em>current</em> value of <span class="math inline">e(t)</span></li>
<li>high gain usually gives good performance in terms of tracking</li>
<li>if <span class="math inline">K_p</span> is too high, we get instability</li>
</ul></li>
<li>Integral part
<ul>
<li>gives perfect step tracking (see internal model principle discussion earlier)</li>
<li>acts on historic data, accumulated error</li>
</ul></li>
<li>Derivative part
<ul>
<li>penalizes fast changes in the error, smooths out transients. Acts kind of like friction in a physical system</li>
<li>called the “predictive part” of PID
<ul>
<li>e.g. PD controller: <span class="math inline">u(t)=K_p\left(e(t)+T_d\frac{de(t)}{dt}\right)</span></li>
<li><img src="../../attachments/predictivepid.png" title="fig:" alt="predictivepid" /></li>
<li>The <span class="math inline">e(t)+T_d\frac{de(t)}{dt}</span> terms are a prediction of error at <span class="math inline">t+T_d</span> seconds using linear interpolation</li>
</ul></li>
</ul></li>
</ul>
<h2 id="pole-placement">7.3 Pole placement</h2>
<figure>
<img src="../../attachments/standardpid.png" alt="" /><figcaption>standardpid</figcaption>
</figure>
<p>Any controller of the form <span class="math inline">C(s) = \frac{g_2s^2 + g_1s+g_0}{s^2+f_1s}</span> is a PID controller in standard form:
<span class="math display">\begin{aligned}
K_p &amp;= \frac{g_1f_1 - g_0}{f_1^2}\\
T_i &amp;= \frac{g_1f_1 - g_0}{g_0f_1}\\
T_d &amp;= \frac{g_0 - g_1f_1-g_2f_1^2}{f_1(g_1f_1-g_0)}\\
\tau_d &amp;= \frac{1}{f_1}\\
\end{aligned}</span></p>
<p>We assume the plant is:
<span class="math display">P(s) = \frac{b_1s+b_0}{s^2+a_1s+a_0}, \quad b_0 \ne 0</span></p>
<p><span class="math display">\pi(s) = s^4 + (a_1+f_1+b_1g_2)s^3 + (a_0+a_1f_1+b_1g_1+b_0g_2)s^2 + (a_0f_1+b_1g_0+b_0g_1)s+b_0g_0</span></p>
<p>Now we say we want the closed-loop poles to be located at <span class="math inline">\{\lambda_1, \lambda_2, \lambda_3, \lambda_4\} \subset \mathbb{C}^-</span>. These desired pole locations can be picked based on settling time, percent overshoot, etc.</p>
<figure>
<img src="../../attachments/poleplacement.png" alt="" /><figcaption>poleplacement</figcaption>
</figure>
<p>Our desired pole locations <span class="math inline">\lambda_1, ..., \lambda_4</span> generate a desired characteristic polynomial.</p>
<p><span class="math display">\begin{aligned}
\pi_{des}(s) &amp;:= (s-\lambda_1)(s-\lambda_2)(s-\lambda_3)(s-\lambda_4)\\
&amp;=:s^4+\alpha_3s^3+\alpha_2s^2+\alpha_1s+\alpha_0\\
\end{aligned}</span></p>
<p>Equating coefficients between <span class="math inline">\pi</span> and <span class="math inline">\pi_{des}</span>:</p>
<p><span class="math display">\begin{aligned}
\begin{bmatrix}1&amp;b_1&amp;0&amp;0\\a_1&amp;b_0&amp;b_1&amp;0\\a_0&amp;0&amp;b_0&amp;b_1\\0&amp;0&amp;0&amp;b_0\end{bmatrix}
\begin{bmatrix}f_1\\g_2\\g_1\\g_0\end{bmatrix} =
\begin{bmatrix}\alpha_3-a_1\\\alpha_2-a_0\\\alpha_1\\\alpha_0\end{bmatrix}
\end{aligned}</span></p>
<p>Remarks:</p>
<ol type="1">
<li>If <span class="math inline">N_p</span> and <span class="math inline">D_p</span> are coprime, the equation has a unique solution</li>
<li>Can’t allow <span class="math inline">b_0=0</span> in the plant, because if we do, we get an unstable pole-zero cancellation</li>
<li><span class="math inline">\tau_d</span> was treated as a design parameter, not a necessary evil</li>
<li>This shows that if the plant can be completely modelled using a second order transfer function, then PID can achieve almost any control objective</li>
</ol>
<p>a significant limitation of the design technique is that we have no idea where the closed loop zeros end up. Thus, we have little idea of what is happening in the frequency domain. The final system may have low bandwidth, poor sensitivity (CH8 etc). Afters designing <span class="math inline">C(s)</span>, you should plot the Bode plot, Nyquist plot (CH8) of the transfer function from <span class="math inline">R</span> to <span class="math inline">Y</span></p>
<h3 id="e.g.-7.3.1">e.g. 7.3.1</h3>
<p><span class="math display">P(s)=\frac{2}{s^2+3s+2}</span></p>
<p>Specs:</p>
<ul>
<li><span class="math inline">e_{ss}=0</span> if <span class="math inline">r(t)=r_01(t)</span></li>
<li><span class="math inline">y_{ss}=0</span> if <span class="math inline">d(t)=d_01(t)</span></li>
<li><span class="math inline">T_s \le 4</span> seconds</li>
<li>%OS <span class="math inline">\le 0.2</span></li>
</ul>
<figure>
<img src="../../attachments/piddisturbance.png" alt="" /><figcaption>piddisturbance</figcaption>
</figure>
<figure>
<img src="../../attachments/poleplacementexample.png" alt="" /><figcaption>poleplacementexample</figcaption>
</figure>
<p>Pick:
<span class="math display">\begin{aligned}
\lambda_1 &amp;= -3+j\\
\lambda_2 &amp;= -3-j\\
\lambda_3 &amp;= -10\\
\lambda_4 &amp;= -11\\
\\
\pi_{des}(s) &amp;= \underbrace{(s+3-j)(s+3+j)}_\text{dominant poles}\underbrace{(s+10)(s+11)}_\text{fast poles}\\
&amp;= s^4+\underbrace{27}_{\alpha_3}s^3+\underbrace{246}_{\alpha_2}s^2+\underbrace{870}_{\alpha_1}s+\underbrace{1100}_{\alpha_0}\\
\\
\begin{bmatrix}1&amp;0&amp;0&amp;0\\3&amp;2&amp;0&amp;0\\2&amp;0&amp;2&amp;0\\0&amp;0&amp;0&amp;2\end{bmatrix}\begin{bmatrix}f_1\\g_2\\g_1\\g_0\end{bmatrix}&amp;=\begin{bmatrix}27-3\\246-2\\870\\1100\end{bmatrix}\\
(f_1, g_2, g_1, g_0) &amp;= (24, 86, 411, 550)\\
\\
C(s) &amp;= \frac{86x^2+411s+550}{s^2+24s}\\
K_p&amp;=16.17\\
T_i&amp;=0.7056\\
T_d&amp;=0.1799\\
\tau_d&amp;=0.0417\\
\end{aligned}</span></p>
<p>We can also use pole placement to design PID for first order plants with time delays.</p>
<h3 id="padé-approximation">Padé approximation</h3>
<p><span class="math display">P(s) = e^{-sT} \frac{K}{\tau s + 1}</span>
We approximate the irrational term <span class="math inline">e^{-sT}</span> using a Padé approximation:
<span class="math display">e^{-sT} \approx \frac{-s\frac{T}{2} + 1}{s \frac{T}{2} + 1}</span></p>
<p>This is a first order Padé approximation (in matlab: <code>pade</code>). Now, we get:</p>
<p><span class="math display">P(s) \approx \frac{K}{\tau s + 1} \left(\frac{-sT+2}{sT+2}\right)</span></p>
<p>This is a second order system.</p>
<h2 id="when-can-pid-be-used">When can PID be used?</h2>
<ul>
<li>When <span class="math inline">P(s)</span> is approximately second order, we can use PID to place the closed loop poles anywhere in <span class="math inline">\mathbb{C}</span></li>
<li>Also gives step tracking and step disturbance rejection</li>
</ul>
<h3 id="e.g.-7">e.g.</h3>
<p><span class="math display">\begin{aligned}
P(s)&amp;=\frac{s+3}{(s^2+2s+2)(s+10)(s+15)}\\
&amp;\approx \frac{1}{(10)(15)} \cdot \frac{s+3}{s^2+3s+2}
\end{aligned}</span>
(See section 4.5)</p>
<figure>
<img src="../../attachments/pidhighorder.png" alt="" /><figcaption>pidhighorder</figcaption>
</figure>
<p>We don’t really care about the poles to the far left. If <span class="math inline">P(s) \not\approx</span> second order, then there are advantages to using more complicated controllers.</p>
<h1 id="frequency-domain-methods-for-stability-analysis">Frequency Domain Methods for Stability Analysis</h1>
<h2 id="cauchys-principle-of-the-argument">8.1 Cauchy’s Principle of the Argument</h2>
<p>Consider a closed curve in the <span class="math inline">s</span>-plane with no self-intersections and with negative (clockwise) orientation.</p>
<figure>
<img src="../../attachments/cauchycurve.png" alt="" /><figcaption>cauchycurve</figcaption>
</figure>
<p>Now let <span class="math inline">G(s) \in \mathbb{R}(s)</span>. For each <span class="math inline">s \in \mathbb{C}</span>, <span class="math inline">G(s)</span> is another complex number, so <span class="math inline">G: \mathbb{C} \rightarrow \mathbb{C}</span></p>
<p>If <span class="math inline">\Gamma_s</span> doesn’t pass through any poles of <span class="math inline">G</span>, then as <span class="math inline">s</span> makes a circuit around <span class="math inline">\Gamma_s</span>, <span class="math inline">G(s)</span> traces out a different closed curve that we’ll call <span class="math inline">\Gamma_G</span>.</p>
<h3 id="e.g.-8.1.1">e.g. 8.1.1</h3>
<p><span class="math display">G(s) = s-1</span>
<img src="../../attachments/eg811.png" alt="eg811" /></p>
<p>Since <span class="math inline">\Gamma_s</span> encircles a zero of <span class="math inline">G</span>, the angle of <span class="math inline">G</span> will change by <span class="math inline">-2\pi</span> as <span class="math inline">s</span> makes a circuit around <span class="math inline">\Gamma_s</span>.</p>
<h3 id="e.g.-8.1.2">e.g. 8.1.2</h3>
<p><span class="math display">G(s) = s-1</span></p>
<figure>
<img src="../../attachments/eg812.png" alt="" /><figcaption>eg812</figcaption>
</figure>
<p>Now the net change in <span class="math inline">\angle G(s)= \angle(s-1)</span> as <span class="math inline">s</span> moves around <span class="math inline">\Gamma_s</span> is zero. This means that <span class="math inline">\Gamma_G</span> does not encircle the origin.</p>
<h3 id="e.g.-8.1.3">e.g. 8.1.3</h3>
<p><span class="math display">G(s) = \frac{1}{s-1}</span></p>
<figure>
<img src="../../attachments/eg813.png" alt="" /><figcaption>eg813</figcaption>
</figure>
<p><span class="math inline">\angle(s-a) = -\angle G</span> because the pole is in the denominator.</p>
<p>Now, <span class="math inline">\angle (s-1)</span> changes by <span class="math inline">-(-2\pi)=2\pi</span> as the point makes a circuit aorund <span class="math inline">\Gamma_s</span>. Therefore, <span class="math inline">\Gamma_G</span> must have a net angular change of <span class="math inline">2\pi</span> as <span class="math inline">s</span> moves around <span class="math inline">\Gamma_s</span>. <span class="math inline">\Gamma_G</span> must encircle the origin once.</p>
<h3 id="theorem">Theorem</h3>
<p>Suppose <span class="math inline">G(s) \in \mathbb{R}(s)</span> has no poles or zeroes on <span class="math inline">\Gamma_s</span>, but <span class="math inline">\Gamma_s</span> encircles <span class="math inline">n</span> poles of <span class="math inline">G</span> and <span class="math inline">m</span> zeroes of <span class="math inline">G</span>. Then, <span class="math inline">\Gamma_g</span> has <span class="math inline">n-m</span> counter-clockwise encirclements of the origin.</p>
<h4 id="proof">Proof</h4>
<p>Write <span class="math inline">G</span> like so:
<span class="math display">G(s) = K \frac{\prod_i (s-z_i)}{\prod_i (s - p_i)}</span>
<span class="math inline">K</span> is a real gain, <span class="math inline">z_i</span> are zeroes, and <span class="math inline">p_i</span> are poles. Then, for each <span class="math inline">s</span> on <span class="math inline">\Gamma_s</span>:
<span class="math display">\angle G(s) = \angle K + \sum \angle(s-z_i) - \sum \angle (s-p_i)</span></p>
<p>If the zero <span class="math inline">z_i</span> is enclosed by <span class="math inline">\Gamma_s</span>, the net change in the term <span class="math inline">\angle(s-z_i)</span> after one circuit around <span class="math inline">\Gamma_s</span> is <span class="math inline">-2\pi</span>. If <span class="math inline">z_i</span> isn’t enclosed, the net change is zero.</p>
<p>So, the net change in <span class="math inline">\angle G</span> is <span class="math inline">m(-2\pi) - n(-2\pi) = (n-m)2\pi</span>.</p>
<p><span class="math inline">\Gamma_G</span> must encircle the origin <span class="math inline">n-m</span> times in the counterclockwise direction.</p>
<figure>
<img src="../../attachments/cachyeg.png" alt="" /><figcaption>cachyeg</figcaption>
</figure>
<h2 id="nyquist-contour">Nyquist Contour</h2>
<p>Take <span class="math inline">\Gamma_s</span> to encircle the whole right-half plane</p>
<figure>
<img src="../../attachments/nyquist.png" alt="" /><figcaption>nyquist</figcaption>
</figure>
<p>For this choice of <span class="math inline">\Gamma_S</span>, the corresponding curve <span class="math inline">\Gamma_G</span> is called the <strong>Nyquist plot</strong> of <span class="math inline">G</span>. If <span class="math inline">G</span> has no poles or zeroes <strong>on</strong> <span class="math inline">\Gamma_s</span>, then by the principle of the argument, the Nyquist plot will encircle the origin <span class="math inline">n-m</span> times in counterclockwise direction.</p>
<p><span class="math inline">n</span> is the number of poles of <span class="math inline">G</span> with <span class="math inline">\Re(s) \gt 0</span>, <span class="math inline">m</span> is the number of zeroes of <span class="math inline">G</span> with <span class="math inline">\Re(s) \gt 0</span>.</p>
<p>If <span class="math inline">G</span> has poles on <span class="math inline">j\mathbb{R}</span>, we’ll indent around them.</p>
<figure>
<img src="../../attachments/nyquistndent.png" alt="" /><figcaption>nyquistndent</figcaption>
</figure>
<h2 id="nyquist-stability-criterion">Nyquist stability criterion</h2>
<figure>
<img src="../../attachments/nyquiststabilitysystem.png" alt="" /><figcaption>nyquiststabilitysystem</figcaption>
</figure>
<p>Assuming <span class="math inline">C,P</span> are rational:
1. <span class="math inline">P,C</span> are proper, <span class="math inline">CP</span> strictly proper
2. No unstable pole-zero cancellations
3. <span class="math inline">K \ne 0</span></p>
<p>Key idea: if the system is IO stable, then the poles of <span class="math inline">\frac{Y(s)}{R(s)} = \frac{KC(s)P(s)}{1+KC(s)P(s)}</span> must all be in <span class="math inline">\mathbb{C}^-</span>. So, we’ll work with the transfer function <span class="math inline">G(s)=1+KC(s)P(s)</span>.</p>
<h3 id="theorem-1">Theorem</h3>
<p>Let <span class="math inline">n</span> denote the number of poles of <span class="math inline">C(s)P(s)</span> in <span class="math inline">\mathbb{C}^+</span>. Construct the Nyquist plot of <span class="math inline">C(s)P(s)</span> indenting to the right around any poles on the imaginary axis. The feedback system is IO stable if and only if the Nyquist plot doesn’t pass through <span class="math inline">\frac{-1}{K}</span> and encircles <span class="math inline">\frac{-1}{K}</span> exactly <span class="math inline">n</span> times counterclockwise.</p>
<h3 id="proof-1">Proof</h3>
<p><span class="math display">\frac{Y(s)}{R(s)} = \frac{KC(s)P(s)}{G(s)}</span>
Since we’ve assumed no unstable pole-zero cancellations, IO stability is equivalent to <span class="math inline">G(s)</span> having no zeroes with <span class="math inline">\Re(s) \ge 0</span>. (See Theorem 5.2.10.)</p>
<p>I.O. stability <span class="math inline">\Leftrightarrow \frac{KC(s)P(s)}{G(s)}</span> has no poles with <span class="math inline">\Re(s) \ge 0 \Leftrightarrow G(s)</span> has no <strong>zeroes</strong> with <span class="math inline">\Re(s) \ge 0</span>.</p>
<p>Since <span class="math inline">G(s)=1+K\frac{N_c(s)}{D_c(s)} \frac{N_p(s)}{D_p(s)} = \frac{D_cD_p+KN_cN_p}{D_cD_p}</span>, so <span class="math inline">G</span> has the same poles as <span class="math inline">CP</span>. Therefore, <span class="math inline">G</span> has <span class="math inline">n</span> poles with <span class="math inline">\Re(s) \gt 0</span>.</p>
<p>Since <span class="math inline">\Gamma_s</span> indents around poles on <span class="math inline">j\mathbb{R}</span> and since <span class="math inline">G</span> is proper, <span class="math inline">\Gamma_s</span> doesn’t pass through any poles of <span class="math inline">G</span>. By the principle of the argument, <span class="math inline">\Gamma_G</span> will encircle the origin <span class="math inline">n-m</span> times in the counterclockwise direction.</p>
<p>Since we need <strong>no</strong> zeroes with <span class="math inline">\Re(s) \gt 0</span>, we need <span class="math inline">m=0</span> for stability. Since <span class="math inline">C(s)P(s) = \frac{1}{K}G(s) - \frac{1}{K}</span>, the Nyquist plot of <span class="math inline">CP</span> is going to be the Nyquist plot of <span class="math inline">G</span> scaled (possibly by <span class="math inline">K</span>) and then shifted to the left by <span class="math inline">\frac{-1}{K}</span>.</p>
<p>Conclusion: IO stability exists if and only if the Nyquist plot of <span class="math inline">CP</span> encircles <span class="math inline">\frac{-1}{K}</span> <span class="math inline">n</span> times in the counterclockwise direction.</p>
<h3 id="remarks">Remarks</h3>
<figure>
<img src="../../attachments/nyquistremarks.png" alt="" /><figcaption>nyquistremarks</figcaption>
</figure>
<p>Since <span class="math inline">C(s)P(s)</span> is rational, we have:</p>
<ul>
<li><span class="math inline">|C(j\omega)P(j\omega)| = |C(-j\omega)P(-j\omega)|</span></li>
<li><span class="math inline">\angle C(j\omega)P(j\omega) = -\angle C(-j\omega)P(-j\omega)</span></li>
<li>So the image of <span class="math inline">\Gamma_s</span> along the negative imaginary axis is a reflection about the real axis of the positive imaginary axis</li>
<li>We see that a Nyquist plot is (aside from indentations) a polar plot of <span class="math inline">C(s)P(s)</span>. It’s a plot of the curve <span class="math inline">\omega \rightarrow C(j\omega)P(j\omega)</span> as <span class="math inline">\omega</span> goes from 0 to <span class="math inline">\infty</span></li>
<li>The Bode plot of <span class="math inline">C(s)P(s)</span> is just <span class="math inline">20\log|C(j\omega)P(j\omega)|</span> and <span class="math inline">\angle C(j\omega)P(j\omega)</span> versus <span class="math inline">\log\omega</span></li>
</ul>
<h3 id="procedure-for-applying-the-nyquist-criterion">Procedure for applying the Nyquist criterion</h3>
<p><strong>Expect a question on the final asking to apply this</strong></p>
<ol type="1">
<li>Pick <span class="math inline">\Gamma_s</span> as the Nyquist contour, indenting to the right if necessary</li>
<li>Draw the image of <span class="math inline">\Gamma_s</span> under the map <span class="math inline">C(s)P(s)</span></li>
<li>Observe <span class="math inline">N</span>, the number of counterclockwise encirclements of <span class="math inline">\frac{-1}{K}</span> made by the Nyquist plot</li>
<li>Apply the Principle of the Argument:</li>
</ol>
<ul>
<li><span class="math inline">N = n-m = \text{open loop poles in } \mathbb{C}^+ - \text{closed loop poles in } \mathbb{C}^+</span></li>
<li><span class="math inline">n</span> is known, <span class="math inline">m</span> is unknown</li>
</ul>
<ol start="5" type="1">
<li>We have input-output stability if and only if <span class="math inline">N = n</span></li>
</ol>
<h4 id="e.g.-8">e.g.</h4>
<p><span class="math display">C(s)P(s)=\frac{1}{s+10}</span></p>
<figure>
<img src="../../attachments/simplenyquisteg.png" alt="" /><figcaption>simplenyquisteg</figcaption>
</figure>
<ul>
<li>On segment A, we have <span class="math inline">s=j\omega, \omega \in [0, \infty)</span>
<ul>
<li><span class="math inline">C(j\omega)P(j\omega)=\frac{1}{j\omega+10}=\frac{10-j\omega}{\omega^2+10^2}=\frac{10}{\omega^2+10}-\frac{j\omega}{\omega^2+10}</span></li>
<li>Start by finding the point that 0 translates to, and seeing what direction it goes when you increase <span class="math inline">\omega</span></li>
<li>Figure out where it crosses the imaginary axis, if at all</li>
</ul></li>
<li>Segment B: <span class="math inline">|s| = \infty</span>, so <span class="math inline">C(s)P(s) = 0</span></li>
<li>Segment C is just a reflection of segment A</li>
<li>Set <span class="math inline">K=1</span> (for now) and observe the number <span class="math inline">N</span> of counterclockwise encirclements of <span class="math inline">\frac{-1}{K}</span> (<span class="math inline">N = 0</span>)</li>
<li><span class="math inline">N=n-m</span>, where in this case <span class="math inline">N=0, n=0</span></li>
<li>Since <span class="math inline">N=n</span>, we have closed loop stability</li>
</ul>
<p>We can also test for other values of <span class="math inline">K</span>:</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\frac{-1}{K} \in (-\infty, 0)</span></th>
<th><span class="math inline">\frac{-1}{K} \in [0, 0.1]</span></th>
<th><span class="math inline">\frac{-1}{K} \gt 0.1</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">N</span></td>
<td>0</td>
<td>-1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>This implies it is stable for <span class="math inline">K \gt -10</span>.</p>
<h4 id="e.g.-comparing-nyquist-to-bode">e.g. comparing Nyquist to Bode</h4>
<p><span class="math display">C(s)P(s) = \frac{1}{s+10}</span></p>
<figure>
<img src="../../attachments/nyquistbodecomparison.png" alt="" /><figcaption>nyquistbodecomparison</figcaption>
</figure>
<ul>
<li>From Bode, when <span class="math inline">\omega \ll 1</span>, <span class="math inline">20\log|CP| \approx -20</span>, i.e. <span class="math inline">|CP| \approx 0.1</span>
<ul>
<li>This is consistent with the Nyquist plot</li>
</ul></li>
<li>When <span class="math inline">\omega \ll 1</span>, <span class="math inline">\angle CP \approx 0^\circ</span>. Also consistent with Nyquist, which starts along the positive real axis.</li>
<li>As <span class="math inline">\omega \rightarrow \infty</span>, <span class="math inline">20\log|CP| \rightarrow -\infty</span>, so <span class="math inline">|CP| \rightarrow 0</span>. This is consistent</li>
<li>From Bode, <span class="math inline">\angle CP</span> is always between <span class="math inline">-90^\circ</span> and <span class="math inline">0^\circ</span>, which is consistent with the fact that Nyquist plot is always in quadrant 4.</li>
</ul>
<h4 id="e.g.-8.3.2">e.g. 8.3.2</h4>
<p><span class="math display">C(s)P(s) = \frac{s+1}{s(s-1)}</span>
<img src="../../attachments/eg832.png" alt="eg832" /></p>
<p>Segment A:</p>
<ul>
<li><span class="math inline">s=j\omega</span>, <span class="math inline">\omega \in [\epsilon, \infty)</span>, <span class="math inline">0\lt\epsilon\lt 1</span>.</li>
<li><span class="math inline">C(j\omega)P(j\omega) = \frac{j\omega+1}{j\omega(j\omega-1)}=\frac{j-\omega}{\omega(1-j\omega)}=\frac{(j-\omega)(1+j\omega)}{\omega(1+\omega^2)}=\frac{-2}{1+\omega^2}+j\frac{1-\omega^2}{\omega(1+\omega^2)}</span></li>
<li>When <span class="math inline">s = j\epsilon</span>, <span class="math inline">C(j\epsilon)P(j\epsilon) \approx -2 \underbrace{+}_\text{key!} j\infty</span></li>
<li>When <span class="math inline">\omega=1</span> (<span class="math inline">s=j</span>), <span class="math inline">C(j)P(j)=-1+0j</span></li>
<li>For all <span class="math inline">\omega \gt 1</span>, <span class="math inline">\Re(CP) \lt 0</span> and <span class="math inline">\Im(CP) \lt 0</span></li>
</ul>
<p>Segment B:</p>
<ul>
<li><span class="math inline">|s|=\infty</span>, so <span class="math inline">|PC|=0</span></li>
</ul>
<p>Segment C:</p>
<ul>
<li>Reflection of segment <span class="math inline">A</span> about the real axis</li>
</ul>
<p>Segment D:</p>
<ul>
<li><span class="math inline">s=\epsilon e^{j\theta}</span>, <span class="math inline">\theta \in [-\frac{\pi}{2}, \frac{\pi}{2}]</span></li>
<li>It’s clear that <span class="math inline">|PC|=\infty</span> along segment D.</li>
<li>We want to know if it moves clockwise or counterclockwise as <span class="math inline">\theta</span> goes from <span class="math inline">-\frac{\pi}{2}</span> to <span class="math inline">\frac{\pi}{2}</span></li>
<li><span class="math inline">C(\epsilon e^{j\theta})P(\epsilon e^{j\theta}) = \frac{\epsilon e^{j\theta}+1}{\epsilon e^{j\theta}(\epsilon e^{j\theta}-1)} \approx \frac{1}{\epsilon e^{j\theta}(-1)} = \frac{-1}{\epsilon e^{j\theta}} = \frac{-\epsilon e^{-j\theta}}{\epsilon} = \frac{e^{j\pi} e^{-j\theta}}{\epsilon}=\frac{e^{j(\pi-\theta)}}{\epsilon}</span></li>
</ul>
<p>Observe the number of counterclockwise encirclements of <span class="math inline">\frac{-1}{K}</span>:</p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">-\infty \lt \frac{-1}{K} \lt -1</span></th>
<th><span class="math inline">-1 \lt \frac{-1}{K} \lt 0</span></th>
<th><span class="math inline">0 \lt \frac{-1}{K} \lt \infty</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">N</span></td>
<td>-1</td>
<td>+1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Since we have <span class="math inline">n=1</span>, we need <span class="math inline">N=1</span> for input-output stability. Therefore, <span class="math inline">K \gt 1</span>.</p>
<h2 id="stability-margins-revisited">Stability margins, revisited</h2>
<p>If a system is stable, how stable?</p>
<h3 id="phase-margin">Phase margin</h3>
<p>Nominal model: <span class="math inline">\phi=0</span>, input-output stability</p>
<p>How much phase change <span class="math inline">\phi</span> can I tolerate before losing IO stability? Recall that <span class="math inline">|e^{j\phi}|=1</span>, <span class="math inline">\angle e^{j\phi}=\phi</span></p>
<h3 id="e.g.-8.4.1">e.g. 8.4.1</h3>
<p><span class="math display">L(s) = \frac{1}{(s+1)^2}</span></p>
<p><span class="math inline">n=0</span>, so we need zero counterclockwise encirclements of -1 to get IO stability.</p>
<figure>
<img src="../../attachments/eg841.png" alt="" /><figcaption>eg841</figcaption>
</figure>
<ul>
<li>If we rotate the Nyquist plot by <span class="math inline">-\frac{\pi}{2}</span>, we get <span class="math inline">N=1</span> and lose IO stability.</li>
<li>Therefore the phase margin is around 90 degrees</li>
</ul>
<figure>
<img src="../../attachments/eg841bode.png" alt="" /><figcaption>eg841bode</figcaption>
</figure>
<h3 id="gain-margin">Gain Margin</h3>
<p>Nominal design: <span class="math inline">K=1</span>, IO stable. How much gain can we change <span class="math inline">K</span> by before we lose stability?</p>
<h3 id="e.g.-8.4.3">e.g. 8.4.3</h3>
<p><span class="math display"> L(s)=\frac{2}{(s+1)^2\left(\frac{s}{10}+1\right)}</span></p>
<p><span class="math inline">n=0</span> (no open-loop unstable poles), so we need <span class="math inline">N=0</span> counterclockwise encirclements of -1 for IO stability.</p>
<figure>
<img src="../../attachments/eg843.png" alt="" /><figcaption>eg843</figcaption>
</figure>
<p>From the Nyquist criterion, the nominal model is IO stable. The system remains stable so long as <span class="math inline">\frac{-1}{K} \lt \frac{-1}{12.1}</span>. This means we can increase <span class="math inline">K</span> up to 12.1 before losing stability. This value of <span class="math inline">K</span> is called the gain margin.</p>
<figure>
<img src="../../attachments/eg843bode.png" alt="" /><figcaption>eg843bode</figcaption>
</figure>
<h3 id="stability-margin">Stability Margin</h3>
<p>Phase margin is related to the distance on the Nyquist plot from to -1, measured as a rotation along the unit circle.</p>
<p>Gain margin is the distance on the Nyquist plot to -1 along the real axis.</p>
<p>More generally, we’ll want to use the Euclidean <strong>distance</strong> from the Nyquist plot to -1 as a measure of stability.</p>
<h3 id="e.g.-8.4.5">e.g. 8.4.5</h3>
<p><span class="math display">L(s) = \frac{0.38(s^2+0.1s+0.55)}{s(s+1)(s^2+0.06s+0.5)}</span></p>
<p><span class="math inline">n=0</span> so we need <span class="math inline">N=0</span> counterclockwise encirclements of -1.</p>
<figure>
<img src="../../attachments/eg845.png" alt="" /><figcaption>eg845</figcaption>
</figure>
<ul>
<li>good phase margin (<span class="math inline">\approx 70^\circ</span>)</li>
<li>infinite gain margin (<span class="math inline">K_{gm}=\infty</span>)</li>
<li>based on the above, we would conclude that the design is robust</li>
<li>from the Nyquist plot we see that we’re actually pretty close to encircling -1.</li>
</ul>
<p>Consider for a moment our normal feedback system with no disturbances. The transfer function from <span class="math inline">r</span> to <span class="math inline">e</span>:
<span class="math display">\frac{E(s)}{R(s)} = \frac{1}{1+P(s)C(s)} =: S(s)</span></p>
<p>Assume IO stability. Then the distance from <span class="math inline">L=CP</span> to -1 is:
<span class="math display">\begin{aligned}
\min_\omega \left|-1-L(j\omega)\right| &amp;= \min_\omega \left|-1-CP\right|\\
&amp;= \left(\max_\omega \left|\frac{1}{1+CP}\right|\right)^{-1}\\
&amp;= \left(\max_\omega \left|S(j\omega)\right|\right)^{-1}\\
\end{aligned}</span></p>
<p>So, the distance from the Nyquist plot to -1 is the reciprocal of the peak magnitude of the Bode plot of <span class="math inline">S</span>. We’ll call this <span class="math inline">S_m</span>, for <strong>stability margin</strong>.</p>
<h1 id="intro-to-control-design-in-the-frequency-domain">Intro to Control Design in the Frequency Domain</h1>
<ul>
<li>This chapter is about “classical” Frequency domain design</li>
<li>Specs will be given in terms of <strong>bandwidth</strong> and <strong>stability margins</strong></li>
<li>Our real interest is in how the system behaves in the time domain, so we will use the duality between these domains</li>
<li>We’ll take specs like %OS, <span class="math inline">T_s</span>, steady-state tracking error and convert them to the frequency domain</li>
</ul>
<h2 id="intro-to-stability-margins">Intro to stability margins</h2>
<p>If a system is stable, how stable is it? This depends on how much error/uncertainty there is in the plant model. Stability margins help answer the question of how much inaccuracy the system can handle. Best understoodusing <strong>Nyquist plots</strong>, but Bode plots work too</p>
<h3 id="gain-margin-1">Gain margin</h3>
<figure>
<img src="../../attachments/stabilitymargin.png" alt="" /><figcaption>stabilitymargin</figcaption>
</figure>
<ul>
<li>Think of <span class="math inline">K=1</span> as our <strong>nominal design</strong></li>
<li>Our <strong>gain margin</strong> <span class="math inline">K_{gm} = \max\left\{\bar{K} \gt 1: \text{ closed-loop stability for } K \in [1, \bar{K})\right\}</span></li>
</ul>
<h3 id="phase-margin-1">Phase margin</h3>
<figure>
<img src="../../attachments/phasemargin.png" alt="" /><figcaption>phasemargin</figcaption>
</figure>
<ul>
<li><p>Think of <span class="math inline">\phi=0</span> as out <strong>nominal design</strong></p></li>
<li><p>Our <strong>phase margin</strong> <span class="math inline">\Phi_{pm} = \max\left\{\bar{\phi} \gt 0: \text{ closed-loop stability for } \phi \in [1, \bar{\phi})\right\}</span></p></li>
<li><p>Large <span class="math inline">K_{gm}, \phi_{pm}</span> not only ensure robustness, but also good transient behaviour. A system with small <span class="math inline">K_{gm}, \Phi_{pm}</span> is nearly unstable which could mean slow response and oscillatory behaviour.</p></li>
</ul>
<h3 id="obtaining-gain-and-phase-margins">Obtaining gain and phase margins</h3>
<figure>
<img src="../../attachments/obtainphase.png" alt="" /><figcaption>obtainphase</figcaption>
</figure>
<p>Let <span class="math inline">L(s) := C(s)P(s)H(s)</span>. Draw the Bode plot of <span class="math inline">L(j\omega)</span>.</p>
<figure>
<img src="../../attachments/stabilitymarginbode.png" alt="" /><figcaption>stabilitymarginbode</figcaption>
</figure>
<ul>
<li><span class="math inline">\omega_{gc}</span> is the gain crossover frequency
<ul>
<li>frequency at which <span class="math inline">L(j\omega_{gc})=1</span></li>
<li>frequency at which we measure <span class="math inline">\Phi_{pm}</span></li>
</ul></li>
<li><span class="math inline">\omega_{pc}</span> is the phase crossover frequency
<ul>
<li>frequency at which <span class="math inline">\angle L(j\omega_{pc})=\pi</span></li>
<li>frequency at which we measure <span class="math inline">K_{gm}</span></li>
</ul></li>
</ul>
<p>Matlab:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1"></a>[K_gm, Phi_pm, omega_pc, omega_gc] = margin(sys);</span></code></pre></div>
<h2 id="performance-specifications">Performance Specifications</h2>
<p>We focus on:</p>
<ol type="1">
<li>input-output stability</li>
<li>steady-state tracking error</li>
<li>%OS (converted into a <span class="math inline">\Phi_{pm}</span> spec)</li>
<li>Closed-loop bandwidth</li>
</ol>
<h3 id="relationship-between-crossover-frequencies-and-bandwidth">Relationship between crossover frequencies and bandwidth</h3>
<p><span class="math display">\frac{Y(s)}{R(s)} = \frac{C(s)P(s)}{1+C(s)P(s)} = G(s)</span>
<img src="../../attachments/bwbode.png" alt="bwbode" /></p>
<p>Define the loop transfer function:
<span class="math display">L(s) = C(s)P(s)</span>
We can see the open-loop gain crossover frequency:
<img src="../../attachments/openloopgaincrossover.png" alt="openloopgaincrossover" /></p>
<p>“Normally,” <span class="math inline">\omega_{gc} \lt \omega_{bw} \lt \omega_{pc}</span>. For design purposes, we’ll use a rule of thumb:
<span class="math display">\omega_{gc} \approx \omega_{bw}</span></p>
<h3 id="relationship-between-damping-ratio-and-phase-margin">Relationship between damping ratio and phase margin</h3>
<p>Damping ratio: <span class="math inline">\zeta</span>
Phase margin: <span class="math inline">\Phi_{pm}</span></p>
<p>This relationship can be found in closed form for second-order systems.</p>
<figure>
<img src="../../attachments/dampingratiophase.png" alt="" /><figcaption>dampingratiophase</figcaption>
</figure>
<p><span class="math display">\frac{Y(s)}{R(s)} = \frac{\omega_n^2}{s^2+2\zeta\omega_ns + \omega_n^2}</span></p>
<p>A messy calculation gives:
<span class="math display">\Phi_{pm}=\tan^{-1}\left(2\zeta\left((1+4\zeta^4)^{\frac{1}{2}}-2\zeta^2\right)^{\frac{-1}{2}}\right)</span></p>
<figure>
<img src="../../attachments/phasemargingraph.png" alt="" /><figcaption>phasemargingraph</figcaption>
</figure>
<h2 id="lag-compensation">Lag Compensation</h2>
<figure>
<img src="../../attachments/lagcontroller.png" alt="" /><figcaption>lagcontroller</figcaption>
</figure>
<p>Lag controller:
<span class="math display">\begin{aligned}
C(s) &amp;= KC_1(s)\\
&amp;= K\frac{\alpha Ts+1}{Ts+1}, \quad 0 \lt \alpha \lt 1, \quad T \gt 0, \quad K \gt 0
\end{aligned}</span></p>
<p>Pole and zero locations for a lag controller:
<img src="../../attachments/lagpolar.png" alt="lagpolar" /></p>
<h3 id="steady-state-gain-1">Steady-state gain</h3>
<p><span class="math display">C(0)=K</span>
<img src="../../attachments/lagbode.png" alt="lagbode" /></p>
<p>Key befefit: Reduce high frequency gain without changing phase</p>
<h3 id="uses">Uses</h3>
<ol type="1">
<li>Boost low frequency gain to get good tracking and disturbance rejection without affecting stability margins or the high frequency behaviour (<span class="math inline">e_{ss}</span> spec and %OS spec)</li>
<li>To increase phase margin, done indirectly through changing the high frequency gain (See fig. 9.9 in the notes)</li>
</ol>
<h3 id="e.g.-9.3.1">e.g. 9.3.1</h3>
<p><span class="math display">\begin{aligned}
P(s) &amp;= \frac{1}{s(s+2)}\\
\\
C(s) &amp;= \text{lag controller}\\
&amp;= K\frac{\alpha Ts+1}{Ts+1}
\end{aligned}</span></p>
<p>Specs:</p>
<ol type="1">
<li>If <span class="math inline">r(t)=t1(t)</span>, then <span class="math inline">|e_{ss}| \le 0.05</span>.</li>
<li><span class="math inline">\Phi_{pm}^{desired} = 45^{\circ}</span> (for good damping)</li>
</ol>
<p>Steps 1: Choose <span class="math inline">K</span> to meet <span class="math inline">e_{ss}</span> spec. For now, assume <span class="math inline">C(s)</span> provides IO stability s we can apply FVT.
<span class="math display">\begin{aligned}
e_{ss} &amp;= \lim_{t\rightarrow \infty}e(t)\\
&amp;= \lim_{s \rightarrow 0} sE(s)\\
&amp;= \lim_{s \rightarrow 0} s\frac{1}{1+C(s)P(s)} R(s)\\
&amp;= \lim_{s \rightarrow 0} s \frac{1}{1+\frac{K\alpha Ts+1}{Ts+1} \frac{1}{s(s_2)}} \frac{1}{s^2}\\
&amp;= \frac{2}{K} \le 0.05 \Leftrightarrow K \ge 40
\end{aligned}</span>
Take <span class="math inline">K=40</span></p>
<p>(Step 2) Next, draw a Bode plot of <span class="math inline">KP(j\omega)=\frac{40}{s(s+2)}</span>. From the plot, we see that the phase margin <span class="math inline">\Phi_{pm}=18^\circ</span> (not to spec) at <span class="math inline">\omega_{gc}=6.17</span> rad/s.</p>
<p>Because it is not to spec, we design <span class="math inline">C_1(s)=\frac{\alpha Ts+1}{Ts+1}</span>. We want <span class="math inline">\Phi_{pm}^{desired}=45^\circ</span>, so we’ll aim for <span class="math inline">50^\circ</span> since <span class="math inline">\angle C_1(j\omega)</span> only approaches zero asymptotically.</p>
<p>From out Bode plot in Step 2, we observe:
<span class="math display">\Phi_{pm}^{desired} = 50^\circ = 180^\circ + \angle KP(j\omega) \text{ when } \omega=1.7\text{rad/s}</span>
The idea is to reduce the gain at <span class="math inline">\omega=1.7</span> rad/s so that this becomes the gain crossover frequency and do so without changing the phase.</p>
<p>The gain of <span class="math inline">KP(j\omega)</span> at <span class="math inline">\omega=1.7</span> rad/s is 19dB, so we want to reduce by 19dB to make it the crossover frequency.
<span class="math display">20log|\alpha|=-19\text{dB} \Leftrightarrow \alpha=\frac{1}{9}</span></p>
<p>Now pick <span class="math inline">T</span> so that <span class="math inline">\angle C(j\omega)\approx 0</span> at <span class="math inline">\omega=1.7</span>rad/s.
<span class="math display">\frac{10}{\alpha T} \le 1.7</span>
We’ll pick <span class="math inline">T=52.7</span> to get the final controller:
<span class="math display">C(s)=40 \frac{\frac{1}{9} \cdot 52.7s+1}{52.7s=1}=\frac{234.2s+40}{52.7s+1}</span></p>
<p>We verify with a simulation. The Bode plot of <span class="math inline">C(s)P(s)</span> yields <span class="math inline">\Phi_{pm}=44.6^\circ</span>.</p>
<h3 id="procedure-for-lag-design">Procedure for lag design</h3>
<p>Specs:</p>
<ol type="1">
<li>Steady-state tracking/disturbance rejection</li>
<li><span class="math inline">\Phi_{pm}^{desired}</span> (may be given as an overshoot spec, so you need to convert)</li>
</ol>
<p>Procedure:</p>
<ol type="1">
<li>Use Final Value Theorem to pick <span class="math inline">K</span> and meet spec 1.</li>
<li>Draw Bode plot of <span class="math inline">KP(j\omega)</span></li>
<li>If spec 2 is satisfied, stop. Otherwise, find <span class="math inline">\omega</span> such that <span class="math inline">180^\circ + \angle KP(j\omega) = \Phi_{pm}^{desired} + \delta</span>, where <span class="math inline">\delta</span> is a buffer to account for <span class="math inline">\angle C(j\omega) \ne 0</span> at high <span class="math inline">\omega</span>. Usually <span class="math inline">5^\circ</span>.</li>
<li>Shift the gain of <span class="math inline">KP</span> down at <span class="math inline">\omega</span> so that <span class="math inline">\omega</span> becomes <span class="math inline">\omega_{gc}</span>: <span class="math inline">\alpha=\frac{1}{KP(j\omega)}</span>.</li>
<li>Put the controller zero far away from <span class="math inline">\omega</span> so that phase isn’t affected too much: <span class="math inline">\frac{10}{\alpha T} \le \omega</span>.</li>
<li>Simulate to verify (see PS9 for a root-locus based design)</li>
</ol>
<h2 id="lead-controller">Lead controller</h2>
<figure>
<img src="../../attachments/leadcontroller.png" alt="" /><figcaption>leadcontroller</figcaption>
</figure>
<p><span class="math display">\begin{aligned}
C(s) &amp;= KC_1(s)\\
&amp;= K\frac{\alpha Ts+1}{Ts+1}, \quad \alpha \gt 1, \quad K,T \gt 0
\end{aligned}</span></p>
<figure>
<img src="../../attachments/leadpolar.png" alt="" /><figcaption>leadpolar</figcaption>
</figure>
<figure>
<img src="../../attachments/leadbode.png" alt="" /><figcaption>leadbode</figcaption>
</figure>
<p>Uses</p>
<ol type="1">
<li>Increase gain crossover frequency to increase closed loop bandwidth</li>
<li>Increase phase margin by adding phase where needed</li>
</ol>
<h3 id="lead-design-equations">Lead design equations</h3>
<p><span class="math display">\omega_m = \frac{1}{T\sqrt{\alpha}}</span>
This is the frequency at which the lead controller adds max phase.</p>
<p><span class="math display">\phi_{max} = \sin^{-1}\left(\frac{\alpha-1}{\alpha+1}\right)</span>
<span class="math display">\alpha = \frac{1+\sin{\phi_{max}}}{1 - \sin{\phi_{max}}}</span>
This is the max phase added by the lead controller.</p>
<h3 id="e.g.-9.4.1">e.g. 9.4.1</h3>
<p><span class="math display">P(s) = \frac{1}{s(s+2)}</span></p>
<p>Specs:</p>
<ul>
<li><span class="math inline">|e_{ss}| \le 0.05</span> for <span class="math inline">r(t)=t1(t)</span></li>
<li><span class="math inline">\Phi_{pm} = 45^\circ</span></li>
</ul>
<p>We want to explress the lead controller in the form:
<span class="math display">C(s)=\frac{\hat{K}}{\sqrt{\alpha}} \frac{\alpha Ts+1}{Ts+1}</span></p>
<p>First, choose <span class="math inline">\hat{K}</span> to meet the steady-state spec using FVT. In this case, we get <span class="math inline">\hat{K} \ge 40</span>. We then want to boost <span class="math inline">\hat{K}</span> by around 10dB to account for effective <span class="math inline">\alpha</span>. Our final result is <span class="math inline">\hat{K}=40\cdot \sqrt{10}</span>.</p>
<p>Next, draw a Bode plot of <span class="math inline">\hat{K}P(j\omega)</span> and observe that we have <span class="math inline">\Phi_{pm}=10.2^\circ</span> at <span class="math inline">\omega_{gc}=11.2</span> rad/s. So we set <span class="math inline">\omega_m = \omega_{gc}</span>. We need to add <span class="math inline">\Phi_{pm}^{desired} - \Phi_{pm} = 45-10.2 = 34.8^\circ</span>. Therefore, set <span class="math inline">\phi_{max} = 34.8^\circ</span>. This gives us <span class="math inline">\alpha=3.66</span>.</p>
<p>(This also gives <span class="math inline">K=\frac{\hat{K}}{\sqrt{\alpha}}=66.13</span>.)</p>
<p>Then, make sure we add <span class="math inline">\phi_{max}</span> at the correct frequency.
<span class="math display">T=\frac{1}{\omega_m\sqrt{\alpha}}=0.0467</span></p>
<p>Combining these:
<span class="math display">C(s)=66.13 \frac{3.66\cdot 0.0467s+1}{0.0467s+1} = \frac{241.9(s+5.85)}{s+21.43}</span></p>
<p>Finally, verify design. Draw the Bode plot of <span class="math inline">C(s)P(s)</span> yields <span class="math inline">\Phi_{pm}=45^\circ</span>, <span class="math inline">\omega_{gc}=11.1</span> rad/s.</p>
<h3 id="procedure-for-lead-design">Procedure for lead design</h3>
<p>Specs:</p>
<ol type="1">
<li><span class="math inline">\Phi_{pm}^{desired}</span></li>
<li>Either:</li>
</ol>
<ul>
<li>steady-state tracking/disturbance rejection</li>
<li>desired closed-loop bandwidth</li>
</ul>
<p>Procedure:</p>
<ol type="1">
<li>Let <span class="math inline">\hat{K}=K\sqrt{\alpha}</span> and choose <span class="math inline">\hat{K}</span> so that either:
<ul>
<li>Using FVT, pick <span class="math inline">\hat{K}</span> <span class="math inline">\hat{K}P</span> meets steady-state spec. From here, we purposefully boost <span class="math inline">\hat{K}</span> by 10dB to account for <span class="math inline">\alpha</span> distortion</li>
<li>Pick <span class="math inline">\hat{K}</span> so that <span class="math inline">\hat{K}P</span> has desired gain crossover frequency (<span class="math inline">\omega_{gc} = \omega_{BW}</span>)</li>
</ul></li>
<li>Draw Bode plot of <span class="math inline">\hat KP</span></li>
<li>Find <span class="math inline">\omega_{gc}</span> and <span class="math inline">\Phi_{pm}</span>. Set <span class="math inline">\omega_m = \omega_{gc}</span>.</li>
<li>Determine the amount of phase to add: set <span class="math inline">\phi_{max}=\Phi_{pm}^{desired} - \Phi_{pm}</span>.</li>
<li><span class="math inline">\alpha = \frac{1+\sin\phi_{max}}{1-\sin\phi_{max}}</span>. (Determine the value of <span class="math inline">K=\frac{\hat K}{\sqrt{\alpha}}</span>.)</li>
<li>Set <span class="math inline">T = \frac{1}{\omega_m \sqrt{\alpha}}</span></li>
<li>Simulate to check design</li>
</ol>
<h3 id="e.g.-9">E.g.</h3>
<p><span class="math display">P(s)=\frac{10}{s^2-10}</span>
Specs:</p>
<ul>
<li><span class="math inline">\Phi_{pm}=50^\circ</span></li>
<li>closed-loop bandwidth <span class="math inline">\omega_{BW}=10</span> rad/s</li>
</ul>
<figure>
<img src="../../attachments/leadcontrollernode.png" alt="" /><figcaption>leadcontrollernode</figcaption>
</figure>
<ol type="1">
<li>pick <span class="math inline">\hat K</span> so that <span class="math inline">\omega_{gc}=\omega_{BW}</span>. From the plot, we see that we need to boost the gain of <span class="math inline">P</span> by 20dB. i.e.: <span class="math inline">20\log\hat K = 20 \Leftrightarrow \hat K = 10</span>.</li>
<li>Draw a Bode plot of <span class="math inline">\hat K D</span>. (Or don’t if it’s an exam and you know how it’ll change.)</li>
<li><span class="math inline">\omega_{gc} = 10</span> rad/s, <span class="math inline">\Phi_{pm} = 0</span>.</li>
<li>We need to add <span class="math inline">\phi_{max}=\Phi_{pm}^{desired} - \Phi_{pm} = 50^\circ</span>.</li>
<li><span class="math inline">\alpha = \frac{1+\sin\phi_{max}}{1-\sin\phi_{max}} = 7.55^\circ</span>. This means <span class="math inline">K=\frac{\hat K}{\sqrt \alpha} = 3.64</span>.</li>
<li>Add phase at the right drequency: <span class="math inline">T = \frac{1}{\omega_m \sqrt \alpha}=0.0364</span>.</li>
</ol>
<p>We get:
<span class="math display">C(s)=3.64\frac{7.55\cdot 0.0364s+1}{0.0364s+1} = \frac{27.4 (s+3.65)}{s+27.47}</span></p>
<p>In this case, the closed-loop bandwidth ends up being 11.5 rad/s, so our approximation <span class="math inline">\omega_{gc} \approx \omega_{BW}</span> worked well.</p>
<h3 id="delay-tolerance">Delay tolerance</h3>
<p>How much delay can we tolerate in our system before losing stability?</p>
<p><img src="../../attachments/delayblock.png" alt="delayblock" />
This diagram has the transfer function <span class="math inline">T(s) = e^{-sT}</span>.</p>
<p>Bode plot of the delay: <span class="math inline">\left|e^{-j\omega T}\right|=1</span>, <span class="math inline">\angle e^{-j\omega T}=-\omega T</span>. The time delay <strong>only affects phase</strong>.</p>
<figure>
<img src="../../attachments/delayblock2.png" alt="" /><figcaption>delayblock2</figcaption>
</figure>
<figure>
<img src="../../attachments/feedbackfunction.png" alt="" /><figcaption>feedbackfunction</figcaption>
</figure>
<ul>
<li>Suppose that when <span class="math inline">T=0</span>, the system has a phase margin of <span class="math inline">\Phi_{pm}</span> degrees at the frequency <span class="math inline">\omega_{gc}</span>.</li>
<li>The system will become unstable if we reduce the phase by <span class="math inline">-\Phi_{pm}</span> at <span class="math inline">\omega=\omega_{gc}</span>.</li>
<li>The maximum delay we can tolerate before losing stability is when <span class="math inline">\angle e^{-j\omega_{gc}T_{max}} = -\Phi_{pm}</span>
<ul>
<li>i.e., <span class="math inline">-\omega_{gc}T_{max} = -\Phi_{pm} \Leftrightarrow T_{max} = \frac{\Phi_{pm}}{\omega_{gc}}</span></li>
</ul></li>
<li>Stability if <span class="math inline">T \lt T_{max}</span></li>
</ul>
<button id='gg_button' style="right:0; padding: 1%; display: flex; justify-content: center; margin: 0 auto 10px auto; width: 144px;" onClick="prev()"; type="button">PREV LECTURE</button>
<button id='gg_button' style="right:0; padding: 1%; display: flex; justify-content: center; margin: 0 auto 10px auto; width: 144px;" onClick="next()"; type="button">NEXT LECTURE</button>
</body>
</html>
